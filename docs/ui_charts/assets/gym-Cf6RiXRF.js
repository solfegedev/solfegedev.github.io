import{j as e,c as b}from"./client-B8KsQLkO.js";import{C as S}from"./CookieConsentWrapper-DBLm3LwE.js";import w,{useState as f,useEffect as D}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import{i as N}from"./all-BSES4dDh.js";import{N as h,a as k,b as u}from"./NavDropdown-BHMHKMX3.js";import{D as x}from"./dates-CuBDtlM6.js";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"./Button-Dbum-Du3.js";import"./CloseButton-CUYUvxPi.js";import"./Dropdown-B2rYS5Iw.js";const v=24*36e5,R=async({id:t,numDays:a})=>{const c=`https://api.eu.membr.com/api/public/gyms/${t}/bookings`,r=new Date;r.setHours(5),r.setMinutes(0),r.setSeconds(0);const i=new Date(r.getTime()+a*v);i.setHours(23),console.log(`Fetch API for slots from ${r} to ${i}`);const n={page:"1",page_size:"100",from_date:r.toISOString(),to_date:i.toISOString(),locale:"en_GB"};return fetch(c+"?"+new URLSearchParams(n).toString()).then(o=>o.json()).then(o=>(console.log("API response: ",o),{data:o.data.map(s=>({...s,location:s.location.name,staff:s.staff.user.fullName,time:s.events.eventTime,dateStart:s.events.dateStart,name:s.events.name,placesReserved:s.attendancesNumber,placesRemaining:s.remainingPlaces,placesTotal:s.places}))}))},g={Chesterfield:1548,"Sheffield South":1554,"Sheffield North":1555,Mansfield:1587,Rotherham:1550,Luton:2788},C=({dateStr:t})=>{const a=new Date(t).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"short",year:"numeric"});return e.jsx("div",{className:"x-delimiter",children:a})},T=({selectedGymName:t,setGymName:a})=>{const[c,r]=f(!0),i=n=>{r(n)};return e.jsxs(h,{id:"x-navbar",expand:"sm",variant:"dark",onToggle:i,expanded:c,children:[e.jsx(h.Brand,{children:"JD Gyms"}),e.jsx(h.Toggle,{"aria-controls":"basic-navbar-nav"}),e.jsx(h.Collapse,{id:"basic-navbar-nav",children:e.jsx(k,{className:"ms-auto me-auto",children:e.jsx(u,{title:t,onSelect:n=>{a(n)},children:Object.keys(g).map((n,o)=>e.jsx(u.Item,{active:n===t,eventKey:n,children:n},o))})})})]})},I=({name:t})=>{const a=t.toLowerCase().replace(/^jd\s+/,"");return a==="spin"?e.jsx("i",{className:"fa-solid fa-person-biking",style:{marginRight:"0.5rem",color:"#0284c7"}}):a==="hiit"?e.jsx("i",{className:"fa-solid fa-temperature-arrow-up",style:{marginRight:"0.5rem",color:"#dc2626"}}):a==="burn"?e.jsx("i",{className:"fa-solid fa-fire",style:{marginRight:"0.5rem",color:"#f97316"}}):a==="yoga"?e.jsx("i",{className:"fa-brands fa-y-combinator",style:{marginRight:"0.5rem",color:"#e879f9"}}):a==="les mills body balance"?e.jsx("i",{className:"fa-solid fa-scale-balanced",style:{marginRight:"0.5rem",color:"#047857"}}):a==="les mills body pump"?e.jsx("i",{className:"fa-solid fa-pump-soap",style:{marginRight:"0.5rem",color:"#1e3a8a"}}):a==="body conditioning"?e.jsx("i",{className:"fa-solid fa-dumbbell",style:{marginRight:"0.5rem",color:"#a8a29e"}}):a==="abs"?e.jsx("i",{className:"fa-brands fa-angular",style:{marginRight:"0.5rem",color:"#fde047"}}):a==="pilates"?e.jsx("i",{className:"fa-brands fa-product-hunt",style:{marginRight:"0.5rem",color:"#1e3a8a"}}):null},E=({evt:t,now:a})=>{const c=new Date(t.dateStart).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),r={backgroundColor:"#ffa8a8"},n=new Date(t.dateStart).getTime()-a.getTime(),o=n/6e4,m={};let s=null;return o<-t.time?m.backgroundImage="repeating-linear-gradient(-45deg, #bbb 0 1px, #eee 1px 0.8rem)":o<0?(m.backgroundColor="#ff7",s=e.jsxs("span",{children:[x(-n)," ago"]})):o<3*60&&(s=e.jsxs("span",{style:{color:"#f00"},children:["in ",x(n)]})),e.jsxs("div",{style:{...m,marginTop:"0.5rem"},children:[e.jsxs("div",{className:"x-flex-container",style:{fontWeight:"bold",color:"#1e293b"},children:[e.jsx("div",{className:"x-flex-left",children:c}),e.jsxs("div",{className:"x-flex-right",children:[e.jsxs("span",{style:{fontSize:"1.2rem"},children:[e.jsx(I,{name:t.name}),t.name]})," ","(",t.time," min)"]})]}),e.jsxs("div",{className:"x-flex-container",children:[e.jsx("div",{className:"x-flex-left",style:{fontSize:"0.7rem"},children:s}),e.jsxs("div",{className:"x-flex-right x-caption",children:[e.jsx("b",{children:t.placesRemaining})," places",t.placesRemaining!==t.placesTotal&&` left (out of ${t.placesTotal} total)`," ","with"," ",e.jsx("em",{children:e.jsx("b",{children:t.staff})})," ","(",e.jsx("em",{children:t.location}),")"]})]}),t.costInc>0&&e.jsxs("p",{style:r,children:["price incl: £",t.costInc]}),t.costExc>0&&e.jsxs("p",{style:r,children:["price excl: £",t.costExc]}),!t.public&&e.jsx("p",{style:r,children:"private class"})]})},_=()=>{const[t,a]=f(),[c,r]=f(new Date),[i,n]=f(Object.keys(g).at(0));if(D(()=>{(async function(){const l=await R({id:g[i],numDays:7});a(l)})();const d=()=>{if(document.visibilityState==="visible"){const l=new Date;console.log("Update time 'now': ",l),r(l)}};return document.addEventListener("visibilitychange",d),()=>{document.removeEventListener("visibilitychange",d)}},[i]),!t)return e.jsx("main",{children:"Loading..."});const o=t.data.sort((d,l)=>d.dateStart>l.dateStart?1:-1),m=[];let s="";o.forEach((d,l)=>{const p=d.dateStart.substring(0,10);p!==s&&m.push(e.jsx(C,{dateStr:p},`${l}-delimiter`)),s=p,m.push(e.jsx(E,{evt:d,now:c},l))});const j=c.toLocaleDateString("en-GB",{hour:"2-digit",minute:"2-digit",weekday:"long",day:"numeric",month:"short",year:"numeric"}),y=i.toLowerCase().replaceAll(" ","-");return e.jsxs(e.Fragment,{children:[e.jsx(T,{selectedGymName:i,setGymName:n}),e.jsxs("main",{children:[e.jsxs("p",{style:{marginBottom:"1rem"},children:[e.jsxs("a",{href:`https://www.jdgyms.co.uk/gym/${y}/`,target:"_blank",children:["JD ",i]}),","," ",e.jsx("a",{href:`https://bookings.widgets.eu.membr.com/calendar/gym/${g[i]}?primaryColor=%236ABD45&showProfilePicture=0&theme=light`,target:"_blank",children:"JD Calendar"}),","," ",e.jsx("a",{href:`https://www.google.co.uk/maps/dir/Brushfield+Park,+6-8+Woodleigh+Cl,+Chesterfield+S40+4XW/JD+Gyms+${i.replaceAll(" ","+")}/data=!3m1!1e3!4m2!4m1!3e0!5m1!1e1`,target:"_blank",children:"Traffic"})]}),e.jsx("p",{style:{fontFamily:"monospace",color:"#0c4a6e"},children:j}),e.jsx("div",{style:{backgroundColor:"#fff",width:N?"45rem":"100vw",margin:"auto"},children:m})]})]})};b.createRoot(document.getElementById("root")).render(e.jsx(w.StrictMode,{children:e.jsx(S,{children:e.jsx(_,{})})}));
