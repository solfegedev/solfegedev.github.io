import{j as e,c as j}from"./client-B8KsQLkO.js";import{C as y}from"./CookieConsentWrapper-DBLm3LwE.js";import b,{useState as h,useEffect as S}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import{i as v}from"./all-BSES4dDh.js";import{N as d,a as N,b as p}from"./NavDropdown-BHMHKMX3.js";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"./Button-Dbum-Du3.js";import"./CloseButton-CUYUvxPi.js";import"./Dropdown-B2rYS5Iw.js";const w=24*36e5,D=async({id:s,numDays:i})=>{const l=`https://api.eu.membr.com/api/public/gyms/${s}/bookings`,t=new Date;t.setHours(5),t.setMinutes(0),t.setSeconds(0);const a=new Date(t.getTime()+i*w);a.setHours(23),console.log(`Fetch API for slots from ${t} to ${a}`);const n={page:"1",page_size:"100",from_date:t.toISOString(),to_date:a.toISOString(),locale:"en_GB"};return fetch(l+"?"+new URLSearchParams(n).toString()).then(r=>r.json()).then(r=>(console.log("API response: ",r),r))},g={Chesterfield:1548,"Sheffield South (13 miles)":1554,"Sheffield North (17 miles)":1555,"Mansfield (16 miles)":1587,"Rotherham (21 miles)":1550,"Luton (11 miles)":2788},k=({dateStr:s})=>{const i=new Date(s).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"short",year:"numeric"});return e.jsx("div",{className:"x-delimiter",children:i})},E=({selectedGymName:s,setGymName:i})=>{const[l,t]=h(!0),a=n=>{t(n)};return e.jsxs(d,{id:"x-navbar",expand:"sm",variant:"dark",onToggle:a,expanded:l,children:[e.jsx(d.Brand,{children:"JD Gyms"}),e.jsx(d.Toggle,{"aria-controls":"basic-navbar-nav"}),e.jsx(d.Collapse,{id:"basic-navbar-nav",children:e.jsx(N,{className:"ms-auto me-auto",children:e.jsx(p,{title:s,onSelect:n=>{i(n)},children:Object.keys(g).map((n,r)=>e.jsx(p.Item,{active:n===s,eventKey:n,children:n},r))})})})]})},I=({evt:s,now:i})=>{const l=new Date(s.events.dateStart).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),t={backgroundColor:"#ffa8a8"},a=s.events.name==="Spin"?e.jsx("i",{className:"fa-solid fa-person-biking",style:{marginRight:"0.5rem",color:"#0284c7"}}):s.events.name==="HIIT"?e.jsx("i",{className:"fa-solid fa-temperature-arrow-up",style:{marginRight:"0.5rem",color:"#dc2626"}}):s.events.name==="JD Burn"?e.jsx("i",{className:"fa-solid fa-fire",style:{marginRight:"0.5rem",color:"#f97316"}}):s.events.name==="Yoga"?e.jsx("i",{className:"fa-brands fa-y-combinator",style:{marginRight:"0.5rem",color:"#e879f9"}}):s.events.name==="Les Mills Body Balance"?e.jsx("i",{className:"fa-solid fa-scale-balanced",style:{marginRight:"0.5rem",color:"#047857"}}):s.events.name==="Les Mills Body Pump"?e.jsx("i",{className:"fa-solid fa-pump-soap",style:{marginRight:"0.5rem",color:"#1e3a8a"}}):s.events.name==="Body Conditioning"?e.jsx("i",{className:"fa-solid fa-dumbbell",style:{marginRight:"0.5rem",color:"#a8a29e"}}):s.events.name==="Abs"?e.jsx("i",{className:"fa-brands fa-angular",style:{marginRight:"0.5rem",color:"#fde047"}}):null,n=new Date(s.events.dateStart),m=new Date(n.getTime()+s.events.eventTime*6e4)<i?{backgroundImage:"repeating-linear-gradient(-45deg, #bbb 0 1px, #eee 1px 0.8rem)"}:n<i?{backgroundColor:"#ff7"}:{};return e.jsxs("div",{style:{...m,marginTop:"0.5rem"},children:[e.jsxs("div",{className:"x-flex-container",style:{fontWeight:"bold",color:"#1e293b"},children:[e.jsx("div",{className:"x-flex-left",children:l}),e.jsxs("div",{className:"x-flex-right",children:[e.jsxs("span",{style:{fontSize:"1.2rem"},children:[a,s.events.name]})," ","(",s.events.eventTime," min)"]})]}),e.jsxs("div",{className:"x-flex-container",children:[e.jsx("div",{className:"x-flex-left",children:status}),e.jsxs("div",{className:"x-flex-right x-caption",children:[e.jsx("b",{children:s.remainingPlaces})," places",s.remainingPlaces!==s.places&&` left (out of ${s.places} total)`," with"," ",e.jsx("em",{children:e.jsx("b",{children:s.staff.user.fullName})})," ","(",e.jsx("em",{children:s.location.name}),")"]})]}),s.costInc>0&&e.jsxs("p",{style:t,children:["price incl: £",s.costInc]}),s.costExc>0&&e.jsxs("p",{style:t,children:["price excl: £",s.costExc]}),!s.public&&e.jsx("p",{style:t,children:"private class"})]})},B=()=>{const[s,i]=h(),[l,t]=h(new Date),[a,n]=h(Object.keys(g).at(0));if(S(()=>{(async function(){const o=await D({id:g[a],numDays:7});i(o)})();const c=()=>{if(document.visibilityState==="visible"){const o=new Date;console.log("Update time 'now': ",o),t(o)}};return document.addEventListener("visibilitychange",c),()=>{document.removeEventListener("visibilitychange",c)}},[a]),!s)return e.jsx("main",{children:"Loading..."});const r=s.data.sort((c,o)=>c.events.dateStart>o.events.dateStart?1:-1),m=[];let x="";r.forEach((c,o)=>{const f=c.events.dateStart.substring(0,10);f!==x&&m.push(e.jsx(k,{dateStr:f},`${o}-delimiter`)),x=f,m.push(e.jsx(I,{evt:c,now:l},o))});const u=l.toLocaleDateString("en-GB",{hour:"2-digit",minute:"2-digit",weekday:"long",day:"numeric",month:"short",year:"numeric"});return e.jsxs(e.Fragment,{children:[e.jsx(E,{selectedGymName:a,setGymName:n}),e.jsxs("main",{children:[e.jsx("p",{style:{margin:"1rem"},children:e.jsx("a",{href:"https://www.jdgyms.co.uk/gym/chesterfield/#:~:text=TIMETABLE%20SUBJECT%20TO%20CHANGE",target:"_blank",children:"Official Calendar"})}),e.jsx("p",{style:{fontFamily:"monospace",color:"#0c4a6e"},children:u}),e.jsx("div",{style:{backgroundColor:"#fff",width:v?"45rem":"100vw",margin:"auto"},children:m})]})]})};j.createRoot(document.getElementById("root")).render(e.jsx(b.StrictMode,{children:e.jsx(y,{children:e.jsx(B,{})})}));
