import{j as e,c as w}from"./client-B8KsQLkO.js";import{H as D,i as R,C as k}from"./CookieConsentWrapper-BX3Mx7Xo.js";import v,{createContext as C,useState as x,useContext as S,useEffect as I}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import{I as T,A as j}from"./Comps-BT2nj_kh.js";import{g as L}from"./googleMap-BAji2fQs.js";import{D as A,a as b}from"./dates-CXaDObX2.js";import{N as h,a as M,b as N}from"./NavDropdown-B6vjD2zC.js";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"./Button-Dbum-Du3.js";import"./CloseButton-CUYUvxPi.js";import"./Dropdown-BtRWb2wP.js";const _=async({id:t,numDays:s})=>{const r=`https://api.eu.membr.com/api/public/gyms/${t}/bookings`,n=new Date;n.setHours(5),n.setMinutes(0),n.setSeconds(0);const a=new Date(n.getTime()+s*A);a.setHours(23),console.log(`Fetch API for slots from ${n} to ${a}`);const l={page:"1",page_size:"100",from_date:n.toISOString(),to_date:a.toISOString(),locale:"en_GB"};return fetch(r+"?"+new URLSearchParams(l).toString()).then(o=>o.json()).then(o=>(console.log("API response: ",o),{data:o.data.map(i=>{const f={public:i.public,location:i.location.name,staff:i.staff.user.fullName,time:i.events.eventTime,dateStart:i.events.dateStart,name:i.events.name,placesReserved:i.attendancesNumber,placesRemaining:i.remainingPlaces,placesTotal:i.places};return(i.costInc>0||i.costExc)&&(f.cost=`cost incl/excl: Â£${i.costInc} / Â£${i.costExc}`),f})}))},u={Chesterfield:1548,"Sheffield South":1554,"Sheffield North":1555,Mansfield:1587,Rotherham:1550,Luton:2788},y=C(null),$=({children:t})=>{const[s,r]=x(Object.keys(u).at(0)),n={gymName:s,setGymName:r};return e.jsx(y.Provider,{value:n,children:t})},G=({dateStr:t})=>{const s=new Date(t).toLocaleDateString("en-GB",{weekday:"long",day:"numeric"});return e.jsx("div",{className:"x-delimiter",children:s})},B=()=>{const[t,s]=x(!0),r=S(y),n=a=>{s(a)};return e.jsxs(h,{id:"x-navbar",expand:"sm",variant:"dark",onToggle:n,expanded:t,children:[e.jsx(h.Brand,{children:e.jsx(T,{src:"https://www.jdgyms.co.uk/wp-content/themes/jdgyms/assets/images/jdgyms-logo.png",height:"32"})}),e.jsx(h.Toggle,{"aria-controls":"basic-navbar-nav"}),e.jsx(h.Collapse,{id:"basic-navbar-nav",children:e.jsx(M,{className:"ms-auto me-auto",children:e.jsx(N,{title:r.gymName,onSelect:a=>{r.setGymName(a)},active:!0,children:Object.keys(u).map((a,l)=>e.jsx(N.Item,{active:a===r.gymName,eventKey:a,children:a},l))})})})]})},P=({name:t})=>{const s=t.toLowerCase().replace(/^jd\s+/,"").replace("les mills ","").replace(" - ladies only","");return s==="spin"?e.jsx("i",{className:"fa-solid fa-person-biking",style:{marginRight:"0.5rem",color:"#0284c7"}}):s==="hiit"?e.jsx("i",{className:"fa-solid fa-temperature-arrow-up",style:{marginRight:"0.5rem",color:"#dc2626"}}):s==="burn"?e.jsx("i",{className:"fa-solid fa-fire",style:{marginRight:"0.5rem",color:"#f97316"}}):s==="yoga"?e.jsx("i",{className:"fa-brands fa-y-combinator",style:{marginRight:"0.5rem",color:"#e879f9"}}):s==="body balance"?e.jsx("i",{className:"fa-solid fa-scale-balanced",style:{marginRight:"0.5rem",color:"#047857"}}):s==="body pump"?e.jsx("i",{className:"fa-solid fa-pump-soap",style:{marginRight:"0.5rem",color:"#1e3a8a"}}):s==="body conditioning"?e.jsx("i",{className:"fa-solid fa-dumbbell",style:{marginRight:"0.5rem",color:"#a8a29e"}}):s==="abs"?e.jsx("i",{className:"fa-brands fa-angular",style:{marginRight:"0.5rem",color:"#fde047"}}):s==="pilates"?e.jsx("i",{className:"fa-brands fa-product-hunt",style:{marginRight:"0.5rem",color:"#1e3a8a"}}):s==="lbt"?e.jsx("i",{className:"fa-solid fa-drumstick-bite",style:{marginRight:"0.5rem",color:"#a56f07"}}):s.includes("combat")||s==="body attack"?e.jsx("i",{className:"fa-solid fa-user-ninja",style:{marginRight:"0.5rem",color:"#ad0808"}}):s==="step"?e.jsx("i",{className:"fa-solid fa-stairs",style:{marginRight:"0.5rem",color:"#9f9e9c"}}):s==="x-fit"?e.jsx("i",{className:"fa-solid fa-xmark",style:{marginRight:"0.5rem",color:"#0e7b0e"}}):s==="circuits"?e.jsx("i",{className:"fa-solid fa-flag-checkered",style:{marginRight:"0.5rem",color:"#000"}}):s==="zumba"?e.jsx("span",{children:"ðŸ’ƒ"}):s.includes("induction")?e.jsx("i",{className:"fa-solid fa-baby",style:{marginRight:"0.5rem",color:"#a56f07"}}):null},O=({evt:t,now:s})=>{const r=new Date(t.dateStart).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),n={backgroundColor:"#ffa8a8"},l=new Date(t.dateStart).getTime()-s.getTime(),o=l/6e4,m={};let g=null;return o<-t.time?m.backgroundImage="repeating-linear-gradient(-45deg, #bbb 0 1px, #eee 1px 0.8rem)":o<0?(m.backgroundColor="#ffffb6",g=e.jsxs("span",{children:[b(-l)," ago"]})):o<3*60&&(g=e.jsxs("span",{style:{color:"#f00"},children:["in ",b(l)]})),e.jsxs("div",{style:{...m,marginTop:"0.5rem"},children:[e.jsxs("div",{className:"x-flex-container",style:{fontWeight:"bold",color:"#1e293b"},children:[e.jsx("div",{className:"x-flex-left",children:r}),e.jsxs("div",{className:"x-flex-right",children:[e.jsxs("span",{style:{fontSize:"1.2rem"},children:[e.jsx(P,{name:t.name}),t.name]})," ","(",t.time," min)"]})]}),e.jsxs("div",{className:"x-flex-container",children:[e.jsx("div",{className:"x-flex-left",style:{fontSize:"0.7rem"},children:g}),e.jsxs("div",{className:"x-flex-right x-caption",children:[e.jsxs("p",{children:[e.jsx("b",{children:t.location})," - ",e.jsx("span",{className:"x-gym-staff",children:t.staff})]}),e.jsxs("p",{children:[e.jsx("b",{children:t.placesRemaining})," places"," ",t.placesRemaining!==t.placesTotal&&` left (out of ${t.placesTotal} total)`]})]})]}),t.cost&&e.jsx("p",{style:n,children:t.cost}),!t.public&&e.jsx("p",{style:n,children:"private class"})]})},z=()=>{const[t,s]=x(),[r,n]=x(new Date),a=S(y);if(I(()=>{(async function(){const c=await _({id:u[a.gymName],numDays:7});s(c)})();const d=()=>{if(document.visibilityState==="visible"){const c=new Date;console.log("Update time 'now': ",c),n(c)}};return document.addEventListener("visibilitychange",d),()=>{document.removeEventListener("visibilitychange",d)}},[a.gymName]),!t)return e.jsx("main",{children:"Loading..."});const l=t.data.sort((d,c)=>d.dateStart>c.dateStart?1:-1),o=[];let m="";l.forEach((d,c)=>{const p=d.dateStart.substring(0,10);p!==m&&o.push(e.jsx(G,{dateStr:p},`${c}-delimiter`)),m=p,o.push(e.jsx(O,{evt:d,now:r},c))});const g=r.toLocaleDateString("en-GB",{hour:"2-digit",minute:"2-digit",weekday:"long",day:"numeric",month:"short",year:"numeric"}),i=a.gymName.toLowerCase().replaceAll(" ","-"),f=L({origin:D.join(","),destination:`JD+Gyms+${a.gymName.replaceAll(" ","+")}`,isSatellite:!0,hasTraffic:!0});return e.jsxs(e.Fragment,{children:[e.jsx(B,{}),e.jsxs("main",{children:[e.jsxs("div",{id:"x-gym-links",children:[e.jsxs(j,{href:`https://www.jdgyms.co.uk/gym/${i}/`,children:["JD ",a.gymName]}),e.jsx(j,{href:`https://bookings.widgets.eu.membr.com/calendar/gym/${u[a.gymName]}?primaryColor=%236ABD45&showProfilePicture=0&theme=light`,children:"JD Calendar"}),e.jsx(j,{href:f,children:"Traffic"})]}),e.jsx("p",{children:g}),e.jsx("div",{style:{width:R?"45rem":"100vw",margin:"auto"},children:o})]})]})};w.createRoot(document.getElementById("root")).render(e.jsx(v.StrictMode,{children:e.jsx(k,{children:e.jsx($,{children:e.jsx(z,{})})})}));
