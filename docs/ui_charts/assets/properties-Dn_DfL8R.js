import{j as s,c as hs}from"./client-B8KsQLkO.js";import*as R from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import xs,{useRef as E,useEffect as T,useMemo as Ue,useState as y,useCallback as F,useImperativeHandle as fs}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import{B as ee}from"./Badge-Be_eTuxu.js";import{b as ms,u as js,c as gs,a as Pe,A as Ee,D as ce}from"./Dropdown-m6IqTZkl.js";import{u as _s,N as fe,a as ws,b as Te}from"./NavDropdown-DHHjP1lO.js";import{u as ne,c as B,b as ys,d as vs,e as Ns}from"./Button-AoLKMrJK.js";import{f as Ss,m as Le}from"./ElementChildren-AZvnq_HE.js";import{t as Cs,T as ks,a as bs,C as le}from"./CardHeaderContext-DTX9UVG2.js";import{C as Is,a as Me,B as ie,F as O}from"./Form-CXEUFvbu.js";import{D as $s}from"./DropdownButton-B9nFFZtP.js";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";const V=()=>new URLSearchParams(window.location.search),ge=e=>{const t=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+e.toString();window.history.replaceState({path:t},"",t)},Ds=(e,t)=>{const n=V();t===null?n.delete(e):n.set(e,t),ge(n)},_e=24*3600*1e3;let ve=new Date;const de=e=>{const t=new Date(e),n={day:"numeric",month:"short",year:"numeric"},r=ve.valueOf()-t.valueOf();return r<14*_e&&(n.weekday="long"),r<2*_e&&(n.hour="numeric",n.minute="numeric"),t.toLocaleDateString("en-GB",n)},zs=e=>{const t=new Date(e),n={day:"numeric",month:"short",year:"numeric"};return t.toLocaleDateString("en-GB",n)},He=e=>{const t=new Date(e),n={month:"short",year:"numeric"};return t.toLocaleDateString("en-GB",n)},me=e=>{const t=new Date(e);return((ve.valueOf()-t.valueOf())/_e).toLocaleString("en-GB",{maximumFractionDigits:1})},Re=(e,t=!1)=>{if(e===void 0)return"";const n=new Date(e),r=ve.valueOf()-n.valueOf();let c=(t?-r:r)/6e4;const l=c<0?"-":"";c=Math.abs(c);const u=Math.floor(c/60),a=Math.floor(c%60).toLocaleString("en-GB",{minimumIntegerDigits:2});return`${l}${u}h${a}m`},U=e=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",maximumFractionDigits:0}).format(e),As=(e,t)=>s.jsxs(s.Fragment,{children:[e,", ",t]}),P=(e,t)=>s.jsxs(s.Fragment,{children:[e," ◆ ",t]}),m=({icon:e,text:t,url:n=""})=>{const r=n?s.jsx("a",{rel:"noreferrer",target:"_blank",href:n,children:t}):t;return s.jsxs("span",{className:"x-nowrap",children:[e," ",r]})},re=({isLink:e=!1,style:t={}})=>s.jsx(Ne,{src:"img/properties/r.ico",isLink:e,style:t}),H=({isLink:e=!1,style:t={}})=>s.jsx(Ne,{src:"img/properties/z.ico",isLink:e,style:t}),We=({isLink:e=!1,style:t={}})=>s.jsx(Ne,{src:"img/properties/o.ico",isLink:e,style:t}),Ne=({isLink:e=!1,style:t={},src:n})=>(t.width=e?"1.4rem":"1rem",s.jsx("img",{loading:"lazy",referrerPolicy:"no-referrer",crossOrigin:"anonymous",src:n,style:t,alt:"z Property"})),Fs=({item:e})=>{const t=[s.jsx(Ps,{item:e},"1")];return e.zoopla_advert_id&&t.push(s.jsx(Ze,{item:e},"2")),e.zoopla_uprn&&t.push(s.jsx(Es,{item:e},"3")),e.epcs&&t.push(s.jsx(Ts,{item:e},"4")),s.jsxs("p",{children:[s.jsx("strong",{children:"Links:"})," ",t.reduce(P)]})},Ze=({item:e})=>{const n=`https://www.zoopla.co.uk/${e.channel==="rent"?"to-rent":"for-sale"}/details/${e.zoopla_advert_id}/`;return s.jsx(m,{icon:s.jsx(H,{}),url:n,text:"Advert"})},Ps=({item:e})=>{const t=`https://www.rightmove.co.uk/properties/${e.id}#/?channel=${e.channel}`;return s.jsx(m,{icon:s.jsx(re,{}),url:t,text:"Advert"})},Es=({item:e})=>{const t=`https://www.zoopla.co.uk/property/uprn/${e.zoopla_uprn}/`;return s.jsx(m,{icon:s.jsx(H,{}),url:t,text:"Estimate"})},Ts=({item:e})=>s.jsxs(s.Fragment,{children:[s.jsx(re,{})," ",e.epcs.map((t,n)=>s.jsx("a",{rel:"noreferrer",target:"_blank",href:t.url,children:t.caption},n)).reduce(As)]});function Ls(e,t){const n=E(!0);T(()=>{if(n.current){n.current=!1;return}return e()},t)}const we=2**31-1;function Je(e,t,n){const r=n-Date.now();e.current=r<=we?setTimeout(t,r):setTimeout(()=>Je(e,t,n),we)}function Ms(){const e=ms(),t=E();return _s(()=>clearTimeout(t.current)),Ue(()=>{const n=()=>clearTimeout(t.current);function r(c,l=0){e()&&(n(),l<=we?t.current=setTimeout(c,l):Je(t,c,Date.now()+l))}return{set:r,clear:n,handleRef:t}},[])}const qe=R.forwardRef(({className:e,bsPrefix:t,as:n="div",...r},c)=>(t=ne(t,"carousel-caption"),s.jsx(n,{ref:c,className:B(e,t),...r})));qe.displayName="CarouselCaption";const Ke=R.forwardRef(({as:e="div",bsPrefix:t,className:n,...r},c)=>{const l=B(n,ne(t,"carousel-item"));return s.jsx(e,{ref:c,...r,className:l})});Ke.displayName="CarouselItem";const Rs=40;function Bs(e){if(!e||!e.style||!e.parentNode||!e.parentNode.style)return!1;const t=getComputedStyle(e);return t.display!=="none"&&t.visibility!=="hidden"&&getComputedStyle(e.parentNode).display!=="none"}const Ge=R.forwardRef(({defaultActiveIndex:e=0,...t},n)=>{const{as:r="div",bsPrefix:c,slide:l=!0,fade:u=!1,controls:h=!0,indicators:a=!0,indicatorLabels:i=[],activeIndex:d,onSelect:p,onSlide:x,onSlid:v,interval:S=5e3,keyboard:I=!0,onKeyDown:g,pause:N="hover",onMouseOver:b,onMouseOut:_,wrap:w=!0,touch:W=!0,onTouchStart:se,onTouchMove:j,onTouchEnd:Z,prevIcon:J=s.jsx("span",{"aria-hidden":"true",className:"carousel-control-prev-icon"}),prevLabel:q="Previous",nextIcon:K=s.jsx("span",{"aria-hidden":"true",className:"carousel-control-next-icon"}),nextLabel:G="Next",variant:pe,className:k,children:ue,...Qe}=js({defaultActiveIndex:e,...t},{activeIndex:"onSelect"}),z=ne(c,"carousel"),X=ys(),Y=E(null),[Se,Ce]=y("next"),[es,ae]=y(!1),[Q,ke]=y(!1),[C,ss]=y(d||0);T(()=>{!Q&&d!==C&&(Y.current?Ce(Y.current):Ce((d||0)>C?"next":"prev"),l&&ke(!0),ss(d||0))},[d,Q,C,l]),T(()=>{Y.current&&(Y.current=null)});let L=0,be;Ss(ue,(o,f)=>{++L,f===d&&(be=o.props.interval)});const Ie=gs(be),$=F(o=>{if(Q)return;let f=C-1;if(f<0){if(!w)return;f=L-1}Y.current="prev",p==null||p(f,o)},[Q,C,p,w,L]),D=Pe(o=>{if(Q)return;let f=C+1;if(f>=L){if(!w)return;f=0}Y.current="next",p==null||p(f,o)}),he=E();fs(n,()=>({element:he.current,prev:$,next:D}));const $e=Pe(()=>{!document.hidden&&Bs(he.current)&&(X?$():D())}),M=Se==="next"?"start":"end";Ls(()=>{l||(x==null||x(C,M),v==null||v(C,M))},[C]);const ts=`${z}-item-${Se}`,ns=`${z}-item-${M}`,rs=F(o=>{Cs(o),x==null||x(C,M)},[x,C,M]),as=F(()=>{ke(!1),v==null||v(C,M)},[v,C,M]),os=F(o=>{if(I&&!/input|textarea/i.test(o.target.tagName))switch(o.key){case"ArrowLeft":o.preventDefault(),X?D(o):$(o);return;case"ArrowRight":o.preventDefault(),X?$(o):D(o);return}g==null||g(o)},[I,g,$,D,X]),cs=F(o=>{N==="hover"&&ae(!0),b==null||b(o)},[N,b]),ls=F(o=>{ae(!1),_==null||_(o)},[_]),De=E(0),oe=E(0),ze=Ms(),is=F(o=>{De.current=o.touches[0].clientX,oe.current=0,N==="hover"&&ae(!0),se==null||se(o)},[N,se]),ds=F(o=>{o.touches&&o.touches.length>1?oe.current=0:oe.current=o.touches[0].clientX-De.current,j==null||j(o)},[j]),ps=F(o=>{if(W){const f=oe.current;Math.abs(f)>Rs&&(f>0?$(o):D(o))}N==="hover"&&ze.set(()=>{ae(!1)},S||void 0),Z==null||Z(o)},[W,N,$,D,ze,S,Z]),Ae=S!=null&&!es&&!Q,xe=E();T(()=>{var o,f;if(!Ae)return;const A=X?$:D;return xe.current=window.setInterval(document.visibilityState?$e:A,(o=(f=Ie.current)!=null?f:S)!=null?o:void 0),()=>{xe.current!==null&&clearInterval(xe.current)}},[Ae,$,D,Ie,S,$e,X]);const Fe=Ue(()=>a&&Array.from({length:L},(o,f)=>A=>{p==null||p(f,A)}),[a,L,p]);return s.jsxs(r,{ref:he,...Qe,onKeyDown:os,onMouseOver:cs,onMouseOut:ls,onTouchStart:is,onTouchMove:ds,onTouchEnd:ps,className:B(k,z,l&&"slide",u&&`${z}-fade`,pe&&`${z}-${pe}`),children:[a&&s.jsx("div",{className:`${z}-indicators`,children:Le(ue,(o,f)=>s.jsx("button",{type:"button","data-bs-target":"","aria-label":i!=null&&i.length?i[f]:`Slide ${f+1}`,className:f===C?"active":void 0,onClick:Fe?Fe[f]:void 0,"aria-current":f===C},f))}),s.jsx("div",{className:`${z}-inner`,children:Le(ue,(o,f)=>{const A=f===C;return l?s.jsx(ks,{in:A,onEnter:A?rs:void 0,onEntered:A?as:void 0,addEndListener:bs,children:(te,us)=>R.cloneElement(o,{...us,className:B(o.props.className,A&&te!=="entered"&&ts,(te==="entered"||te==="exiting")&&"active",(te==="entering"||te==="exiting")&&ns)})}):R.cloneElement(o,{className:B(o.props.className,A&&"active")})})}),h&&s.jsxs(s.Fragment,{children:[(w||d!==0)&&s.jsxs(Ee,{className:`${z}-control-prev`,onClick:$,children:[J,q&&s.jsx("span",{className:"visually-hidden",children:q})]}),(w||d!==L-1)&&s.jsxs(Ee,{className:`${z}-control-next`,onClick:D,children:[K,G&&s.jsx("span",{className:"visually-hidden",children:G})]})]})]})});Ge.displayName="Carousel";const je=Object.assign(Ge,{Caption:qe,Item:Ke}),Os=({item:e})=>{const t=(e.floorplans??[]).map(r=>({url:r.url})).reverse(),n=(e.images??[]).concat(t);return s.jsxs(s.Fragment,{children:[n.length===0?s.jsx("p",{className:"x-noImageProvided",children:"No images provided"}):s.jsx(Vs,{imagesAndFloorplans:n}),s.jsx(Hs,{item:e}),s.jsx(Us,{item:e})]})},Vs=({imagesAndFloorplans:e})=>s.jsxs(je,{interval:864e5,defaultActiveIndex:0,children:[e.map((t,n)=>s.jsxs(je.Item,{children:[s.jsx("img",{loading:"lazy",referrerPolicy:"no-referrer",className:"d-block",src:t.url,alt:"caption: "+t.caption}),s.jsx(je.Caption,{style:{display:"flex",justifyContent:"center"},children:s.jsxs("p",{children:[s.jsx("strong",{children:`${n+1}/${e.length} `}),t.caption||""]})})]},n)),e.length===0&&s.jsx("img",{className:"d-block",alt:"No images provided"})]}),Us=({item:e})=>e.zoopla_est||e.zoopla_peak||e.zoopla_rent_estimate?s.jsxs(s.Fragment,{children:[e.zoopla_est&&s.jsx(Ws,{item:e}),e.zoopla_peak&&s.jsx(Zs,{item:e}),e.zoopla_rent_estimate&&s.jsx(Js,{item:e})]}):e.zoopla_advert_id?s.jsx("p",{className:"x-caption-2",children:s.jsx(Ze,{item:e})}):null,Hs=({item:e})=>{const t=`https://www.rightmove.co.uk/properties/${e.id}#/media?channel=${e.channel}`,n=r=>{const c=["",`  "${e.id}": {`,'    "zoopla_advert_id": null, "zoopla_uprn": null,',`    "__address_r": "${e.address}",`,'    "notes": null, "size_sqm": null, "coordinates": null},',""];navigator.clipboard.writeText(c.join(`
`))};return s.jsxs("p",{className:"x-caption-1",children:[s.jsx("span",{className:"x-loop-index",onClick:n,children:e.loopIndex}),e.sold_let&&s.jsx(ee,{text:"dark",bg:"warning",className:"x-badge",children:e.sold_let}),e.is_new&&s.jsx(ee,{text:"light",bg:"success",className:"x-badge",children:"NEW"}),s.jsx("a",{rel:"noreferrer",target:"_blank",href:t,style:{textDecoration:"none"},children:U(e.price)})]})},Ws=({item:e})=>{const t=`https://www.zoopla.co.uk/property/uprn/${e.zoopla_uprn}/`;return e.channel==="rent"?s.jsxs("p",{className:"x-caption-2",children:[s.jsx("span",{className:"x-manual-all",children:ye(e.price,e.zoopla_rent_estimate)})," on"," ",s.jsxs("a",{rel:"noreferrer",target:"_blank",href:t,className:"x-manual-all",children:[U(e.zoopla_rent_estimate),"pm ",s.jsx(H,{style:{verticalAlign:"unset"}})]})]}):s.jsxs("p",{className:"x-caption-2",children:[s.jsx("span",{className:"x-manual-all",children:ye(e.price,e.zoopla_est*1e3)})," on"," ",s.jsxs("a",{rel:"noreferrer",target:"_blank",href:t,className:"x-manual-all",children:[U(e.zoopla_est*1e3)," ",s.jsx(H,{style:{verticalAlign:"unset"}})]}),e.zoopla_estimate_date&&s.jsxs("span",{children:[" in ",He(e.zoopla_estimate_date)]})]})},Zs=({item:e})=>e.channel==="rent"?s.jsxs("p",{className:"x-caption-2",children:[s.jsx("span",{className:"x-manual-all",children:U(e.zoopla_est*1e3)}),e.zoopla_estimate_date&&s.jsxs("span",{children:[" in ",He(e.zoopla_estimate_date)]})]}):s.jsxs("p",{className:"x-caption-2",children:[s.jsx("span",{className:"x-manual-all",children:ye(e.price,e.zoopla_peak*1e3)})," on"," ",s.jsx("span",{className:"x-manual-all",children:U(e.zoopla_peak*1e3)})," peak of"," ",s.jsx("span",{className:"x-manual-all",children:e.zoopla_peak_date})]}),Js=({item:e})=>e.channel==="rent"?s.jsxs("p",{className:"x-caption-2",children:[s.jsx("span",{className:"x-manual-all",children:Be(e.price/e.zoopla_est/1e3)})," rental yield"]}):s.jsxs("p",{className:"x-caption-2",children:[s.jsx("span",{className:"x-manual-all",children:Be(e.zoopla_rent_estimate/e.price)})," ","rental yield at ",U(e.zoopla_rent_estimate),"pm"]}),ye=(e,t)=>new Intl.NumberFormat("en-GB",{style:"percent",signDisplay:"exceptZero",minimumFractionDigits:1,maximumFractionDigits:1}).format((e-t)/t),Be=e=>new Intl.NumberFormat("en-GB",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}).format((1+e)**12-1),qs=({item:e})=>{const t=e.coordinates.join(","),n=e.closest&&e.closest.coords?e.closest.coords.join(","):"",r=[s.jsx(Ks,{coordsCsv:t,closeCoordsCsv:n},"1"),s.jsx(Gs,{coordsCsv:t,closeCoordsCsv:n},"2"),s.jsx(Xs,{coordsCsv:t},"3"),s.jsx(Ys,{coordsCsv:t},"4"),s.jsx(Qs,{coords:e.coordinates},"5"),s.jsx(et,{coords:e.coordinates},"6"),s.jsx(st,{coords:e.coordinates},"7"),s.jsx(tt,{coords:e.coordinates},"8"),s.jsx(nt,{coords:e.coordinates},"9")];return s.jsxs("p",{children:[s.jsx("strong",{children:"Maps:"})," ",r.reduce(P)]})},Ks=({coordsCsv:e,closeCoordsCsv:t})=>{const n=t?`https://www.google.com/maps/dir/${t}/${e}/@15z/data=!4m2!4m1!3e2`:`https://www.google.com/maps/place/${e}/@15z/data=!5m1!1e2`,r=s.jsx("i",{className:"fa-solid fa-map-location",style:{color:"#b01010"}});return s.jsx(m,{icon:r,url:n,text:"Map"})},Gs=({coordsCsv:e,closeCoordsCsv:t})=>{const n=t?`https://www.google.com/maps/dir/${t}/${e}/@2696m/data=!3m1!1e3!4m2!4m1!3e2`:`https://www.google.com/maps/place/${e}/@2696m/data=!3m1!1e3!5m1!1e2`;return s.jsx(m,{icon:"🛰",url:n,text:"Satellite"})},Xs=({coordsCsv:e})=>{const t=`https://earth.google.com/web/@${e},132a,25d,35y,0h,0t,0r`;return s.jsx(m,{icon:"🌍",url:t,text:"Earth"})},Ys=({coordsCsv:e})=>{const t=`https://www.google.com/maps/@${e},3a,90y,70t/data=!3m1!1e1`,n=s.jsx("i",{className:"fa-solid fa-street-view",style:{color:"#b08800"}});return s.jsx(m,{icon:n,url:t,text:"StreetView"})},Qs=({coords:e})=>{const n=`https://open.xploria.co.uk/app/know-your-place?map=${e.slice(0).reverse().join("*")}*18&view=elcAu7IT4`;return s.jsx(m,{icon:"💰",url:n,text:"Standards"})},et=({coords:e})=>{const n=`https://open.xploria.co.uk/app/know-your-place?map=${e.slice(0).reverse().join("*")}*18&view=elcAu7IT4&theme=w0fDyvnN_`,r=s.jsx("i",{className:"fa-solid fa-handcuffs",style:{color:"#808080"}});return s.jsx(m,{icon:r,url:n,text:"Crime"})},st=({coords:e})=>{const n=`https://parallel.co.uk/rofrs/#16/${e.join("/")}`;return s.jsx(m,{icon:"🌊",url:n,text:"Flood"})},tt=({coords:e})=>{const t=e.join("%2C"),n=`https://en-gb.topographic-map.com/map/?center=${t}&zoom=16&popup=${t}`,r=s.jsx("i",{className:"fa-solid fa-mountain-sun",style:{color:"#6fcdf9"}});return s.jsx(m,{icon:r,url:n,text:"Elevation"})},nt=({coords:e})=>{const n=`https://www.cyclosm.org/#map=17/${e.join("/")}/cyclosm`,r=s.jsx("i",{className:"fa-solid fa-person-biking",style:{color:"#b01010"}});return s.jsx(m,{icon:r,url:n,text:"Cycling"})},rt=({item:e})=>{const t=[s.jsx(lt,{item:e},"1"),s.jsx(it,{item:e},"2"),s.jsx(at,{item:e},"3"),s.jsx(ot,{item:e},"4"),s.jsx(dt,{item:e},"5"),s.jsx(ct,{item:e},"6")];return s.jsxs("p",{children:[s.jsx("strong",{children:"In Street:"})," ",t.reduce(P)]})},at=({item:e})=>{const t=e.address_postcode.toLowerCase().replace(" ","-"),n=e.address_postcode.toUpperCase().replace(" ","%20"),r=`https://www.zoopla.co.uk/house-prices/${t}/?q=${n}&sortOrder=address&sortDirection=asc`;return s.jsx(m,{icon:s.jsx(H,{}),url:r,text:"Estimate / Sold Prices"})},ot=({item:e})=>{const n=`https://www.rightmove.co.uk/house-prices/${e.address_postcode.toLowerCase().replace(" ","-")}.html`;return s.jsx(m,{icon:s.jsx(re,{}),url:n,text:"Sold Prices"})},ct=({item:e})=>{const n=`https://www.crime-statistics.co.uk/postcode/${e.address_postcode.toUpperCase().replace(" ","%20")}`,r=s.jsx("i",{className:"fa-solid fa-handcuffs",style:{color:"#808080"}});return s.jsx(m,{icon:r,url:n,text:"Crimes"})},lt=({item:e})=>{const t=e.address_postcode.toLowerCase().replace(" ","-"),n=e.address_postcode.replace(" ","+"),r=e.channel==="rent"?`https://www.zoopla.co.uk/to-rent/property/${t}/?radius=0&q=${n}&search_source=to-rent&results_sort=newest_listings&include_rented=true`:`https://www.zoopla.co.uk/for-sale/property/${t}/?radius=0&q=${n}&search_source=for-sale&results_sort=newest_listings&is_auction=false&is_retirement_home=false&is_shared_ownership=false&include_sold=true`;return s.jsx(m,{icon:s.jsx(H,{}),url:r,text:"Adverts"})},it=({item:e})=>{const t=e.address_postcode.toLowerCase().replace(" ","-"),n=e.channel==="rent"?`https://www.onthemarket.com/to-rent/property/${t}/?let-agreed=true&radius=0.25&shared=false&student=false&view=grid`:`https://www.onthemarket.com/for-sale/property/${t}/?auction=false&radius=0.25&retirement=false&shared-ownership=false&under-offer=true&view=grid`;return s.jsx(m,{icon:s.jsx(We,{}),url:n,text:"Adverts"})},dt=({item:e})=>{const t=s.jsx("i",{className:"fa-solid fa-leaf",style:{color:"#659748"}}),r=`https://find-energy-certificate.service.gov.uk/find-a-certificate/search-by-postcode?postcode=${e.address_postcode.replace(" ","+")}`;return s.jsx(m,{icon:t,url:r,text:"EPCs"})},pt=({item:e})=>s.jsxs("div",{className:"x-card-right",children:[e.notes&&s.jsxs("p",{className:"x-manual-all",children:["Extra Notes: ",e.notes]}),s.jsx(ut,{item:e}),e.let_info&&s.jsx(yt,{let_info:e.let_info}),e.previous_prices&&s.jsx(ht,{prices:e.previous_prices}),s.jsx(xt,{item:e}),s.jsx(ft,{item:e}),s.jsx(mt,{item:e}),s.jsx(qs,{item:e}),s.jsx(Fs,{item:e}),e.brochures&&s.jsx(jt,{brochures:e.brochures}),e.key_features&&s.jsx(_t,{features:e.key_features}),s.jsx(rt,{item:e}),s.jsx("p",{children:e.summary}),e.agency&&s.jsx(wt,{agency:e.agency,id:e.id})]}),ut=({item:e})=>e.date_updated?s.jsxs("p",{children:[s.jsx("span",{className:"x-update-reason-updated",children:"Reduced"})," ",s.jsx("span",{className:"x-update-reason-updated x-date-relative","data-convert":"days","data-date":e.date_updated,children:me(e.date_updated)})," ","days ago (on ",s.jsx("strong",{children:de(e.date_updated)}),"). First added"," ",s.jsx("span",{className:"x-first-added x-date-relative","data-convert":"days","data-date":e.date_added,children:me(e.date_added)})," ","days ago (on ",s.jsx("strong",{children:de(e.date_added)}),")."]}):s.jsxs("p",{children:[s.jsx("span",{className:"x-update-reason-new",children:"New"})," ",s.jsx("span",{className:"x-update-reason-new x-date-relative","data-convert":"days","data-date":e.date_added,children:me(e.date_added)})," ","days ago (on ",s.jsx("strong",{children:de(e.date_added)}),")."]}),ht=({prices:e})=>s.jsxs("p",{children:[s.jsx("strong",{children:"Previous prices:"})," ",e.map((t,n)=>s.jsxs("span",{children:[U(t.price)," on ",zs(t.date)]},n)).reduce(P)]}),xt=({item:e})=>{const t=s.jsx("span",{className:"x-size-sqm",children:e.size_sqm}),n=[];return e.size_sqm&&n.push(s.jsx(m,{icon:t,text:"m²"},"1")),n.push(s.jsx(m,{icon:"🛏",text:`${e.bedrooms}`},"2")),e.bathrooms!==void 0&&n.push(s.jsx(m,{icon:"🛀",text:`${e.bathrooms}`},"3")),n.push(s.jsx(m,{icon:e.property_group_icon,text:e.property_group},"4")),s.jsx("p",{children:n.reduce(P)})},ft=({item:e})=>{let t="";return e.address_street_num&&(t=/\d\w?$/i.test(e.address_street_num)?" ":", "),s.jsxs("p",{children:[e.address_street_num&&s.jsx("span",{className:"x-manual-all",children:e.address_street_num}),s.jsx("strong",{children:t+e.address+", "}),s.jsx("strong",{className:"x-postcode",children:e.address_postcode})]})},mt=({item:e})=>s.jsxs("p",{children:[s.jsx("span",{className:"x-distance-miles",children:e.closest.miles.toFixed(2)})," miles to"," ",s.jsx("span",{className:"x-known-place",children:e.closest.place})]}),jt=({brochures:e})=>s.jsxs("p",{children:[s.jsx("strong",{children:"Brochures:"})," ",e.map((t,n)=>s.jsx(gt,{brochure:t},n)).reduce(P)]}),gt=({brochure:e})=>{const n=e.url.replace(/\?.*/,"").replace(/\/+$/,"").toLowerCase().endsWith(".pdf")?s.jsx("i",{className:"fa-solid fa-file-lines",style:{color:"#dc3545"}}):s.jsx("i",{className:"fa-solid fa-link",style:{color:"#808080"}});return s.jsx(m,{icon:n,url:e.url,text:e.caption})},_t=({features:e})=>s.jsxs("p",{children:[s.jsx("strong",{children:"Other:"})," ",e.map((t,n)=>s.jsx("span",{children:t},n)).reduce(P)]}),wt=({agency:e,id:t})=>s.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"end"},children:[s.jsx("img",{loading:"lazy",referrerPolicy:"no-referrer",src:e.url,title:e.caption,alt:e.caption,style:{maxHeight:"3rem",maxWidth:"6rem"}}),s.jsx("span",{style:{fontSize:"0.6rem",marginLeft:"1rem"},children:t})]}),yt=({let_info:e})=>{const t=[];return e.date_available&&t.push(`Available ${e.date_available}`),e.furnish&&t.push(e.furnish),e.min_duration&&t.push(`${e.min_duration} months`),t.length===0?s.jsx(s.Fragment,{}):s.jsxs("p",{children:[s.jsx("strong",{children:"Let:"})," ",t.map((n,r)=>s.jsx("span",{children:n},r)).reduce(P)]})},Xe=R.forwardRef(({bsPrefix:e,fluid:t=!1,as:n="div",className:r,...c},l)=>{const u=ne(e,"container"),h=typeof t=="string"?`-${t}`:"-fluid";return s.jsx(n,{ref:l,...c,className:B(r,t?`${u}${h}`:u)})});Xe.displayName="Container";const Ye=R.forwardRef(({bsPrefix:e,className:t,as:n="div",...r},c)=>{const l=ne(e,"row"),u=vs(),h=Ns(),a=`${l}-cols`,i=[];return u.forEach(d=>{const p=r[d];delete r[d];let x;p!=null&&typeof p=="object"?{cols:x}=p:x=p;const v=d!==h?`-${d}`:"";x!=null&&i.push(`${a}${v}-${x}`)}),s.jsx(n,{ref:c,...r,className:B(t,l,...i)})});Ye.displayName="Row";const vt=({item:e})=>{let t="x-card";return e.sold_let&&(t+=" x-card-stc"),s.jsx(Is,{className:t,"data-miles":e.closest.miles,"data-isflat":e.property_group_icon==="🏢",children:s.jsx(Xe,{fluid:!0,children:s.jsxs(Ye,{children:[s.jsx(Me,{sm:"5",style:{padding:0},children:s.jsx(Os,{item:e})}),s.jsx(Me,{sm:"7",style:{padding:"1rem",margin:"0"},children:s.jsx(pt,{item:e})})]})})})},Oe={chesterfield:"Chesterfield",chesterfield_ashgate:"Chesterfield Ashgate",chesterfield_rent:"Chesterfield rent",herts:"Herts",herts_s:"Herts_s",hitchin_johnsonpl:"Hitchin Johnson Place",hitchin_rent:"Hitchin rent",basingstoke:"Basingstoke",london:"London"},Nt=()=>{var h;const[e,t]=y(!0),n=new URLSearchParams(window.location.search),r=((h=n.get("data"))==null?void 0:h.replace("properties_",""))??"chesterfield_ashgate",c=n.get("nav")==="all"?["chesterfield","chesterfield_ashgate","chesterfield_rent","herts","herts_s","hitchin_johnsonpl","hitchin_rent","basingstoke","london"]:["chesterfield","chesterfield_ashgate","chesterfield_rent","herts","hitchin_johnsonpl","hitchin_rent","basingstoke"],l=a=>{t(a)},u=a=>{const i=new URLSearchParams;i.set("data",`properties_${a}`);const d=new URLSearchParams(window.location.search);return["stc","nav"].forEach(p=>{const x=d.get(p);x&&i.set(p,x)}),"?"+i.toString()};return s.jsxs(fe,{id:"x-navbar",expand:"sm",variant:"dark",onToggle:l,expanded:e,children:[s.jsx(fe.Toggle,{"aria-controls":"basic-navbar-nav"}),s.jsx(fe.Collapse,{id:"basic-navbar-nav",children:s.jsx(ws,{className:"ms-auto me-auto",children:s.jsx(Te,{title:Oe[r],children:c.map((a,i)=>s.jsx(Te.Item,{href:u(a),children:Oe[a]},i))})})})]})},St=({items:e,setItemsDisplayed:t,PAGE_LENGTH:n})=>{const[r,c]=y(parseInt(V().get("page")??"1")),l=Math.ceil(e.length/n),u=h=>{const a=h.target.closest("a.page-link");if(!a)return;let i;a.innerText.includes("First")?i=1:a.innerText.includes("Previous")?i=Math.max(1,r-1):a.innerText.includes("Next")?i=Math.min(l,r+1):a.innerText.includes("Last")?i=l:i=parseInt(a.innerText),console.log(`Page change from: ${r} to: ${i}`),c(i),Ds("page",i.toString()),document.querySelector("#x-scroll-anchor").scrollIntoView()};return T(()=>{const h=[];for(let a=0;a<e.length;++a)if(Math.floor(a/n)+1===r){const i=e[a];if(i.loopIndex=`${a+1} / ${e.length}`,h.push(i),h.length===n)break}t(h),console.log("itemsDisplayed",h.length)},[r,e,t,n]),s.jsxs(ie,{style:{display:"flex",justifyContent:"center",flexWrap:"wrap",marginTop:"1rem"},onClick:u,children:[l>0&&s.jsx(ie.Prev,{disabled:r===1,style:{width:"4rem"}}),[...Array(l).keys()].map(h=>s.jsx(ie.Item,{active:h+1===r,children:h+1},h)),l>0&&s.jsx(ie.Next,{disabled:r===l,style:{width:"4rem"}})]})},Ct=e=>s.jsx("i",{className:"fa-solid fa-spinner fa-spin",...e}),Ve=({checkState:e,label:t})=>{const[n,r]=e;return s.jsxs(O,{children:[s.jsx(O.Check,{type:"switch",onChange:c=>r(c.target.checked),checked:n}),s.jsx("p",{children:t})]})},kt=({checkState:e,labelBefore:t,labelAfter:n,maxWidth:r="3rem",textState:c})=>{const[l,u]=e,[h,a]=c,i=p=>{a(p.target.value),u(!1)},d=p=>{p.key==="Enter"?(u(!0),p.preventDefault()):u(!1)};return s.jsxs(O,{children:[s.jsx(O.Check,{type:"switch",onChange:p=>u(p.target.checked),checked:l}),s.jsx("p",{children:t}),s.jsx(O.Control,{value:h,onChange:i,style:{maxWidth:r},onKeyDown:d}),n&&s.jsx("p",{children:n})]})},bt=({label:e,maxWidth:t,addrState:n,priceState:r,agencyState:c,idState:l})=>{const[u,h]=y(""),[a,i]=n,[d,p]=r,[x,v]=c,[S,I]=l,g=(_,w="")=>{w=w.trim(),_==="address"?i(w):_==="price"?p(w):_==="agency"?v(w):_==="id"&&I(w)},N=_=>{h(_.target.value)},b=_=>{_.key==="Enter"&&(_.preventDefault(),g("address",u))};return s.jsxs(s.Fragment,{children:[s.jsxs(O,{children:[e&&s.jsx("p",{children:e}),s.jsx(O.Control,{value:u,onChange:N,style:{maxWidth:t},onKeyDown:b}),s.jsxs($s,{title:"Search",variant:"success",id:"x-btn-search",onSelect:_=>g(_,u),children:[s.jsx(ce.Item,{eventKey:"address",children:"in Address"}),s.jsx(ce.Item,{eventKey:"price",children:"in Price"}),s.jsx(ce.Item,{eventKey:"agency",children:"in Agency"}),s.jsx(ce.Item,{eventKey:"id",children:"in ID"})]})]}),a&&s.jsxs(ee,{pill:!0,bg:"primary",children:[s.jsx(le,{onClick:()=>g("address"),variant:"white"}),s.jsx("span",{children:a})]}),d&&s.jsxs(ee,{pill:!0,bg:"info",text:"dark",children:[s.jsx(le,{onClick:()=>g("price")}),s.jsx("span",{children:d})]}),x&&s.jsxs(ee,{pill:!0,bg:"light",text:"dark",children:[s.jsx(le,{onClick:()=>g("agency")}),s.jsx("span",{children:x})]}),S&&s.jsxs(ee,{pill:!0,bg:"dark",children:[s.jsx(le,{onClick:()=>g("id"),variant:"white"}),s.jsx("span",{children:S})]})]})},It=({data:e,setItemsSelectable:t,PAGE_LENGTH:n})=>{const r=V(),[c,l]=y(r.get("stc")==="1"),[u,h]=y(r.get("address")??""),[a,i]=y(r.get("agency")??""),[d,p]=y(r.get("noFlat")==="1"),[x,v]=y(!1),[S,I]=y("0.3"),[g,N]=y(""),[b,_]=y(""),w=j=>j.toLowerCase().replaceAll(" ","");T(()=>{const j=V();c?j.set("stc","1"):j.delete("stc"),d?j.set("noFlat","1"):j.delete("noFlat"),u!==""?j.set("address",u):j.delete("address"),a!==""?j.set("agency",a):j.delete("agency"),ge(j)},[c,d,u,a]),T(()=>{const j=parseFloat(S),Z=w(u);let J,q;a==="z"?(J="",q=!0):(J=w(a),q=!1);const K=[];e.items.forEach(k=>{c&&k.sold_let||d&&k.property_group_icon==="🏢"||x&&k.closest&&j&&k.closest.miles>j||Z&&!w((k.address_street_num||"")+k.address+k.address_postcode).includes(Z)||g&&!k.price.toString().includes(g)||q&&(k.zoopla_advert_id||k.zoopla_uprn)||b&&!k.id.toString().includes(b)||J&&!w(k.agency.caption).includes(J)||K.push(k)}),t(K),console.log("itemsSelectable",K.length);const G=V();parseInt(G.get("page")??"1")>Math.ceil(K.length/n)&&(G.set("page","1"),ge(G))},[c,d,x,u,g,a,b]);const W=e.items.filter(j=>j.sold_let).length,se=e.items.filter(j=>j.property_group_icon==="🏢").length;return s.jsxs(s.Fragment,{children:[s.jsx($t,{data:e}),s.jsx(Dt,{searches:e.searches,title:e.title}),s.jsx(Ve,{checkState:[c,l],label:`Exclude the ${W} STCs`}),s.jsx(Ve,{checkState:[d,p],label:`Exclude the ${se} flats`}),s.jsx(kt,{checkState:[x,v],labelBefore:"Exclude further than",labelAfter:"miles",maxWidth:"3rem",textState:[S,I]}),s.jsx(bt,{maxWidth:"8rem",addrState:[u,h],priceState:[g,N],agencyState:[a,i],idState:[b,_]})]})},$t=({data:e})=>s.jsxs("p",{children:[s.jsxs("span",{className:"x-nowrap",children:["Updated"," ",s.jsx("span",{id:"x-updated-relative",className:"x-date-relative","data-convert":"hours","data-date":e.updated_on,children:Re(e.updated_on)})," ","ago"]})," ",s.jsxs("span",{className:"x-nowrap",children:["(on ",s.jsx("span",{children:de(e.updated_on)}),")"]})," ",s.jsx("br",{}),"Next check starts in:"," ",s.jsx("span",{id:"x-nexton-relative",className:"x-date-relative","data-convert":"hours-negative","data-date":e.next_on,children:Re(e.next_on,!0)})]}),Dt=({searches:e,title:t})=>s.jsxs("p",{children:[t,". Based on ",s.jsx(re,{style:{verticalAlign:"baseline"}})," searches only:",s.jsx("br",{}),e&&e.map((n,r)=>s.jsx(zt,{search:n},r)).reduce(P)]}),zt=({search:e})=>s.jsxs("span",{className:"x-nowrap",children:[s.jsx("a",{rel:"noreferrer",target:"_blank",href:e.url_r,children:s.jsx(re,{isLink:!0,style:{verticalAlign:"sub"}})})," ",s.jsx("a",{rel:"noreferrer",target:"_blank",href:e.url_z,children:s.jsx(H,{isLink:!0,style:{verticalAlign:"sub"}})})," ",s.jsx("a",{rel:"noreferrer",target:"_blank",href:e.url_o,children:s.jsx(We,{isLink:!0,style:{verticalAlign:"sub"}})})," ",s.jsx("strong",{children:e.name})]}),At=({fileNoExt:e})=>{const t=E(null),[n,r]=y({__loading:!0}),[c,l]=y([]),[u,h]=y([]),a=parseInt(V().get("page")??"1"),i=10;if(T(()=>{let d=!0;return(async()=>{try{const x=localStorage.getItem("location"),v=x===e?localStorage.getItem("next_on"):null,S=x===e?localStorage.getItem("last_attempt"):null,I=new Date().valueOf();let g,N;S&&I-new Date(S).valueOf()<4e3?(N="FORCE RELOAD due to 2 attempts within 4s",g="reload"):v?new Date(v).valueOf()>I?(N="Keep CACHED data",g="force-cache"):(N="RELOADING as cache data expired",g="reload"):(N="LOAD first time",g="reload"),console.log(`Cache Loading info = ${N}`),t.current&&(t.current.innerText=N);const b=`https://raw.githubusercontent.com/solfegedev/solfegedev.github.io/main/data/${e}.json`;console.log(`Fetch data from server: ${b}`);const _=await fetch(b,{cache:g});if(!_.ok){const W=_.status===404?"This link seems wrong, check you have the correct one":`Failed to get data for: ${e}`;throw new Error(W)}const w=await _.json();localStorage.setItem("location",e),localStorage.setItem("next_on",new Date(w.next_on).toISOString()),localStorage.setItem("last_attempt",new Date().toISOString()),console.log(w),d&&r(w)}catch(x){d&&r({__error:`${x}`})}})().catch(console.error),()=>{d=!1}},[e]),n.favicon){const d=document.querySelector("link[rel='icon']");d.href=`img/properties/${n.favicon}`}if(document.title=n.region,n.__loading)return s.jsxs("main",{children:[s.jsx(Ct,{id:"x-spinner"}),s.jsx("p",{id:"x-spinner-info",ref:t})]});if(n.__error)return s.jsx("main",{style:{color:"red"},children:n.__error});{const d=(a-1)*i+1,p=c.length,x=Math.min(p,d+i-1),v=s.jsx(St,{items:c,setItemsDisplayed:h,PAGE_LENGTH:i});return s.jsxs(s.Fragment,{children:[s.jsx(Nt,{}),s.jsxs("main",{children:[s.jsx(It,{data:n,setItemsSelectable:l,PAGE_LENGTH:i}),s.jsxs("div",{id:"x-scroll-anchor",children:[v,p===0?s.jsx("p",{children:s.jsx("strong",{children:"No matching results"})}):s.jsxs("p",{children:["Page ",s.jsx("strong",{children:a}),": properties ",s.jsx("strong",{children:d})," -",s.jsx("strong",{children:x})," out of ",s.jsx("strong",{children:p})]}),u&&u.map((S,I)=>s.jsx(vt,{item:S},I))]}),v]})]})}},Ft=()=>{const e=V().get("data")??"properties_chesterfield_ashgate";return s.jsx(At,{fileNoExt:e})};hs.createRoot(document.getElementById("root")).render(s.jsx(xs.StrictMode,{children:s.jsx(Ft,{})}));
