import{j as e,c as w}from"./client-B8KsQLkO.js";import{H as D,i as R,C as k}from"./CookieConsentWrapper-BX3Mx7Xo.js";import T,{createContext as v,useState as x,useContext as S,useEffect as C}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import{I,A as y}from"./Comps-CK47dn9n.js";import{g as L}from"./googleMap-BAji2fQs.js";import{D as A,a as b}from"./dates-ZEyg73w4.js";import{N as h,a as G,b as N}from"./NavDropdown-0dASVYjy.js";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"./ThemeProvider-DUEYKiOx.js";import"./useMergedRefs-BEcJmFAT.js";import"./Button-BQhh39PT.js";import"./Nav-DL_WA_ME.js";import"./TransitionWrapper-BMbdxB92.js";import"./CardHeaderContext-Dz0GHBZ8.js";import"./CloseButton-BhSrBPCf.js";const M=async({id:t,numDays:s})=>{const r=`https://api.eu.membr.com/api/public/gyms/${t}/bookings`,a=new Date;a.setHours(5),a.setMinutes(0),a.setSeconds(0);const c=new Date(a.getTime()+s*A);c.setHours(23),console.log(`Fetch API for slots from ${a} to ${c}`);const i={page:"1",page_size:"100",from_date:a.toISOString(),to_date:c.toISOString(),locale:"en_GB"};return fetch(r+"?"+new URLSearchParams(i).toString()).then(o=>o.json()).then(o=>(console.log("API response: ",o),{data:o.data.map(n=>{const f={public:n.public,location:n.location.name,staff:n.staff.user.fullName,time:n.events.eventTime,dateStart:n.events.dateStart,name:n.events.name,placesReserved:n.attendancesNumber,placesRemaining:n.remainingPlaces,placesTotal:n.places};return(n.costInc>0||n.costExc)&&(f.cost=`cost incl/excl: Â£${n.costInc} / Â£${n.costExc}`),f})}))},u={Chesterfield:1548,"Sheffield South":1554,"Sheffield North":1555,Mansfield:1587,Rotherham:1550,Luton:2788},j=v(null),_=({children:t})=>{const[s,r]=x(Object.keys(u).at(0)),a={gymName:s,setGymName:r};return e.jsx(j.Provider,{value:a,children:t})},$=({dateStr:t})=>{const s=new Date(t).toLocaleDateString("en-GB",{weekday:"long",day:"numeric"});return e.jsx("div",{className:"x-delimiter",children:s})},B=()=>{const[t,s]=x(!0),r=S(j),a=i=>{s(i)},c=r.gymName.toLowerCase().replaceAll(" ","-");return e.jsxs(h,{id:"x-navbar",expand:"sm",variant:"dark",onToggle:a,expanded:t,children:[e.jsx(h.Brand,{href:`https://www.jdgyms.co.uk/gym/${c}/`,children:e.jsx(I,{src:"https://www.jdgyms.co.uk/wp-content/themes/jdgyms/assets/images/jdgyms-logo.png",height:"32"})}),e.jsx(h.Toggle,{"aria-controls":"basic-navbar-nav"}),e.jsx(h.Collapse,{id:"basic-navbar-nav",children:e.jsx(G,{className:"ms-auto me-auto",children:e.jsx(N,{title:r.gymName,onSelect:i=>{r.setGymName(i)},active:!0,children:Object.keys(u).map((i,o)=>e.jsx(N.Item,{active:i===r.gymName,eventKey:i,children:i},o))})})})]})},P=({name:t})=>{const s=t.toLowerCase().replace(/^jd\s+/,"").replace("les mills ","").replace(" - ladies only","");return s==="spin"?e.jsx("i",{className:"fa-solid fa-person-biking",style:{marginRight:"0.5rem",color:"#0284c7"}}):s==="hiit"?e.jsx("i",{className:"fa-solid fa-temperature-arrow-up",style:{marginRight:"0.5rem",color:"#dc2626"}}):s==="burn"?e.jsx("i",{className:"fa-solid fa-fire",style:{marginRight:"0.5rem",color:"#f97316"}}):s==="yoga"?e.jsx("i",{className:"fa-brands fa-y-combinator",style:{marginRight:"0.5rem",color:"#e879f9"}}):s==="body balance"?e.jsx("i",{className:"fa-solid fa-scale-balanced",style:{marginRight:"0.5rem",color:"#047857"}}):s==="body pump"?e.jsx("i",{className:"fa-solid fa-pump-soap",style:{marginRight:"0.5rem",color:"#1e3a8a"}}):s==="body conditioning"?e.jsx("i",{className:"fa-solid fa-dumbbell",style:{marginRight:"0.5rem",color:"#a8a29e"}}):s==="abs"?e.jsx("i",{className:"fa-brands fa-angular",style:{marginRight:"0.5rem",color:"#fde047"}}):s==="pilates"?e.jsx("i",{className:"fa-brands fa-product-hunt",style:{marginRight:"0.5rem",color:"#1e3a8a"}}):s==="lbt"?e.jsx("i",{className:"fa-solid fa-drumstick-bite",style:{marginRight:"0.5rem",color:"#a56f07"}}):s.includes("combat")||s==="body attack"?e.jsx("i",{className:"fa-solid fa-user-ninja",style:{marginRight:"0.5rem",color:"#ad0808"}}):s==="step"?e.jsx("i",{className:"fa-solid fa-stairs",style:{marginRight:"0.5rem",color:"#9f9e9c"}}):s==="x-fit"?e.jsx("i",{className:"fa-solid fa-xmark",style:{marginRight:"0.5rem",color:"#0e7b0e"}}):s==="circuits"?e.jsx("i",{className:"fa-solid fa-flag-checkered",style:{marginRight:"0.5rem",color:"#000"}}):s==="bootcamp"?e.jsx("i",{className:"fa-solid fa-campground",style:{marginRight:"0.5rem",color:"#047857"}}):s==="zumba"?e.jsx("span",{children:"ðŸ’ƒ"}):s.includes("induction")?e.jsx("i",{className:"fa-solid fa-baby",style:{marginRight:"0.5rem",color:"#a56f07"}}):null},O=({evt:t,now:s})=>{const r=new Date(t.dateStart).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),a={backgroundColor:"#ffa8a8"},i=new Date(t.dateStart).getTime()-s.getTime(),o=i/6e4,m={};let g=null;return o<-t.time?m.backgroundImage="repeating-linear-gradient(-45deg, #bbb 0 1px, #eee 1px 0.8rem)":o<0?(m.backgroundColor="#ffffb6",g=e.jsxs("span",{children:[b(-i)," ago"]})):o<3*60&&(g=e.jsxs("span",{style:{color:"#f00"},children:["in ",b(i)]})),e.jsxs("div",{style:{...m,marginTop:"0.5rem"},children:[e.jsxs("div",{className:"x-flex-container",style:{fontWeight:"bold",color:"#1e293b"},children:[e.jsx("div",{className:"x-flex-left",children:r}),e.jsxs("div",{className:"x-flex-right",children:[e.jsxs("span",{style:{fontSize:"1.2rem"},children:[e.jsx(P,{name:t.name}),t.name]})," ","(",t.time," min)"]})]}),e.jsxs("div",{className:"x-flex-container",children:[e.jsx("div",{className:"x-flex-left",style:{fontSize:"0.7rem"},children:g}),e.jsxs("div",{className:"x-flex-right x-caption",children:[e.jsxs("p",{children:[e.jsx("b",{children:t.location})," - ",e.jsx("span",{className:"x-gym-staff",children:t.staff})]}),e.jsxs("p",{children:[e.jsx("b",{children:t.placesRemaining})," places"," ",t.placesRemaining!==t.placesTotal&&` left (out of ${t.placesTotal} total)`]})]})]}),t.cost&&e.jsx("p",{style:a,children:t.cost}),!t.public&&e.jsx("p",{style:a,children:"private class"})]})},z=()=>{const[t,s]=x(),[r,a]=x(new Date),c=S(j);if(C(()=>{(async function(){const l=await M({id:u[c.gymName],numDays:7});s(l)})();const d=()=>{if(document.visibilityState==="visible"){const l=new Date;console.log("Update time 'now': ",l),a(l)}};return document.addEventListener("visibilitychange",d),()=>{document.removeEventListener("visibilitychange",d)}},[c.gymName]),!t)return e.jsx("main",{children:"Loading..."});const i=t.data.sort((d,l)=>d.dateStart>l.dateStart?1:-1),o=[];let m="";i.forEach((d,l)=>{const p=d.dateStart.substring(0,10);p!==m&&o.push(e.jsx($,{dateStr:p},`${l}-delimiter`)),m=p,o.push(e.jsx(O,{evt:d,now:r},l))});const g=r.toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"short",year:"numeric"}),n=r.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),f=L({origin:D.join(","),destination:`JD+Gyms+${c.gymName.replaceAll(" ","+")}`,isSatellite:!0,hasTraffic:!0});return e.jsxs(e.Fragment,{children:[e.jsx(B,{}),e.jsxs("main",{children:[e.jsxs("div",{id:"x-gym-links",children:[e.jsx(y,{href:`https://bookings.widgets.eu.membr.com/calendar/gym/${u[c.gymName]}?primaryColor=%236ABD45&showProfilePicture=0&theme=light`,children:"JD Calendar"}),e.jsx(y,{href:f,children:"Traffic"})]}),e.jsxs("p",{children:[g," at ",e.jsx("b",{children:n})]}),e.jsx("div",{style:{width:R?"45rem":"100vw",margin:"auto"},children:o})]})]})};w.createRoot(document.getElementById("root")).render(e.jsx(T.StrictMode,{children:e.jsx(k,{children:e.jsx(_,{children:e.jsx(z,{})})})}));
