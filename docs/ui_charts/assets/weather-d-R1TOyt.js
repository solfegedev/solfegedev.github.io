var st=Object.defineProperty;var ot=(e,t,r)=>t in e?st(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ke=(e,t,r)=>ot(e,typeof t!="symbol"?t+"":t,r);import{j as c,c as lt}from"./client-B8KsQLkO.js";import{i as U,C as ct}from"./CookieConsentWrapper-BX3Mx7Xo.js";import ge,{useState as P,useEffect as k,forwardRef as We,useRef as ne}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import{_adapters as dt,Chart as me,CategoryScale as ft,LinearScale as ut,PointElement as Ee,LineElement as ht,BarElement as Le,Title as bt,Tooltip as gt,Legend as mt,Filler as yt,TimeScale as pt,TimeSeriesScale as xt,LineController as Ne,defaults as vt,ArcElement as _t,BarController as wt}from"https://cdn.jsdelivr.net/npm/chart.js@4.4.4/+esm";import w from"https://cdn.jsdelivr.net/npm/moment@2.30.1/+esm";import{I as Ue,L as F,A as kt}from"./LinkItem-KKG5ywFW.js";import{T as jt}from"./Table-D95Yq_LC.js";import{H as Ct,M as Mt,D as It}from"./dates-CXaDObX2.js";import{N as K,a as je,b as Ce}from"./NavDropdown-B6vjD2zC.js";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"./Button-Dbum-Du3.js";import"./CloseButton-CUYUvxPi.js";import"./Dropdown-BtRWb2wP.js";const St={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};dt._date.override(typeof w=="function"?{_id:"moment",formats:function(){return St},parse:function(e,t){return typeof e=="string"&&typeof t=="string"?e=w(e,t):e instanceof w||(e=w(e)),e.isValid()?e.valueOf():null},format:function(e,t){return w(e).format(t)},add:function(e,t,r){return w(e).add(t,r).valueOf()},diff:function(e,t,r){return w(e).diff(w(t),r)},startOf:function(e,t,r){return e=w(e),t==="isoWeek"?(r=Math.trunc(Math.min(Math.max(0,r),6)),e.isoWeekday(r).startOf("day").valueOf()):e.startOf(t).valueOf()},endOf:function(e,t){return w(e).endOf(t).valueOf()}}:{});const Ot=()=>{me.register(ft,ut,Ee,ht,Le,bt,gt,mt,yt,pt,xt,Ne)},ye=[{name:"Chesterfield",coords:[53.248,-1.471],linkWU:"gb/chesterfield/ICHEST186",bbcID:"2653225"},{name:"Hitchin",coords:[51.958,-.283],linkWU:"gb/hitchin/IHITCH24",bbcID:"2646826"},{name:"Milan, ITA",coords:[45.464,9.189],linkWU:"it/milan",bbcID:"3173435"},{name:"Maribor, SLO",coords:[46.609,15.68],linkWU:"si/pesnica/IPESNI3",bbcID:"3195506"},{name:"London",coords:[51.512,-.123],linkWU:"gb/london/ILONDO533",bbcID:"6296599"},{name:"Peak District - Hope",coords:[53.287,-1.715],linkWU:"gb/hope/IHOPE37",bbcID:"2646640"},{name:"Lake District - Ambleside",coords:[54.428,-2.959],linkWU:"gb/ambleside/IAMBLE18",bbcID:"2657360"},{name:"Wales - Holiday Park",coords:[53.148,-4.194],linkWU:"gb/caernarfon/ICAERN3",bbcID:"2643958"},{name:"Fort William, SCOT",coords:[56.818,-5.104],linkWU:"gb/fort-william",bbcID:"2649169"},{name:"Los Angeles, USA",coords:[34.054,-118.242],linkWU:"us/ca/los-angeles",bbcID:"5368361"},{name:"Oxford",coords:[51.722,-1.222],linkWU:"gb/oxford/IOXFOR119",bbcID:"2640729"},{name:"Paris, FRA",coords:[48.871,2.357],linkWU:"fr/paris/IPARIS18258",bbcID:"2988507"},{name:"Cabourg, FRA",coords:[49.291,-.116],linkWU:"fr/cabourg/ICABOU1",bbcID:"3029297"}];class fe{constructor(){ke(this,"searchParams");this.searchParams=new URLSearchParams(window.location.search)}getLocation(){const t=this.searchParams.get("location")??localStorage.getItem("weather_location")??ye[0].name;return localStorage.setItem("weather_location",t),t}isAurora(){return this.searchParams.get("aurora")==="true"}}const x={Pollution:"#555",UV:"#fc0",Pollen:"#155e75",Tree:"#a16207",Grass:"#84cc16",Weed:"#16a34a"},At=()=>{const[e,t]=P(new Date);k(()=>{const a=()=>{if(document.visibilityState==="visible"){const i=new Date;console.log("Update time 'now': ",i),t(i)}};return document.addEventListener("visibilitychange",a),()=>{document.removeEventListener("visibilitychange",a)}},[]);const r=e.toLocaleDateString("en-GB",{hour:"2-digit",minute:"2-digit",weekday:"short",day:"numeric",month:"short",year:"numeric",timeZoneName:"short"}),n=e.toISOString().substring(11,16);return c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:[r," = ",n," UTC"]}),c.jsx(Dt,{name:"1-hour forecast (NOAA)",link:"https://services.swpc.noaa.gov/images/animations/ovation/north/latest.jpg"}),c.jsx(Tt,{}),c.jsx(Z,{name:"1-day A index (Lancaster University)",link:"https://aurorawatch.lancs.ac.uk/summary/alerting-site-rolling-activity.png"}),c.jsx(Z,{name:"8-day K index (British Geological Survey)",link:"https://geomag.bgs.ac.uk/images/kandkp_bar.jpg"}),c.jsx(Z,{name:"7-day K index (NOAA)",link:"https://services.swpc.noaa.gov/images/station-k-index.png"}),c.jsx(Z,{name:"30-day A index (NOAA)",link:"https://services.swpc.noaa.gov/images/station-a-index.png"}),c.jsx(Pt,{})]})},Z=({name:e,link:t,...r})=>("style"in r||(r.style={}),r.style.width=U?"30vw":"100vw",c.jsxs("div",{className:"x-section",children:[e,":",c.jsx("br",{}),c.jsx(Ue,{src:t,alt:e,...r})]})),Dt=({name:e,link:t})=>{const r=U?"30vw":"100vw";return c.jsxs("div",{className:"x-section",children:[e,":",c.jsx("br",{}),c.jsxs("div",{style:{position:"relative",width:r,height:r,marginLeft:"auto",marginRight:"auto"},children:[c.jsx(Ue,{src:t,alt:e,style:{position:"absolute",width:r,height:r,top:0,left:0,transform:"rotate(90deg)"}}),c.jsx("div",{style:{position:"absolute",top:"77%",left:"60%",color:"#F00",fontWeight:"bold",fontSize:"1rem"},children:"X"})]})]})},Pt=()=>c.jsxs("div",{className:"x-shadow",style:{width:"fit-content"},children:["Other links:",c.jsxs("ul",{children:[c.jsx(F,{href:"https://www.spaceweatherlive.com/en/auroral-activity/aurora-forecast.html",children:"3-Day + 27-Day Forecast (Spaceweatherlive)"}),c.jsx(F,{href:"https://www.gi.alaska.edu/monitors/aurora-forecast#forecast-level-formatting",children:"27-Day Forecast"})]})]}),Tt=()=>{const[e,t]=P();return k(()=>{(async function(){const n=await(await fetch("https://services.swpc.noaa.gov/text/3-day-forecast.txt")).text();t(n)})()},[]),c.jsxs("div",{className:"x-section",children:[c.jsx(kt,{href:"https://services.swpc.noaa.gov/text/3-day-forecast.txt",children:"3-day forecast (NOAA)"}),":",c.jsx("br",{}),c.jsx(Ft,{content:e})]})},Ft=({content:e})=>{var o;let t=/breakdown.*?\n+(.*?)\n+Rationale/ms.exec(e||"");const r=(o=t==null?void 0:t.at(1))==null?void 0:o.split(`
`);if(!r)return c.jsx("p",{children:"No results"});const n=r[0].trim().split(new RegExp("(?<=\\d) +"));n.unshift("");const a=r.slice(1).map(l=>l.trim().split(/ {2,}/));t=/:Issued:(.*)/.exec(e||"");const i=t==null?void 0:t.at(1),s=U?"22rem":"inherit";return c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:["Forecast updated on: ",i]}),c.jsxs(jt,{size:"sm",style:{width:s,margin:"auto"},children:[c.jsx("thead",{children:c.jsx("tr",{children:n.map((l,d)=>c.jsx("th",{children:l},d))})}),c.jsx("tbody",{children:a.map((l,d)=>c.jsx("tr",{children:l.map((f,u)=>c.jsx("td",{children:f},u))},d))})]})]})};function G(e){return e+.5|0}const D=(e,t,r)=>Math.max(Math.min(e,r),t);function Y(e){return D(G(e*2.55),0,255)}function T(e){return D(G(e*255),0,255)}function I(e){return D(G(e/2.55)/100,0,1)}function Me(e){return D(G(e*100),0,100)}const p={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},ue=[..."0123456789ABCDEF"],Rt=e=>ue[e&15],Wt=e=>ue[(e&240)>>4]+ue[e&15],q=e=>(e&240)>>4===(e&15),Et=e=>q(e.r)&&q(e.g)&&q(e.b)&&q(e.a);function Lt(e){var t=e.length,r;return e[0]==="#"&&(t===4||t===5?r={r:255&p[e[1]]*17,g:255&p[e[2]]*17,b:255&p[e[3]]*17,a:t===5?p[e[4]]*17:255}:(t===7||t===9)&&(r={r:p[e[1]]<<4|p[e[2]],g:p[e[3]]<<4|p[e[4]],b:p[e[5]]<<4|p[e[6]],a:t===9?p[e[7]]<<4|p[e[8]]:255})),r}const Nt=(e,t)=>e<255?t(e):"";function Ut(e){var t=Et(e)?Rt:Wt;return e?"#"+t(e.r)+t(e.g)+t(e.b)+Nt(e.a,t):void 0}const $t=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function $e(e,t,r){const n=t*Math.min(r,1-r),a=(i,s=(i+e/30)%12)=>r-n*Math.max(Math.min(s-3,9-s,1),-1);return[a(0),a(8),a(4)]}function Yt(e,t,r){const n=(a,i=(a+e/60)%6)=>r-r*t*Math.max(Math.min(i,4-i,1),0);return[n(5),n(3),n(1)]}function Bt(e,t,r){const n=$e(e,1,.5);let a;for(t+r>1&&(a=1/(t+r),t*=a,r*=a),a=0;a<3;a++)n[a]*=1-t-r,n[a]+=t;return n}function Ht(e,t,r,n,a){return e===a?(t-r)/n+(t<r?6:0):t===a?(r-e)/n+2:(e-t)/n+4}function pe(e){const r=e.r/255,n=e.g/255,a=e.b/255,i=Math.max(r,n,a),s=Math.min(r,n,a),o=(i+s)/2;let l,d,f;return i!==s&&(f=i-s,d=o>.5?f/(2-i-s):f/(i+s),l=Ht(r,n,a,f,i),l=l*60+.5),[l|0,d||0,o]}function xe(e,t,r,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,n)).map(T)}function ve(e,t,r){return xe($e,e,t,r)}function zt(e,t,r){return xe(Bt,e,t,r)}function Gt(e,t,r){return xe(Yt,e,t,r)}function Ye(e){return(e%360+360)%360}function Xt(e){const t=$t.exec(e);let r=255,n;if(!t)return;t[5]!==n&&(r=t[6]?Y(+t[5]):T(+t[5]));const a=Ye(+t[2]),i=+t[3]/100,s=+t[4]/100;return t[1]==="hwb"?n=zt(a,i,s):t[1]==="hsv"?n=Gt(a,i,s):n=ve(a,i,s),{r:n[0],g:n[1],b:n[2],a:r}}function Kt(e,t){var r=pe(e);r[0]=Ye(r[0]+t),r=ve(r),e.r=r[0],e.g=r[1],e.b=r[2]}function Zt(e){if(!e)return;const t=pe(e),r=t[0],n=Me(t[1]),a=Me(t[2]);return e.a<255?`hsla(${r}, ${n}%, ${a}%, ${I(e.a)})`:`hsl(${r}, ${n}%, ${a}%)`}const Ie={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Se={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function qt(){const e={},t=Object.keys(Se),r=Object.keys(Ie);let n,a,i,s,o;for(n=0;n<t.length;n++){for(s=o=t[n],a=0;a<r.length;a++)i=r[a],o=o.replace(i,Ie[i]);i=parseInt(Se[s],16),e[o]=[i>>16&255,i>>8&255,i&255]}return e}let V;function Vt(e){V||(V=qt(),V.transparent=[0,0,0,0]);const t=V[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const Qt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Jt(e){const t=Qt.exec(e);let r=255,n,a,i;if(t){if(t[7]!==n){const s=+t[7];r=t[8]?Y(s):D(s*255,0,255)}return n=+t[1],a=+t[3],i=+t[5],n=255&(t[2]?Y(n):D(n,0,255)),a=255&(t[4]?Y(a):D(a,0,255)),i=255&(t[6]?Y(i):D(i,0,255)),{r:n,g:a,b:i,a:r}}}function er(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${I(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const se=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,N=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function tr(e,t,r){const n=N(I(e.r)),a=N(I(e.g)),i=N(I(e.b));return{r:T(se(n+r*(N(I(t.r))-n))),g:T(se(a+r*(N(I(t.g))-a))),b:T(se(i+r*(N(I(t.b))-i))),a:e.a+r*(t.a-e.a)}}function Q(e,t,r){if(e){let n=pe(e);n[t]=Math.max(0,Math.min(n[t]+n[t]*r,t===0?360:1)),n=ve(n),e.r=n[0],e.g=n[1],e.b=n[2]}}function Be(e,t){return e&&Object.assign(t||{},e)}function Oe(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=T(e[3]))):(t=Be(e,{r:0,g:0,b:0,a:1}),t.a=T(t.a)),t}function rr(e){return e.charAt(0)==="r"?Jt(e):Xt(e)}class ae{constructor(t){if(t instanceof ae)return t;const r=typeof t;let n;r==="object"?n=Oe(t):r==="string"&&(n=Lt(t)||Vt(t)||rr(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=Be(this._rgb);return t&&(t.a=I(t.a)),t}set rgb(t){this._rgb=Oe(t)}rgbString(){return this._valid?er(this._rgb):void 0}hexString(){return this._valid?Ut(this._rgb):void 0}hslString(){return this._valid?Zt(this._rgb):void 0}mix(t,r){if(t){const n=this.rgb,a=t.rgb;let i;const s=r===i?.5:r,o=2*s-1,l=n.a-a.a,d=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;i=1-d,n.r=255&d*n.r+i*a.r+.5,n.g=255&d*n.g+i*a.g+.5,n.b=255&d*n.b+i*a.b+.5,n.a=s*n.a+(1-s)*a.a,this.rgb=n}return this}interpolate(t,r){return t&&(this._rgb=tr(this._rgb,t._rgb,r)),this}clone(){return new ae(this.rgb)}alpha(t){return this._rgb.a=T(t),this}clearer(t){const r=this._rgb;return r.a*=1-t,this}greyscale(){const t=this._rgb,r=G(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=r,this}opaquer(t){const r=this._rgb;return r.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Q(this._rgb,2,t),this}darken(t){return Q(this._rgb,2,-t),this}saturate(t){return Q(this._rgb,1,t),this}desaturate(t){return Q(this._rgb,1,-t),this}rotate(t){return Kt(this._rgb,t),this}}function L(e){return e===null||typeof e>"u"}function X(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function j(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function A(e,t){return typeof e>"u"?t:e}function He(e,t,r){if(e&&typeof e.call=="function")return e.apply(r,t)}function nr(e,t,r,n){let a,i,s;if(X(e))for(i=e.length,a=0;a<i;a++)t.call(r,e[a],a);else if(j(e))for(s=Object.keys(e),i=s.length,a=0;a<i;a++)t.call(r,e[s[a]],s[a])}function he(e){if(X(e))return e.map(he);if(j(e)){const t=Object.create(null),r=Object.keys(e),n=r.length;let a=0;for(;a<n;++a)t[r[a]]=he(e[r[a]]);return t}return e}function ar(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function ir(e,t,r,n){if(!ar(e))return;const a=t[e],i=r[e];j(a)&&j(i)?R(a,i,n):t[e]=he(i)}function R(e,t,r){const n=X(t)?t:[t],a=n.length;if(!j(e))return e;r=r||{};const i=r.merger||ir;let s;for(let o=0;o<a;++o){if(s=n[o],!j(s))continue;const l=Object.keys(s);for(let d=0,f=l.length;d<f;++d)i(l[d],e,s,r)}return e}const Ae=Math.log10;function sr(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function oe(e){return sr(e)?e:new ae(e).saturate(.5).darken(.1).hexString()}const or=["x","y","borderWidth","radius","tension"],lr=["color","borderColor","backgroundColor"];function cr(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:lr},numbers:{type:"number",properties:or}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function dr(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const De=new Map;function fr(e,t){t=t||{};const r=e+JSON.stringify(t);let n=De.get(r);return n||(n=new Intl.NumberFormat(e,t),De.set(r,n)),n}function ur(e,t,r){return fr(t,r).format(e)}const ze={values(e){return X(e)?e:""+e},numeric(e,t,r){if(e===0)return"0";const n=this.chart.options.locale;let a,i=e;if(r.length>1){const d=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(d<1e-4||d>1e15)&&(a="scientific"),i=hr(e,r)}const s=Ae(Math.abs(i)),o=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),l={notation:a,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),ur(e,n,l)},logarithmic(e,t,r){if(e===0)return"0";const n=r[t].significand||e/Math.pow(10,Math.floor(Ae(e)));return[1,2,3,5,10,15].includes(n)||t>.8*r.length?ze.numeric.call(this,e,t,r):""}};function hr(e,t){let r=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(r)>=1&&e!==Math.floor(e)&&(r=e-Math.floor(e)),r}var br={formatters:ze};function gr(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,r)=>r.lineWidth,tickColor:(t,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:br.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const mr=Object.create(null),yr=Object.create(null);function B(e,t){if(!t)return e;const r=t.split(".");for(let n=0,a=r.length;n<a;++n){const i=r[n];e=e[i]||(e[i]=Object.create(null))}return e}function le(e,t,r){return typeof t=="string"?R(B(e,t),r):R(B(e,""),t)}class pr{constructor(t,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,a)=>oe(a.backgroundColor),this.hoverBorderColor=(n,a)=>oe(a.borderColor),this.hoverColor=(n,a)=>oe(a.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(r)}set(t,r){return le(this,t,r)}get(t){return B(this,t)}describe(t,r){return le(yr,t,r)}override(t,r){return le(mr,t,r)}route(t,r,n,a){const i=B(this,t),s=B(this,n),o="_"+r;Object.defineProperties(i,{[o]:{value:i[r],writable:!0},[r]:{enumerable:!0,get(){const l=this[o],d=s[a];return j(l)?Object.assign({},d,l):A(l,d)},set(l){this[o]=l}}})}apply(t){t.forEach(r=>r(this))}}var xr=new pr({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[cr,dr,gr]);function vr(e){return!e||L(e.size)||L(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}const _r=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,wr=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function kr(e,t){const r=(""+e).match(_r);if(!r||r[1]==="normal")return t*1.2;switch(e=+r[2],r[3]){case"px":return e;case"%":e/=100;break}return t*e}const jr=e=>+e||0;function Cr(e,t){const r={},n=j(t),a=n?Object.keys(t):t,i=j(e)?n?s=>A(e[s],e[t[s]]):s=>e[s]:()=>e;for(const s of a)r[s]=jr(i(s));return r}function Mr(e){return Cr(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Ir(e){const t=Mr(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Sr(e,t){e=e||{},t=t||xr.font;let r=A(e.size,t.size);typeof r=="string"&&(r=parseInt(r,10));let n=A(e.style,t.style);n&&!(""+n).match(wr)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const a={family:A(e.family,t.family),lineHeight:kr(A(e.lineHeight,t.lineHeight),r),size:r,style:n,weight:A(e.weight,t.weight),string:""};return a.string=vr(a),a}function b(e,t,r,n){let a,i,s;for(a=0,i=e.length;a<i;++a)if(s=e[a],s!==void 0&&(t!==void 0&&typeof s=="function"&&(s=s(t)),r!==void 0&&X(s)&&(s=s[r%s.length]),s!==void 0))return s}function Or(){return typeof window<"u"&&typeof document<"u"}(function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Or()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e})();var Pe=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),H={toTextLines:function(e){var t=[],r;for(e=[].concat(e);e.length;)r=e.pop(),typeof r=="string"?t.unshift.apply(t,r.split(`
`)):Array.isArray(r)?e.push.apply(e,r):L(e)||t.unshift(""+r);return t},textSize:function(e,t,r){var n=[].concat(t),a=n.length,i=e.font,s=0,o;for(e.font=r.string,o=0;o<a;++o)s=Math.max(e.measureText(n[o]).width,s);return e.font=i,{height:a*r.lineHeight,width:s}},bound:function(e,t,r){return Math.max(e,Math.min(t,r))},arrayDiff:function(e,t){var r=e.slice(),n=[],a,i,s,o;for(a=0,s=t.length;a<s;++a)o=t[a],i=r.indexOf(o),i===-1?n.push([o,1]):r.splice(i,1);for(a=0,s=r.length;a<s;++a)n.push([r[a],-1]);return n},rasterize:function(e){return Math.round(e*Pe)/Pe}};function ce(e,t){var r=t.x,n=t.y;if(r===null)return{x:0,y:-1};if(n===null)return{x:1,y:0};var a=e.x-r,i=e.y-n,s=Math.sqrt(a*a+i*i);return{x:s?a/s:0,y:s?i/s:-1}}function Ar(e,t,r,n,a){switch(a){case"center":r=n=0;break;case"bottom":r=0,n=1;break;case"right":r=1,n=0;break;case"left":r=-1,n=0;break;case"top":r=0,n=-1;break;case"start":r=-r,n=-n;break;case"end":break;default:a*=Math.PI/180,r=Math.cos(a),n=Math.sin(a);break}return{x:e,y:t,vx:r,vy:n}}var Dr=0,Ge=1,Xe=2,Ke=4,Ze=8;function J(e,t,r){var n=Dr;return e<r.left?n|=Ge:e>r.right&&(n|=Xe),t<r.top?n|=Ze:t>r.bottom&&(n|=Ke),n}function Pr(e,t){for(var r=e.x0,n=e.y0,a=e.x1,i=e.y1,s=J(r,n,t),o=J(a,i,t),l,d,f;!(!(s|o)||s&o);)l=s||o,l&Ze?(d=r+(a-r)*(t.top-n)/(i-n),f=t.top):l&Ke?(d=r+(a-r)*(t.bottom-n)/(i-n),f=t.bottom):l&Xe?(f=n+(i-n)*(t.right-r)/(a-r),d=t.right):l&Ge&&(f=n+(i-n)*(t.left-r)/(a-r),d=t.left),l===s?(r=d,n=f,s=J(r,n,t)):(a=d,i=f,o=J(a,i,t));return{x0:r,x1:a,y0:n,y1:i}}function ee(e,t){var r=t.anchor,n=e,a,i;return t.clamp&&(n=Pr(n,t.area)),r==="start"?(a=n.x0,i=n.y0):r==="end"?(a=n.x1,i=n.y1):(a=(n.x0+n.x1)/2,i=(n.y0+n.y1)/2),Ar(a,i,e.vx,e.vy,t.align)}var te={arc:function(e,t){var r=(e.startAngle+e.endAngle)/2,n=Math.cos(r),a=Math.sin(r),i=e.innerRadius,s=e.outerRadius;return ee({x0:e.x+n*i,y0:e.y+a*i,x1:e.x+n*s,y1:e.y+a*s,vx:n,vy:a},t)},point:function(e,t){var r=ce(e,t.origin),n=r.x*e.options.radius,a=r.y*e.options.radius;return ee({x0:e.x-n,y0:e.y-a,x1:e.x+n,y1:e.y+a,vx:r.x,vy:r.y},t)},bar:function(e,t){var r=ce(e,t.origin),n=e.x,a=e.y,i=0,s=0;return e.horizontal?(n=Math.min(e.x,e.base),i=Math.abs(e.base-e.x)):(a=Math.min(e.y,e.base),s=Math.abs(e.base-e.y)),ee({x0:n,y0:a+s,x1:n+i,y1:a,vx:r.x,vy:r.y},t)},fallback:function(e,t){var r=ce(e,t.origin);return ee({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:r.x,vy:r.y},t)}},S=H.rasterize;function Tr(e){var t=e.borderWidth||0,r=e.padding,n=e.size.height,a=e.size.width,i=-a/2,s=-n/2;return{frame:{x:i-r.left-t,y:s-r.top-t,w:a+r.width+t*2,h:n+r.height+t*2},text:{x:i,y:s,w:a,h:n}}}function Fr(e,t){var r=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!r)return null;if(r.xCenter!==void 0&&r.yCenter!==void 0)return{x:r.xCenter,y:r.yCenter};var n=r.getBasePixel();return e.horizontal?{x:n,y:null}:{x:null,y:n}}function Rr(e){return e instanceof _t?te.arc:e instanceof Ee?te.point:e instanceof Le?te.bar:te.fallback}function Wr(e,t,r,n,a,i){var s=Math.PI/2;if(i){var o=Math.min(i,a/2,n/2),l=t+o,d=r+o,f=t+n-o,u=r+a-o;e.moveTo(t,d),l<f&&d<u?(e.arc(l,d,o,-Math.PI,-s),e.arc(f,d,o,-s,0),e.arc(f,u,o,0,s),e.arc(l,u,o,s,Math.PI)):l<f?(e.moveTo(l,r),e.arc(f,d,o,-s,s),e.arc(l,d,o,s,Math.PI+s)):d<u?(e.arc(l,d,o,-Math.PI,0),e.arc(l,u,o,0,Math.PI)):e.arc(l,d,o,-Math.PI,Math.PI),e.closePath(),e.moveTo(t,r)}else e.rect(t,r,n,a)}function Er(e,t,r){var n=r.backgroundColor,a=r.borderColor,i=r.borderWidth;!n&&(!a||!i)||(e.beginPath(),Wr(e,S(t.x)+i/2,S(t.y)+i/2,S(t.w)-i,S(t.h)-i,r.borderRadius),e.closePath(),n&&(e.fillStyle=n,e.fill()),a&&i&&(e.strokeStyle=a,e.lineWidth=i,e.lineJoin="miter",e.stroke()))}function Lr(e,t,r){var n=r.lineHeight,a=e.w,i=e.x,s=e.y+n/2;return t==="center"?i+=a/2:(t==="end"||t==="right")&&(i+=a),{h:n,w:a,x:i,y:s}}function Nr(e,t,r){var n=e.shadowBlur,a=r.stroked,i=S(r.x),s=S(r.y),o=S(r.w);a&&e.strokeText(t,i,s,o),r.filled&&(n&&a&&(e.shadowBlur=0),e.fillText(t,i,s,o),n&&a&&(e.shadowBlur=n))}function Ur(e,t,r,n){var a=n.textAlign,i=n.color,s=!!i,o=n.font,l=t.length,d=n.textStrokeColor,f=n.textStrokeWidth,u=d&&f,m;if(!(!l||!s&&!u))for(r=Lr(r,a,o),e.font=o.string,e.textAlign=a,e.textBaseline="middle",e.shadowBlur=n.textShadowBlur,e.shadowColor=n.textShadowColor,s&&(e.fillStyle=i),u&&(e.lineJoin="round",e.lineWidth=f,e.strokeStyle=d),m=0,l=t.length;m<l;++m)Nr(e,t[m],{stroked:u,filled:s,w:r.w,x:r.x,y:r.y+r.h*m})}var qe=function(e,t,r,n){var a=this;a._config=e,a._index=n,a._model=null,a._rects=null,a._ctx=t,a._el=r};R(qe.prototype,{_modelize:function(e,t,r,n){var a=this,i=a._index,s=Sr(b([r.font,{}],n,i)),o=b([r.color,vt.color],n,i);return{align:b([r.align,"center"],n,i),anchor:b([r.anchor,"center"],n,i),area:n.chart.chartArea,backgroundColor:b([r.backgroundColor,null],n,i),borderColor:b([r.borderColor,null],n,i),borderRadius:b([r.borderRadius,0],n,i),borderWidth:b([r.borderWidth,0],n,i),clamp:b([r.clamp,!1],n,i),clip:b([r.clip,!1],n,i),color:o,display:e,font:s,lines:t,offset:b([r.offset,4],n,i),opacity:b([r.opacity,1],n,i),origin:Fr(a._el,n),padding:Ir(b([r.padding,4],n,i)),positioner:Rr(a._el),rotation:b([r.rotation,0],n,i)*(Math.PI/180),size:H.textSize(a._ctx,t,s),textAlign:b([r.textAlign,"start"],n,i),textShadowBlur:b([r.textShadowBlur,0],n,i),textShadowColor:b([r.textShadowColor,o],n,i),textStrokeColor:b([r.textStrokeColor,o],n,i),textStrokeWidth:b([r.textStrokeWidth,0],n,i)}},update:function(e){var t=this,r=null,n=null,a=t._index,i=t._config,s,o,l,d=b([i.display,!0],e,a);d&&(s=e.dataset.data[a],o=A(He(i.formatter,[s,e]),s),l=L(o)?[]:H.toTextLines(o),l.length&&(r=t._modelize(d,l,i,e),n=Tr(r))),t._model=r,t._rects=n},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,t){var r=this,n=e.ctx,a=r._model,i=r._rects,s;this.visible()&&(n.save(),a.clip&&(s=a.area,n.beginPath(),n.rect(s.left,s.top,s.right-s.left,s.bottom-s.top),n.clip()),n.globalAlpha=H.bound(0,a.opacity,1),n.translate(S(t.x),S(t.y)),n.rotate(a.rotation),Er(n,i.frame,a),Ur(n,a.lines,i.text,a),n.restore())}});var $r=Number.MIN_SAFE_INTEGER||-9007199254740991,Yr=Number.MAX_SAFE_INTEGER||9007199254740991;function $(e,t,r){var n=Math.cos(r),a=Math.sin(r),i=t.x,s=t.y;return{x:i+n*(e.x-i)-a*(e.y-s),y:s+a*(e.x-i)+n*(e.y-s)}}function Te(e,t){var r=Yr,n=$r,a=t.origin,i,s,o,l,d;for(i=0;i<e.length;++i)s=e[i],o=s.x-a.x,l=s.y-a.y,d=t.vx*o+t.vy*l,r=Math.min(r,d),n=Math.max(n,d);return{min:r,max:n}}function re(e,t){var r=t.x-e.x,n=t.y-e.y,a=Math.sqrt(r*r+n*n);return{vx:(t.x-e.x)/a,vy:(t.y-e.y)/a,origin:e,ln:a}}var Ve=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};R(Ve.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,t,r){this._rotation=r,this._rect={x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}},contains:function(e){var t=this,r=1,n=t._rect;return e=$(e,t.center(),-t._rotation),!(e.x<n.x-r||e.y<n.y-r||e.x>n.x+n.w+r*2||e.y>n.y+n.h+r*2)},intersects:function(e){var t=this._points(),r=e._points(),n=[re(t[0],t[1]),re(t[0],t[3])],a,i,s;for(this._rotation!==e._rotation&&n.push(re(r[0],r[1]),re(r[0],r[3])),a=0;a<n.length;++a)if(i=Te(t,n[a]),s=Te(r,n[a]),i.max<s.min||s.max<i.min)return!1;return!0},_points:function(){var e=this,t=e._rect,r=e._rotation,n=e.center();return[$({x:t.x,y:t.y},n,r),$({x:t.x+t.w,y:t.y},n,r),$({x:t.x+t.w,y:t.y+t.h},n,r),$({x:t.x,y:t.y+t.h},n,r)]}});function Qe(e,t,r){var n=t.positioner(e,t),a=n.vx,i=n.vy;if(!a&&!i)return{x:n.x,y:n.y};var s=r.w,o=r.h,l=t.rotation,d=Math.abs(s/2*Math.cos(l))+Math.abs(o/2*Math.sin(l)),f=Math.abs(s/2*Math.sin(l))+Math.abs(o/2*Math.cos(l)),u=1/Math.max(Math.abs(a),Math.abs(i));return d*=a*u,f*=i*u,d+=t.offset*a,f+=t.offset*i,{x:n.x+d,y:n.y+f}}function Br(e,t){var r,n,a,i;for(r=e.length-1;r>=0;--r)for(a=e[r].$layout,n=r-1;n>=0&&a._visible;--n)i=e[n].$layout,i._visible&&a._box.intersects(i._box)&&t(a,i);return e}function Hr(e){var t,r,n,a,i,s,o;for(t=0,r=e.length;t<r;++t)n=e[t],a=n.$layout,a._visible&&(o=new Proxy(n._el,{get:(l,d)=>l.getProps([d],!0)[d]}),i=n.geometry(),s=Qe(o,n.model(),i),a._box.update(s,i,n.rotation()));return Br(e,function(l,d){var f=l._hidable,u=d._hidable;f&&u||u?d._visible=!1:f&&(l._visible=!1)})}var z={prepare:function(e){var t=[],r,n,a,i,s;for(r=0,a=e.length;r<a;++r)for(n=0,i=e[r].length;n<i;++n)s=e[r][n],t.push(s),s.$layout={_box:new Ve,_hidable:!1,_visible:!0,_set:r,_idx:s._index};return t.sort(function(o,l){var d=o.$layout,f=l.$layout;return d._idx===f._idx?f._set-d._set:f._idx-d._idx}),this.update(t),t},update:function(e){var t=!1,r,n,a,i,s;for(r=0,n=e.length;r<n;++r)a=e[r],i=a.model(),s=a.$layout,s._hidable=i&&i.display==="auto",s._visible=a.visible(),t|=s._hidable;t&&Hr(e)},lookup:function(e,t){var r,n;for(r=e.length-1;r>=0;--r)if(n=e[r].$layout,n&&n._visible&&n._box.contains(t))return e[r];return null},draw:function(e,t){var r,n,a,i,s,o;for(r=0,n=t.length;r<n;++r)a=t[r],i=a.$layout,i._visible&&(s=a.geometry(),o=Qe(a._el,a.model(),s),i._box.update(o,s,a.rotation()),a.draw(e,o))}},zr=function(e){if(L(e))return null;var t=e,r,n,a;if(j(e))if(!L(e.label))t=e.label;else if(!L(e.r))t=e.r;else for(t="",r=Object.keys(e),a=0,n=r.length;a<n;++a)t+=(a!==0?", ":"")+r[a]+": "+e[r[a]];return""+t},Gr={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:zr,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},y="$datalabels",Je="$default";function Xr(e,t){var r=e.datalabels,n={},a=[],i,s;return r===!1?null:(r===!0&&(r={}),t=R({},[t,r]),i=t.labels||{},s=Object.keys(i),delete t.labels,s.length?s.forEach(function(o){i[o]&&a.push(R({},[t,i[o],{_key:o}]))}):a.push(t),n=a.reduce(function(o,l){return nr(l.listeners||{},function(d,f){o[f]=o[f]||{},o[f][l._key||Je]=d}),delete l.listeners,o},{}),{labels:a,listeners:n})}function be(e,t,r,n){if(t){var a=r.$context,i=r.$groups,s;t[i._set]&&(s=t[i._set][i._key],s&&He(s,[a,n])===!0&&(e[y]._dirty=!0,r.update(a)))}}function Kr(e,t,r,n,a){var i,s;!r&&!n||(r?n?r!==n&&(s=i=!0):s=!0:i=!0,s&&be(e,t.leave,r,a),i&&be(e,t.enter,n,a))}function Zr(e,t){var r=e[y],n=r._listeners,a,i;if(!(!n.enter&&!n.leave)){if(t.type==="mousemove")i=z.lookup(r._labels,t);else if(t.type!=="mouseout")return;a=r._hovered,r._hovered=i,Kr(e,n,a,i,t)}}function qr(e,t){var r=e[y],n=r._listeners.click,a=n&&z.lookup(r._labels,t);a&&be(e,n,a,t)}var Vr={id:"datalabels",defaults:Gr,beforeInit:function(e){e[y]={_actives:[]}},beforeUpdate:function(e){var t=e[y];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(e,t,r){var n=t.index,a=e[y],i=a._datasets[n]=[],s=e.isDatasetVisible(n),o=e.data.datasets[n],l=Xr(o,r),d=t.meta.data||[],f=e.ctx,u,m,C,h,v,M,O,_;for(f.save(),u=0,C=d.length;u<C;++u)if(O=d[u],O[y]=[],s&&O&&e.getDataVisibility(u)&&!O.skip)for(m=0,h=l.labels.length;m<h;++m)v=l.labels[m],M=v._key,_=new qe(v,f,O,u),_.$groups={_set:n,_key:M||Je},_.$context={active:!1,chart:e,dataIndex:u,dataset:o,datasetIndex:n},_.update(_.$context),O[y].push(_),i.push(_);f.restore(),R(a._listeners,l.listeners,{merger:function(W,E,ie){E[W]=E[W]||{},E[W][t.index]=ie[W],a._listened=!0}})},afterUpdate:function(e){e[y]._labels=z.prepare(e[y]._datasets)},afterDatasetsDraw:function(e){z.draw(e,e[y]._labels)},beforeEvent:function(e,t){if(e[y]._listened){var r=t.event;switch(r.type){case"mousemove":case"mouseout":Zr(e,r);break;case"click":qr(e,r);break}}},afterEvent:function(e){var t=e[y],r=t._actives,n=t._actives=e.getActiveElements(),a=H.arrayDiff(r,n),i,s,o,l,d,f,u;for(i=0,s=a.length;i<s;++i)if(d=a[i],d[1])for(u=d[0].element[y]||[],o=0,l=u.length;o<l;++o)f=u[o],f.$context.active=d[1]===1,f.update(f.$context);(t._dirty||a.length)&&(z.update(t._labels),e.render()),delete t._dirty}};const et="label";function Fe(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function Qr(e,t){const r=e.options;r&&t&&Object.assign(r,t)}function tt(e,t){e.labels=t}function rt(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:et;const n=[];e.datasets=t.map(a=>{const i=e.datasets.find(s=>s[r]===a[r]);return!i||!a.data||n.includes(i)?{...a}:(n.push(i),Object.assign(i,a),i)})}function Jr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:et;const r={labels:[],datasets:[]};return tt(r,e.labels),rt(r,e.datasets,t),r}function en(e,t){const{height:r=150,width:n=300,redraw:a=!1,datasetIdKey:i,type:s,data:o,options:l,plugins:d=[],fallbackContent:f,updateMode:u,...m}=e,C=ne(null),h=ne(),v=()=>{C.current&&(h.current=new me(C.current,{type:s,data:Jr(o,i),options:l&&{...l},plugins:d}),Fe(t,h.current))},M=()=>{Fe(t,null),h.current&&(h.current.destroy(),h.current=null)};return k(()=>{!a&&h.current&&l&&Qr(h.current,l)},[a,l]),k(()=>{!a&&h.current&&tt(h.current.config.data,o.labels)},[a,o.labels]),k(()=>{!a&&h.current&&o.datasets&&rt(h.current.config.data,o.datasets,i)},[a,o.datasets]),k(()=>{h.current&&(a?(M(),setTimeout(v)):h.current.update(u))},[a,l,o.labels,o.datasets,u]),k(()=>{h.current&&(M(),setTimeout(v))},[s]),k(()=>(v(),()=>M()),[]),ge.createElement("canvas",Object.assign({ref:C,role:"img",height:r,width:n},m),f)}const tn=We(en);function nt(e,t){return me.register(t),We((r,n)=>ge.createElement(tn,Object.assign({},r,{ref:n,type:e})))}const at=nt("line",Ne),rn=nt("bar",wt),nn=async e=>{const t="https://weather-broker-cdn.api.bbci.co.uk/en/forecast/aggregated/"+e.bbcID;return fetch(t).then(r=>r.json()).then(r=>{console.log("BBC full forecasts:",r.forecasts);const n={tzOffset:r.forecasts.at(0).detailed.issueDate.slice(19),hourly:{x:[],y_temperature:[],y_windGust:[],y_precipChance:[]},daily:{x:[],y_uvIndex:[],y_pollenIndex:[],y_pollutionIndex:[]}};return r.forecasts.forEach(a=>{a.detailed.reports.forEach(s=>{n.hourly.x.push(new Date(s.localDate+" "+s.timeslot)),n.hourly.y_temperature.push(s.temperatureC),n.hourly.y_windGust.push(s.gustSpeedKph>25?s.gustSpeedKph:null),n.hourly.y_precipChance.push(s.precipitationProbabilityInPercent)});const i=a.summary.report;n.daily.x.push(new Date(i.localDate)),n.daily.y_uvIndex.push(i.uvIndex),n.daily.y_pollenIndex.push(i.pollenIndex),n.daily.y_pollutionIndex.push(i.pollutionIndex)}),n})},_e="e1f10a1e78da46f5b10a1e78da96f525",an=async e=>{const t=`https://api.weather.com/v3/wx/forecast/hourly/15day?apiKey=${_e}&geocode=${e.coords[0]}%2C${e.coords[1]}&units=m&language=en-US&format=json`;return fetch(t,{referrerPolicy:"no-referrer",credentials:"omit"}).then(r=>r.json()).then(r=>{var a;return console.log("Forecast:",r),{tzOffset:(a=r.validTimeLocal.at(0))==null?void 0:a.slice(19),x:r.validTimeLocal.map(i=>new Date(i.slice(0,19))),y_precipitation:r.qpf,y_temperature:r.temperature,y_windGust:r.windGust,y_precipChance:r.precipChance,y_uvIndex:r.uvIndex.map(i=>i>0?i:null),y_cloudCover:r.cloudCover.map(i=>i>0?i:null)}})},sn=async e=>{const t=`https://api.weather.com/v3/wx/conditions/historical/hourly/1day?apiKey=${_e}&geocode=${e.coords[0]}%2C${e.coords[1]}&units=m&language=en-US&format=json`;return fetch(t,{referrerPolicy:"no-referrer",credentials:"omit"}).then(r=>r.json()).then(r=>{var a;return console.log("History:",r),{tzOffset:(a=r.validTimeLocal.at(0))==null?void 0:a.slice(19),x:r.validTimeLocal.map(i=>new Date(i.slice(0,19))),y_precipitation:[],y_temperature:r.temperature,y_windGust:r.windGust,y_precipChance:[],y_uvIndex:[],y_cloudCover:[]}})},on=async e=>{const t=`https://api.weather.com/v2/turbo/vt1pollenforecast?apiKey=${_e}&geocode=${e.coords[0]}%2C${e.coords[1]}&language=en&format=json`;return fetch(t,{}).then(r=>r.json()).then(r=>(console.log("Pollen:",r),{x:r.vt1pollenforecast.reportDate.map(a=>new Date(a.slice(0,19))),y_tree:r.vt1pollenforecast.tree,y_weed:r.vt1pollenforecast.weed,y_grass:r.vt1pollenforecast.grass}))},it=(e,t)=>{const r=e.ctx,n=r.canvas.parentElement,a=(t??"+0000").replace(":",""),i=parseInt(a.slice(0,3))*Ct+parseInt(a.slice(3))*Mt,s=new Date().toISOString().slice(0,19),o=new Date(s).getTime()+i,l=e.scales.x.getPixelForValue(o),d=0,f=e.chartArea.bottom+e.scales.x.height;r.save(),r.beginPath(),r.strokeStyle="#088",r.lineWidth=2,r.moveTo(l,f),r.lineTo(l,d),r.stroke(),r.restore(),n.scrollLeft===0&&n.scrollTo(e.scales.x.left,0)},g=(e,t,r)=>({axis:"y",type:"linear",grid:{display:!1},ticks:{stepSize:r,color:t,font:{size:20}},title:{display:!0,text:e,color:t,font:{size:20}},position:"left",beginAtZero:!0}),we=()=>({axis:"x",type:"time",time:{unit:"day",tooltipFormat:"ddd D MMM H:mm",displayFormats:{day:"ddd D MMM",hour:"H:mm"}},grid:{color:"#0006",lineWidth:t=>{var r,n;return(n=(r=t.tick)==null?void 0:r.label)!=null&&n.startsWith("Mon")?5:1}},ticks:{color:"#000",font:{size:20},align:"start"}}),ln=e=>{const t={pointRadius:0,pointHoverRadius:5,borderWidth:2,cubicInterpolationMode:"default",tension:0,fill:!1},r=[{...t,data:e.hourly.y_temperature,borderColor:"#d5202a",yAxisID:"y_temperature",order:1},{...t,data:e.hourly.y_windGust,borderColor:"#b9f",yAxisID:"y_windGust",order:3},{...t,data:e.hourly.y_precipChance,borderColor:"#15aadc",yAxisID:"y_precipChance",order:2}];return{labels:e.hourly.x,datasets:r}},cn=()=>({elements:{point:{radius:1}},plugins:{legend:{display:!1}},locale:"en-GB",responsive:!1,scales:{x:we(),y_temperature:{...g("Temperature C","#d5202a",5),beginAtZero:!1,grid:{color:"#d5202a20",lineWidth:e=>e.tick.value%10===0?5:2}},y_precipChance:{...g("Rain proba %","#15aadc",50),max:100},y_windGust:g("Wind Gust km/h","#b9f",25)}}),dn=(e,t)=>{const r={pointRadius:0,pointHoverRadius:5,borderWidth:2,cubicInterpolationMode:"default",tension:0},n=[{...r,data:e.daily.y_pollutionIndex,backgroundColor:x.Pollution,yAxisID:"y_pollutionIndex",order:1},{...r,data:e.daily.y_uvIndex,backgroundColor:x.UV,yAxisID:"y_uvIndex",order:2},{...r,data:e.daily.y_pollenIndex,backgroundColor:x.Pollen,yAxisID:"y_pollenIndex",order:3},{...r,data:t.y_tree,backgroundColor:x.Tree,yAxisID:"y_tree",order:4},{...r,data:t.y_grass,backgroundColor:x.Grass,yAxisID:"y_grass",order:5},{...r,data:t.y_weed,backgroundColor:x.Weed,yAxisID:"y_weed",order:6}];return{labels:e.daily.x,datasets:n}},fn=()=>{const e=we();return e.ticks.align="center",{elements:{point:{radius:1}},plugins:{legend:{display:!1}},locale:"en-GB",responsive:!1,scales:{x:e,y_pollutionIndex:{...g("Pollution index",x.Pollution,10),max:10},y_uvIndex:{...g("UV index",x.UV,10),max:10},y_pollenIndex:{...g("Pollen index",x.Pollen,10),max:10},y_tree:{...g("WU Tree index",x.Tree,10),max:10},y_grass:{...g("WU Grass index",x.Grass,10),max:10},y_weed:{...g("WU Weed index",x.Weed,10),max:10}}}},un=({place:e})=>{const[t,r]=P(),[n,a]=P(null),[i,s]=P(null),o=ne(null);if(k(()=>{(async function(){const W=[nn(e),on(e)],[E,ie]=await Promise.all(W);a(ln(E)),s(dn(E,ie)),r(E.tzOffset)})()},[e]),n===null||i===null)return c.jsx("p",{children:"Loading..."});const l=cn(),d=fn(),f=n.labels.at(0),u=i.labels.at(0),m=f<u?f:u,C=new Date(m).setHours(0,0,0,0);l.scales.x.min=C-It,d.scales.x.min=C;const h=n.labels.at(-1),v=i.labels.at(-1),M=h>v?h:v,O=new Date(M).setHours(0,0,0,0),_=new Date(M).setHours(23,0,0,0);return console.log(_),l.scales.x.max=_,d.scales.x.max=O,d.plugins={datalabels:{color:"#000",anchor:"end",align:"top",clamp:!0},legend:{labels:{filter:W=>!1}}},l.animation={onComplete:()=>o.current&&it(o.current,t)},c.jsxs(c.Fragment,{children:[c.jsx("p",{children:"BBC"}),c.jsx("div",{className:"x-chart",children:c.jsxs("div",{className:"x-scrollable-x","data-testid":"chart-bbc",children:[c.jsx(at,{ref:o,data:n,options:l,width:3e3,height:U?300:200}),c.jsx(rn,{plugins:[Vr],data:i,options:d,width:3e3,height:U?300:200})]})}),c.jsx("div",{className:"x-shadow",children:c.jsx("ul",{children:c.jsx(F,{href:"https://www.bbc.co.uk/weather/"+e.bbcID,children:"Weather"})})})]})},hn=()=>{const[e,t]=P(!0),r=new fe,n=r.isAurora(),a=n?null:r.getLocation(),i=o=>{t(o)},s=o=>{const l=new fe().searchParams;return l.set("location",o),l.delete("aurora"),"?"+l.toString()};return c.jsxs(K,{id:"x-navbar",expand:"sm",variant:"dark",onToggle:i,expanded:e,children:[c.jsx(K.Brand,{children:"Weather"}),c.jsx(K.Toggle,{"aria-controls":"basic-navbar-nav"}),c.jsx(K.Collapse,{id:"basic-navbar-nav",children:c.jsxs(je,{className:"ms-auto me-auto",children:[c.jsx(Ce,{title:a||"Weather locations",active:!n,children:ye.map((o,l)=>c.jsx(Ce.Item,{href:s(o.name),active:o.name===a,children:o.name},l))}),c.jsx(je.Link,{href:"?aurora=true",active:n,children:"Northern lights"})]})})]})},bn=(e,t)=>{const r=[],n={pointRadius:0,pointHoverRadius:5,borderWidth:2,cubicInterpolationMode:"default",tension:0},a=Array.from({length:t.x.length},(i,s)=>null);return r.push({...n,data:[...a,...e.y_precipitation],borderColor:"#0053ae",backgroundColor:"#0053ae30",yAxisID:"y_precipitation",fill:"origin",order:3}),r.push({...n,data:[...t.y_temperature.toReversed(),...e.y_temperature],borderColor:"#d5202a",yAxisID:"y_temperature",fill:!1,order:1}),r.push({...n,data:[...t.y_windGust.toReversed(),...e.y_windGust],borderColor:"#b9f",yAxisID:"y_windGust",fill:!1,order:6}),r.push({...n,data:[...a,...e.y_precipChance],borderColor:"#15aadc",yAxisID:"y_precipChance",fill:!1,order:2}),r.push({...n,data:[...a,...e.y_uvIndex],borderColor:"#fc0",yAxisID:"y_uvIndex",fill:!1,order:4}),r.push({...n,data:[...a,...e.y_cloudCover],yAxisID:"y_cloudCover",borderColor:"#aaa",order:5}),{labels:[...t.x.toReversed(),...e.x],datasets:r}},Re={elements:{point:{radius:1}},plugins:{legend:{display:!1}},locale:"en-GB",responsive:!1,scales:{x:we(),y_temperature:{...g("Temperature C","#d5202a",5),grid:{color:"#d5202a20",lineWidth:e=>e.tick.value%10===0?5:2},beginAtZero:!1},y_precipitation:{...g("Rain mm/h","#0053ae",1),grid:{color:"#0053ae40",lineWidth:4},suggestedMax:1},y_precipChance:{...g("Rain proba %","#15aadc",50),max:100},y_uvIndex:{...g("UV index","#fc0",10),max:10},y_windGust:g("Wind Gust km/h","#b9f",25),y_cloudCover:{...g("Cloud Cover %","#aaa",50),max:100}}},gn=({place:e})=>{const[t,r]=P(),[n,a]=P(null),i=ne(null);return k(()=>{(async function(){const s=[an(e),sn(e)],[o,l]=await Promise.all(s);a(bn(o,l)),r(o.tzOffset)})()},[e]),n===null?c.jsx("p",{children:"Loading..."}):(Re.animation={onComplete:()=>i.current&&it(i.current,t)},c.jsxs(c.Fragment,{children:[c.jsx("p",{children:"Weather Underground"}),c.jsx("div",{className:"x-chart",children:c.jsx("div",{className:"x-scrollable-x","data-testid":"chart-wu",children:c.jsx(at,{ref:i,data:n,options:Re,width:3e3,height:U?300:200})})}),c.jsx("div",{className:"x-shadow",children:c.jsxs("ul",{children:[c.jsx(F,{href:"https://www.wunderground.com/forecast/"+e.linkWU,children:"Weather"}),c.jsx(F,{href:`https://www.wunderground.com/health/${e.linkWU}?cm_ven=localwx_modpollen`,children:"Pollen/AQ"})]})})]}))};Ot();const mn=()=>{const e=new fe;if(e.isAurora())return de(c.jsx(At,{}));{const r=e.getLocation(),n=ye.filter(a=>a.name===r).pop();return de(n?c.jsxs(c.Fragment,{children:[c.jsx(gn,{place:n}),c.jsx("hr",{}),c.jsx(un,{place:n}),c.jsx("hr",{}),c.jsx(yn,{}),c.jsx("hr",{}),c.jsx(pn,{place:n})]}):c.jsx("p",{children:"Invalid Location"}))}},de=e=>c.jsxs(c.Fragment,{children:[c.jsx(hn,{}),c.jsx("main",{children:e})]}),yn=()=>{const e=new Date().toISOString().substring(0,10);return c.jsxs(c.Fragment,{children:[c.jsx("p",{children:"MET Office"}),c.jsx("div",{className:"x-shadow",children:c.jsxs("ul",{children:[c.jsx(F,{href:"https://www.metoffice.gov.uk/weather/maps-and-charts/rainfall-radar-forecast-map#?model=ukmo-ukv&layer=rainfall-rate",children:"Rain Map UK"}),c.jsx(F,{href:`https://www.metoffice.gov.uk/weather/warnings-and-advice/seasonal-advice/pollen-forecast#?date=${e}&region=em`,children:"East Midlands"})]})})]})},pn=({place:e})=>{const t=e.coords.map(r=>r.toFixed(4));return c.jsxs(c.Fragment,{children:[c.jsx("p",{children:"Misc"}),c.jsx("div",{className:"x-shadow",children:c.jsx("ul",{children:c.jsx(F,{href:`https://www.lightningmaps.org/?lang=en#m=oss;t=3;s=0;o=0;b=0.00;ts=0;y=${t[0]};x=${t[1]};z=13;d=2;dl=2;dc=0;`,children:"⛈ Lightnings"})})})]})};lt.createRoot(document.getElementById("root")).render(c.jsx(ge.StrictMode,{children:c.jsx(ct,{children:c.jsx(mn,{})})}));
