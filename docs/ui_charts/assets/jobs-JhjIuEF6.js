var U=Object.defineProperty;var W=(e,a,s)=>a in e?U(e,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[a]=s;var E=(e,a,s)=>W(e,typeof a!="symbol"?a+"":a,s);import{j as t,c as z}from"./client-B8KsQLkO.js";import{C as Y}from"./CookieConsentWrapper-CRJKL-6e.js";import*as N from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import V,{useState as w,useRef as q,useEffect as X}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import{i as J}from"./all-BSES4dDh.js";import L from"https://cdn.jsdelivr.net/npm/html-react-parser@5.1.15/+esm";import{u as I,c as b}from"./Button-20q6oNEn.js";import{d as K,A as Q,u as Z,a as ee,C as te,F as O,D as se}from"./Dropdown-BFpiP_Qs.js";import{C,B as D,D as ae,F as A}from"./Form-C0sMV8xW.js";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"./_commonjsHelpers-Cpj98o6Y.js";import"./ElementChildren-AZvnq_HE.js";const oe=1e3,R=6e4,v=36e5,P=864e5,y=(e,a=!1)=>{const s=Math.floor(e/P);e-=s*P;const o=Math.floor(e/v);e-=o*v;const n=Math.floor(e/R);e-=n*R;const r=Math.floor(e/oe);if(s>0)return`${s.toFixed(1)} days`;{let i="";return o>0&&(i+=`${o}h`),i+=`${String(n).padStart(2,"0")}m`,a&&(i+=`${String(r).padStart(2,"0")}s`),i}},B=K("h4");B.displayName="DivStyledAsH4";const F=N.forwardRef(({className:e,bsPrefix:a,as:s=B,...o},n)=>(a=I(a,"alert-heading"),t.jsx(s,{ref:n,className:b(e,a),...o})));F.displayName="AlertHeading";const G=N.forwardRef(({className:e,bsPrefix:a,as:s=Q,...o},n)=>(a=I(a,"alert-link"),t.jsx(s,{ref:n,className:b(e,a),...o})));G.displayName="AlertLink";const $=N.forwardRef((e,a)=>{const{bsPrefix:s,show:o=!0,closeLabel:n="Close alert",closeVariant:r,className:i,children:m,variant:c="primary",onClose:u,dismissible:h,transition:_=O,...f}=Z(e,{show:"onClose"}),j=I(s,"alert"),d=ee(S=>{u&&u(!1,S)}),l=_===!0?O:_,p=t.jsxs("div",{role:"alert",...l?void 0:f,ref:a,className:b(i,j,c&&`${j}-${c}`,h&&`${j}-dismissible`),children:[h&&t.jsx(te,{onClick:d,"aria-label":n,variant:r}),m]});return l?t.jsx(l,{unmountOnExit:!0,...f,ref:void 0,in:o,children:p}):o?p:null});$.displayName="Alert";const ne=Object.assign($,{Link:G,Heading:F}),x={ICONS:"#0f766e",BG_CARD:"white",BG_CARD_APPLIED:"#dcfce7",BG_LONG_DESCRIPTION:"#f0fdfa",BG_LONG_DESCRIPTION_BUTTON:"#0f766e",NOTES:"#312e81",DATE_INITAL:"#15803d",DATE_UPDATED:"#854d0e"},g=({className:e,style:a,...s})=>t.jsx("i",{className:e,style:{color:x.ICONS,marginLeft:".5rem",marginRight:".2rem",...a},...s}),T=864e5,re=({initialDate:e,repostedDate:a,appliedTs:s})=>{const o={weekday:"short",day:"2-digit",month:"short",year:"numeric"},n={...o,hour:"2-digit",minute:"2-digit"},r=new Date().getTime()-new Date(e).getTime(),i=r/T,m=y(r);let c=i>3?o:n;const u=new Date(e).toLocaleDateString("en-GB",c),h=new Date().getTime()-new Date(a).getTime(),_=y(h),f=h/T;c=f>3?o:n;const j=new Date(a).toLocaleDateString("en-GB",c);let d;if(s){const p=new Date().getTime()-s*1e3,S=y(p);c=p/T>3?o:n;const H=new Date(a).toLocaleDateString("en-GB",c);d=t.jsxs(t.Fragment,{children:[t.jsx(g,{className:"fa-solid fa-calendar-days"})," App ",t.jsx("b",{children:S})," ago (on"," ",H,")"]})}const l=i-f<1?t.jsxs(t.Fragment,{children:[t.jsx(g,{className:"fa-solid fa-calendar-days"})," Created"," ",t.jsx("b",{style:{color:x.DATE_INITAL},children:_})," ago (on ",j,")"]}):t.jsxs(t.Fragment,{children:[t.jsx(g,{className:"fa-solid fa-calendar-days"})," Created"," ",t.jsx("b",{style:{color:x.DATE_INITAL},children:m})," ago (on ",u,")."," ",t.jsx(g,{className:"fa-solid fa-calendar-days"})," Reposted"," ",t.jsx("b",{style:{color:x.DATE_UPDATED},children:_})," ago (on ",j,")"]});return t.jsxs("p",{children:[l,d]})},ie=({longDescription:e})=>{const a="4rem",s="hidden",[o,n]=w(!1),r=q(null);let i;return o?(i="fa-solid fa-minimize",r.current&&(r.current.style.removeProperty("max-height"),r.current.style.removeProperty("overflow-y"))):(i="fa-solid fa-maximize",r.current&&(r.current.style.maxHeight=a,r.current.style.overflowY=s)),t.jsxs("div",{style:{backgroundColor:x.BG_LONG_DESCRIPTION,padding:"0.3rem 1rem"},children:[t.jsx(g,{className:i,onClick:()=>n(!o),style:{fontSize:"1.4rem"}}),t.jsx("div",{ref:r,style:{overflowY:s,maxHeight:a},children:e})]})},le=({item:e,index:a})=>{const s=e.applied_timestamp?x.BG_CARD_APPLIED:x.BG_CARD,o=L(e.short_description_html),n=L(e.long_description_html),r=new Date(e.updated_on),i=y(new Date().getTime()-r.getTime()),m=new Date(e.created_on),c=y(new Date().getTime()-m.getTime());return t.jsx(C,{className:"x-shadow",style:{width:J?"90vw":"100vw"},children:t.jsxs(C.Body,{style:{background:s,borderRadius:"1rem"},children:[e.notes&&t.jsx(ne,{variant:"warning",dismissible:!0,style:{padding:0,margin:"0.4rem auto",maxWidth:"80vw"},children:t.jsx("ul",{style:{margin:0},children:e.notes.map((u,h)=>t.jsx("li",{children:u},h))})}),t.jsxs(C.Title,{children:[a," ",t.jsx("a",{href:"https://www.cwjobs.co.uk"+e.url,target:"_blank",children:e.job_title})]}),t.jsxs("p",{children:[e.company_logo_url&&t.jsx("img",{src:e.company_logo_url,loading:"lazy",referrerPolicy:"no-referrer",alt:e.company_name,title:e.company_name,style:{maxHeight:"2rem",maxWidth:"60rem",marginRight:"1rem"}}),e.company_name]}),t.jsx(re,{initialDate:e.date_created,repostedDate:e.date_posted,appliedTs:e.applied_timestamp}),t.jsxs("p",{children:[t.jsx(g,{className:"fa-solid fa-money-bill-wave"})," ",e.salary,e.work_type&&e.work_type!=="Contract"&&t.jsx(ce,{workType:e.work_type})]}),t.jsxs("p",{children:[t.jsx(g,{className:"fa-solid fa-location-dot"})," ",e.location,e.post_code&&`, ${e.post_code}`,e.work_from_home&&`, WFH: ${e.work_from_home}`]}),t.jsxs("p",{children:[t.jsx(g,{className:"fa-solid fa-circle-info"})," ",o]}),t.jsx(ie,{longDescription:n}),t.jsxs("p",{style:{fontSize:"0.7rem"},children:[e.id," was"," ",t.jsx("span",{style:{color:e.online_status==="online"?"green":"red"},children:e.online_status})," ","when refreshed ",t.jsx("b",{children:i})," ago. First seen ",t.jsx("b",{children:c})," ago."]})]})})},ce=({workType:e})=>t.jsxs(t.Fragment,{children:[t.jsx(g,{className:"fa-solid fa-file-contract"}),e]}),M=({selectedPage:e,setSelectedPage:a,numPages:s})=>{const o=Array.from({length:s},(i,m)=>1+m),n=new URL(window.location.href),r=i=>{a(i),n.searchParams.set("page",i.toString()),history.pushState({},"",n)};return t.jsxs(D,{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",marginTop:"1rem"},children:[t.jsx(D.First,{disabled:e===1,onClick:()=>r(1)}),t.jsx(D.Prev,{disabled:e===1,onClick:()=>r(e-1)}),o.map(i=>t.jsx(D.Item,{active:e===i,onClick:()=>r(i),children:i},i)),t.jsx(D.Next,{disabled:e===s,onClick:()=>r(e+1)}),t.jsx(D.Last,{disabled:e===s,onClick:()=>r(s)})]})},de=({limitPerPage:e,setLimitPerPage:a,setSelectedPage:s})=>{const o=[10,25,50,1e3];return t.jsx(ae,{title:`${e} per page`,children:o.map((n,r)=>t.jsx(se.Item,{active:n===e,onClick:()=>{a(n),s(1)},children:n},r))})},pe=({sortedByRepost:e,setSortedByRepost:a})=>t.jsx(A,{style:{display:"flex",justifyContent:"center",flexWrap:"wrap"},children:t.jsx(A.Check,{type:"switch",label:e?"sorted by repost":"sorted by initial creation",checked:e,onChange:()=>a(!e)})}),me=({onlyApplied:e,setOnlyApplied:a,setSelectedPage:s})=>t.jsx(A,{style:{display:"flex",justifyContent:"center",flexWrap:"wrap"},children:t.jsx(A.Check,{type:"switch",label:e?"only App":"all (App or not)",checked:e,onChange:()=>{a(!e),s(1)}})}),he=({updatedDateIso:e,nextIterationDateIso:a,numItems:s})=>{const o=new Date(e),n=y(new Date().getTime()-o.getTime()),r=o.toLocaleDateString("en-GB",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),m=new Date(a).getTime()-new Date().getTime(),c=y(m);return t.jsxs("p",{children:["Updated ",t.jsx("b",{style:{color:x.DATE_INITAL},children:n})," ago (on ",r,")",t.jsx("br",{}),"Next update in ",t.jsx("b",{style:{color:x.DATE_UPDATED},children:c}),t.jsx("br",{}),t.jsx("b",{children:s})," items from"," ",t.jsx("a",{href:"https://www.cwjobs.co.uk/jobs/contract/python-or-c%23-or-perl-or-sdet-or-test-or-qa-or-automation-or-dsp-or-raspberry?sort=2&action=facet_selected%3bage%3b1&postedWithin=1",children:"search"})]})},fe=()=>{const[e,a]=w(null),[s,o]=w(null),[n,r]=w(!1),[i,m]=w(!1),[c,u]=w(25);X(()=>{(async()=>{try{const l="https://webapp1-90494.web.app/data/report_all.json";console.log(`Fetch data from server: ${l}`);const p=await fetch(l,{mode:"cors"});if(!p.ok){const k=p.status===404?"404: This link seems wrong, check you have the correct one":`Failed to get data: response status=${p.status} body=${p.body}`;throw new Error(k)}const S=await p.json();o(S)}catch(l){const p={__error:`Exception: ${l}`};o(p)}})(),a(parseInt(new ge().getPage()))},[]);const h=d=>"__error"in d;if(s===null||e===null)return t.jsx("main",{children:"loading..."});if(h(s))return t.jsx("main",{style:{color:"red"},children:s.__error});const _=n?s.items.filter(d=>"applied_timestamp"in d):s.items,f=_.length;s.pagination.limit_per_page=c,s.pagination.total_pages=Math.ceil(f/s.pagination.limit_per_page),s.pagination.offset=(e-1)*s.pagination.limit_per_page;const j=_.sort(i?(d,l)=>l.date_posted.localeCompare(d.date_posted):(d,l)=>l.date_created.localeCompare(d.date_created)).slice(s.pagination.offset,Math.min(s.pagination.offset+s.pagination.limit_per_page,f));return t.jsxs("main",{children:[t.jsx(he,{updatedDateIso:s.updated_on,nextIterationDateIso:s.date_next_iteration,numItems:f}),t.jsx(me,{onlyApplied:n,setOnlyApplied:r,setSelectedPage:a}),t.jsx(pe,{sortedByRepost:i,setSortedByRepost:m}),t.jsx(de,{limitPerPage:c,setLimitPerPage:u,setSelectedPage:a}),t.jsx(M,{selectedPage:e,setSelectedPage:a,numPages:s.pagination.total_pages}),j.map((d,l)=>t.jsx(le,{index:s.pagination.offset+1+l,item:d},l)),t.jsx(M,{selectedPage:e,setSelectedPage:a,numPages:s.pagination.total_pages})]})};class ge{constructor(){E(this,"searchParams");this.searchParams=new URLSearchParams(window.location.search)}getPage(){return this.searchParams.get("page")??"1"}}z.createRoot(document.getElementById("root")).render(t.jsx(V.StrictMode,{children:t.jsx(Y,{children:t.jsx(fe,{})})}));
