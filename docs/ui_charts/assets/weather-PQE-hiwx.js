var st=Object.defineProperty;var lt=(e,t,r)=>t in e?st(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ke=(e,t,r)=>lt(e,typeof t!="symbol"?t+"":t,r);import{j as c,c as ct}from"./client-B8KsQLkO.js";import{i as G,C as dt}from"./CookieConsentWrapper-BX3Mx7Xo.js";import ge,{useState as P,useEffect as k,forwardRef as We,useRef as ne}from"https://cdn.jsdelivr.net/npm/react@18.3.1/+esm";import{_adapters as ft,Chart as ye,CategoryScale as ut,LinearScale as ht,PointElement as Ee,LineElement as bt,BarElement as Le,Title as gt,Tooltip as yt,Legend as mt,Filler as pt,TimeScale as xt,TimeSeriesScale as vt,LineController as Ne,defaults as _t,ArcElement as wt,BarController as kt}from"https://cdn.jsdelivr.net/npm/chart.js@4.4.4/+esm";import w from"https://cdn.jsdelivr.net/npm/moment@2.30.1/+esm";import{I as Ue,L,A as $e}from"./LinkItem-KKG5ywFW.js";import{H as Ct,M as jt,D as Mt}from"./dates-CXaDObX2.js";import{N as K,a as Ce,b as je}from"./NavDropdown-B6vjD2zC.js";import"https://cdn.jsdelivr.net/npm/react-dom@18.3.1/+esm";import"https://cdn.jsdelivr.net/npm/vanilla-cookieconsent@3.0.1/+esm";import"./Button-Dbum-Du3.js";import"./CloseButton-CUYUvxPi.js";import"./Dropdown-BtRWb2wP.js";const It={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};ft._date.override(typeof w=="function"?{_id:"moment",formats:function(){return It},parse:function(e,t){return typeof e=="string"&&typeof t=="string"?e=w(e,t):e instanceof w||(e=w(e)),e.isValid()?e.valueOf():null},format:function(e,t){return w(e).format(t)},add:function(e,t,r){return w(e).add(t,r).valueOf()},diff:function(e,t,r){return w(e).diff(w(t),r)},startOf:function(e,t,r){return e=w(e),t==="isoWeek"?(r=Math.trunc(Math.min(Math.max(0,r),6)),e.isoWeekday(r).startOf("day").valueOf()):e.startOf(t).valueOf()},endOf:function(e,t){return w(e).endOf(t).valueOf()}}:{});const St=()=>{ye.register(ut,ht,Ee,bt,Le,gt,yt,mt,pt,xt,vt,Ne)},me=[{name:"Chesterfield",coords:[53.248,-1.471],linkWU:"gb/chesterfield/ICHEST186",bbcID:"2653225"},{name:"Hitchin",coords:[51.958,-.283],linkWU:"gb/hitchin/IHITCH24",bbcID:"2646826"},{name:"Milan, ITA",coords:[45.464,9.189],linkWU:"it/milan",bbcID:"3173435"},{name:"Maribor, SLO",coords:[46.609,15.68],linkWU:"si/pesnica/IPESNI3",bbcID:"3195506"},{name:"London",coords:[51.512,-.123],linkWU:"gb/london/ILONDO533",bbcID:"6296599"},{name:"Peak District - Hope",coords:[53.287,-1.715],linkWU:"gb/hope/IHOPE37",bbcID:"2646640"},{name:"Lake District - Ambleside",coords:[54.428,-2.959],linkWU:"gb/ambleside/IAMBLE18",bbcID:"2657360"},{name:"Wales - Holiday Park",coords:[53.148,-4.194],linkWU:"gb/caernarfon/ICAERN3",bbcID:"2643958"},{name:"Fort William, SCOT",coords:[56.818,-5.104],linkWU:"gb/fort-william",bbcID:"2649169"},{name:"Los Angeles, USA",coords:[34.054,-118.242],linkWU:"us/ca/los-angeles",bbcID:"5368361"},{name:"Oxford",coords:[51.722,-1.222],linkWU:"gb/oxford/IOXFOR119",bbcID:"2640729"},{name:"Paris, FRA",coords:[48.871,2.357],linkWU:"fr/paris/IPARIS18258",bbcID:"2988507"},{name:"Cabourg, FRA",coords:[49.291,-.116],linkWU:"fr/cabourg/ICABOU1",bbcID:"3029297"}];class fe{constructor(){ke(this,"searchParams");this.searchParams=new URLSearchParams(window.location.search)}getLocation(){const t=this.searchParams.get("location")??localStorage.getItem("weather_location")??me[0].name;return localStorage.setItem("weather_location",t),t}isAurora(){return this.searchParams.get("aurora")==="true"}}const x={Pollution:"#555",UV:"#fc0",Pollen:"#155e75",Tree:"#a16207",Grass:"#84cc16",Weed:"#16a34a"},Ot=()=>{const[e,t]=P(new Date);k(()=>{const a=()=>{if(document.visibilityState==="visible"){const i=new Date;console.log("Update time 'now': ",i),t(i)}};return document.addEventListener("visibilitychange",a),()=>{document.removeEventListener("visibilitychange",a)}},[]);const r=e.toLocaleDateString("en-GB",{hour:"2-digit",minute:"2-digit",weekday:"short",day:"numeric",month:"short",year:"numeric",timeZoneName:"short"}),n=e.toISOString().substring(11,16);return c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:[r," = ",n," UTC"]}),c.jsx(At,{name:"1-hour forecast (NOAA)",link:"https://services.swpc.noaa.gov/images/animations/ovation/north/latest.jpg"}),c.jsx(Pt,{}),c.jsx(Z,{name:"1-day A index (Lancaster University)",link:"https://aurorawatch.lancs.ac.uk/summary/alerting-site-rolling-activity.png"}),c.jsx(Z,{name:"8-day K index (British Geological Survey)",link:"https://geomag.bgs.ac.uk/images/kandkp_bar.jpg"}),c.jsx(Z,{name:"7-day K index (NOAA)",link:"https://services.swpc.noaa.gov/images/station-k-index.png"}),c.jsx(Z,{name:"30-day A index (NOAA)",link:"https://services.swpc.noaa.gov/images/station-a-index.png"}),c.jsx(Dt,{})]})},Z=({name:e,link:t,...r})=>("style"in r||(r.style={}),r.style.width=G?"30vw":"100vw",c.jsxs("div",{className:"x-section",children:[e,":",c.jsx("br",{}),c.jsx(Ue,{src:t,alt:e,...r})]})),At=({name:e,link:t})=>{const r=G?"30vw":"100vw";return c.jsxs("div",{className:"x-section",children:[e,":",c.jsx("br",{}),c.jsxs("div",{style:{position:"relative",width:r,height:r,marginLeft:"auto",marginRight:"auto"},children:[c.jsx(Ue,{src:t,alt:e,style:{position:"absolute",width:r,height:r,top:0,left:0,transform:"rotate(90deg)"}}),c.jsx("div",{style:{position:"absolute",top:"77%",left:"60%",color:"#F00",fontWeight:"bold",fontSize:"1rem"},children:"X"})]})]})},Dt=()=>c.jsxs("div",{className:"x-shadow",style:{width:"fit-content"},children:["Other links:",c.jsxs("ul",{children:[c.jsx(L,{href:"https://www.spaceweatherlive.com/en/auroral-activity/aurora-forecast.html",children:"3-Day + 27-Day Forecast (Spaceweatherlive)"}),c.jsx(L,{href:"https://www.gi.alaska.edu/monitors/aurora-forecast#forecast-level-formatting",children:"27-Day Forecast"})]})]}),Pt=()=>{const[e,t]=P();return k(()=>{(async function(){var o;const r=await fetch("https://services.swpc.noaa.gov/text/3-day-forecast.txt");console.log(r.status);const n=await r.text(),a=/breakdown.*?\n+(.*?)\n+Rationale/ms.exec(n),i=(o=a==null?void 0:a.at(1))==null?void 0:o.split(`
`);console.log(i),t(i)})()},[]),c.jsxs("div",{className:"x-section",children:[c.jsx($e,{href:"https://services.swpc.noaa.gov/text/3-day-forecast.txt",children:"3-day forecast (NOAA)"}),":",c.jsx("br",{}),e?e.map((r,n)=>c.jsx("pre",{children:r},n)):"No result"]})};function z(e){return e+.5|0}const D=(e,t,r)=>Math.max(Math.min(e,r),t);function $(e){return D(z(e*2.55),0,255)}function T(e){return D(z(e*255),0,255)}function I(e){return D(z(e/2.55)/100,0,1)}function Me(e){return D(z(e*100),0,100)}const p={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},ue=[..."0123456789ABCDEF"],Tt=e=>ue[e&15],Rt=e=>ue[(e&240)>>4]+ue[e&15],q=e=>(e&240)>>4===(e&15),Ft=e=>q(e.r)&&q(e.g)&&q(e.b)&&q(e.a);function Wt(e){var t=e.length,r;return e[0]==="#"&&(t===4||t===5?r={r:255&p[e[1]]*17,g:255&p[e[2]]*17,b:255&p[e[3]]*17,a:t===5?p[e[4]]*17:255}:(t===7||t===9)&&(r={r:p[e[1]]<<4|p[e[2]],g:p[e[3]]<<4|p[e[4]],b:p[e[5]]<<4|p[e[6]],a:t===9?p[e[7]]<<4|p[e[8]]:255})),r}const Et=(e,t)=>e<255?t(e):"";function Lt(e){var t=Ft(e)?Tt:Rt;return e?"#"+t(e.r)+t(e.g)+t(e.b)+Et(e.a,t):void 0}const Nt=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Ye(e,t,r){const n=t*Math.min(r,1-r),a=(i,o=(i+e/30)%12)=>r-n*Math.max(Math.min(o-3,9-o,1),-1);return[a(0),a(8),a(4)]}function Ut(e,t,r){const n=(a,i=(a+e/60)%6)=>r-r*t*Math.max(Math.min(i,4-i,1),0);return[n(5),n(3),n(1)]}function $t(e,t,r){const n=Ye(e,1,.5);let a;for(t+r>1&&(a=1/(t+r),t*=a,r*=a),a=0;a<3;a++)n[a]*=1-t-r,n[a]+=t;return n}function Yt(e,t,r,n,a){return e===a?(t-r)/n+(t<r?6:0):t===a?(r-e)/n+2:(e-t)/n+4}function pe(e){const r=e.r/255,n=e.g/255,a=e.b/255,i=Math.max(r,n,a),o=Math.min(r,n,a),s=(i+o)/2;let l,d,f;return i!==o&&(f=i-o,d=s>.5?f/(2-i-o):f/(i+o),l=Yt(r,n,a,f,i),l=l*60+.5),[l|0,d||0,s]}function xe(e,t,r,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,r,n)).map(T)}function ve(e,t,r){return xe(Ye,e,t,r)}function Bt(e,t,r){return xe($t,e,t,r)}function Ht(e,t,r){return xe(Ut,e,t,r)}function Be(e){return(e%360+360)%360}function Gt(e){const t=Nt.exec(e);let r=255,n;if(!t)return;t[5]!==n&&(r=t[6]?$(+t[5]):T(+t[5]));const a=Be(+t[2]),i=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?n=Bt(a,i,o):t[1]==="hsv"?n=Ht(a,i,o):n=ve(a,i,o),{r:n[0],g:n[1],b:n[2],a:r}}function zt(e,t){var r=pe(e);r[0]=Be(r[0]+t),r=ve(r),e.r=r[0],e.g=r[1],e.b=r[2]}function Xt(e){if(!e)return;const t=pe(e),r=t[0],n=Me(t[1]),a=Me(t[2]);return e.a<255?`hsla(${r}, ${n}%, ${a}%, ${I(e.a)})`:`hsl(${r}, ${n}%, ${a}%)`}const Ie={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Se={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Kt(){const e={},t=Object.keys(Se),r=Object.keys(Ie);let n,a,i,o,s;for(n=0;n<t.length;n++){for(o=s=t[n],a=0;a<r.length;a++)i=r[a],s=s.replace(i,Ie[i]);i=parseInt(Se[o],16),e[s]=[i>>16&255,i>>8&255,i&255]}return e}let V;function Zt(e){V||(V=Kt(),V.transparent=[0,0,0,0]);const t=V[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const qt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Vt(e){const t=qt.exec(e);let r=255,n,a,i;if(t){if(t[7]!==n){const o=+t[7];r=t[8]?$(o):D(o*255,0,255)}return n=+t[1],a=+t[3],i=+t[5],n=255&(t[2]?$(n):D(n,0,255)),a=255&(t[4]?$(a):D(a,0,255)),i=255&(t[6]?$(i):D(i,0,255)),{r:n,g:a,b:i,a:r}}}function Qt(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${I(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const oe=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,N=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Jt(e,t,r){const n=N(I(e.r)),a=N(I(e.g)),i=N(I(e.b));return{r:T(oe(n+r*(N(I(t.r))-n))),g:T(oe(a+r*(N(I(t.g))-a))),b:T(oe(i+r*(N(I(t.b))-i))),a:e.a+r*(t.a-e.a)}}function Q(e,t,r){if(e){let n=pe(e);n[t]=Math.max(0,Math.min(n[t]+n[t]*r,t===0?360:1)),n=ve(n),e.r=n[0],e.g=n[1],e.b=n[2]}}function He(e,t){return e&&Object.assign(t||{},e)}function Oe(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=T(e[3]))):(t=He(e,{r:0,g:0,b:0,a:1}),t.a=T(t.a)),t}function er(e){return e.charAt(0)==="r"?Vt(e):Gt(e)}class ae{constructor(t){if(t instanceof ae)return t;const r=typeof t;let n;r==="object"?n=Oe(t):r==="string"&&(n=Wt(t)||Zt(t)||er(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=He(this._rgb);return t&&(t.a=I(t.a)),t}set rgb(t){this._rgb=Oe(t)}rgbString(){return this._valid?Qt(this._rgb):void 0}hexString(){return this._valid?Lt(this._rgb):void 0}hslString(){return this._valid?Xt(this._rgb):void 0}mix(t,r){if(t){const n=this.rgb,a=t.rgb;let i;const o=r===i?.5:r,s=2*o-1,l=n.a-a.a,d=((s*l===-1?s:(s+l)/(1+s*l))+1)/2;i=1-d,n.r=255&d*n.r+i*a.r+.5,n.g=255&d*n.g+i*a.g+.5,n.b=255&d*n.b+i*a.b+.5,n.a=o*n.a+(1-o)*a.a,this.rgb=n}return this}interpolate(t,r){return t&&(this._rgb=Jt(this._rgb,t._rgb,r)),this}clone(){return new ae(this.rgb)}alpha(t){return this._rgb.a=T(t),this}clearer(t){const r=this._rgb;return r.a*=1-t,this}greyscale(){const t=this._rgb,r=z(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=r,this}opaquer(t){const r=this._rgb;return r.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Q(this._rgb,2,t),this}darken(t){return Q(this._rgb,2,-t),this}saturate(t){return Q(this._rgb,1,t),this}desaturate(t){return Q(this._rgb,1,-t),this}rotate(t){return zt(this._rgb,t),this}}function E(e){return e===null||typeof e>"u"}function X(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function C(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function A(e,t){return typeof e>"u"?t:e}function Ge(e,t,r){if(e&&typeof e.call=="function")return e.apply(r,t)}function tr(e,t,r,n){let a,i,o;if(X(e))for(i=e.length,a=0;a<i;a++)t.call(r,e[a],a);else if(C(e))for(o=Object.keys(e),i=o.length,a=0;a<i;a++)t.call(r,e[o[a]],o[a])}function he(e){if(X(e))return e.map(he);if(C(e)){const t=Object.create(null),r=Object.keys(e),n=r.length;let a=0;for(;a<n;++a)t[r[a]]=he(e[r[a]]);return t}return e}function rr(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function nr(e,t,r,n){if(!rr(e))return;const a=t[e],i=r[e];C(a)&&C(i)?R(a,i,n):t[e]=he(i)}function R(e,t,r){const n=X(t)?t:[t],a=n.length;if(!C(e))return e;r=r||{};const i=r.merger||nr;let o;for(let s=0;s<a;++s){if(o=n[s],!C(o))continue;const l=Object.keys(o);for(let d=0,f=l.length;d<f;++d)i(l[d],e,o,r)}return e}const Ae=Math.log10;function ar(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function se(e){return ar(e)?e:new ae(e).saturate(.5).darken(.1).hexString()}const ir=["x","y","borderWidth","radius","tension"],or=["color","borderColor","backgroundColor"];function sr(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:or},numbers:{type:"number",properties:ir}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function lr(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const De=new Map;function cr(e,t){t=t||{};const r=e+JSON.stringify(t);let n=De.get(r);return n||(n=new Intl.NumberFormat(e,t),De.set(r,n)),n}function dr(e,t,r){return cr(t,r).format(e)}const ze={values(e){return X(e)?e:""+e},numeric(e,t,r){if(e===0)return"0";const n=this.chart.options.locale;let a,i=e;if(r.length>1){const d=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(d<1e-4||d>1e15)&&(a="scientific"),i=fr(e,r)}const o=Ae(Math.abs(i)),s=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:a,minimumFractionDigits:s,maximumFractionDigits:s};return Object.assign(l,this.options.ticks.format),dr(e,n,l)},logarithmic(e,t,r){if(e===0)return"0";const n=r[t].significand||e/Math.pow(10,Math.floor(Ae(e)));return[1,2,3,5,10,15].includes(n)||t>.8*r.length?ze.numeric.call(this,e,t,r):""}};function fr(e,t){let r=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(r)>=1&&e!==Math.floor(e)&&(r=e-Math.floor(e)),r}var ur={formatters:ze};function hr(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,r)=>r.lineWidth,tickColor:(t,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ur.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const br=Object.create(null),gr=Object.create(null);function Y(e,t){if(!t)return e;const r=t.split(".");for(let n=0,a=r.length;n<a;++n){const i=r[n];e=e[i]||(e[i]=Object.create(null))}return e}function le(e,t,r){return typeof t=="string"?R(Y(e,t),r):R(Y(e,""),t)}class yr{constructor(t,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,a)=>se(a.backgroundColor),this.hoverBorderColor=(n,a)=>se(a.borderColor),this.hoverColor=(n,a)=>se(a.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(r)}set(t,r){return le(this,t,r)}get(t){return Y(this,t)}describe(t,r){return le(gr,t,r)}override(t,r){return le(br,t,r)}route(t,r,n,a){const i=Y(this,t),o=Y(this,n),s="_"+r;Object.defineProperties(i,{[s]:{value:i[r],writable:!0},[r]:{enumerable:!0,get(){const l=this[s],d=o[a];return C(l)?Object.assign({},d,l):A(l,d)},set(l){this[s]=l}}})}apply(t){t.forEach(r=>r(this))}}var mr=new yr({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[sr,lr,hr]);function pr(e){return!e||E(e.size)||E(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}const xr=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,vr=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function _r(e,t){const r=(""+e).match(xr);if(!r||r[1]==="normal")return t*1.2;switch(e=+r[2],r[3]){case"px":return e;case"%":e/=100;break}return t*e}const wr=e=>+e||0;function kr(e,t){const r={},n=C(t),a=n?Object.keys(t):t,i=C(e)?n?o=>A(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of a)r[o]=wr(i(o));return r}function Cr(e){return kr(e,{top:"y",right:"x",bottom:"y",left:"x"})}function jr(e){const t=Cr(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Mr(e,t){e=e||{},t=t||mr.font;let r=A(e.size,t.size);typeof r=="string"&&(r=parseInt(r,10));let n=A(e.style,t.style);n&&!(""+n).match(vr)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const a={family:A(e.family,t.family),lineHeight:_r(A(e.lineHeight,t.lineHeight),r),size:r,style:n,weight:A(e.weight,t.weight),string:""};return a.string=pr(a),a}function b(e,t,r,n){let a,i,o;for(a=0,i=e.length;a<i;++a)if(o=e[a],o!==void 0&&(t!==void 0&&typeof o=="function"&&(o=o(t)),r!==void 0&&X(o)&&(o=o[r%o.length]),o!==void 0))return o}function Ir(){return typeof window<"u"&&typeof document<"u"}(function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Ir()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e})();var Pe=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),B={toTextLines:function(e){var t=[],r;for(e=[].concat(e);e.length;)r=e.pop(),typeof r=="string"?t.unshift.apply(t,r.split(`
`)):Array.isArray(r)?e.push.apply(e,r):E(e)||t.unshift(""+r);return t},textSize:function(e,t,r){var n=[].concat(t),a=n.length,i=e.font,o=0,s;for(e.font=r.string,s=0;s<a;++s)o=Math.max(e.measureText(n[s]).width,o);return e.font=i,{height:a*r.lineHeight,width:o}},bound:function(e,t,r){return Math.max(e,Math.min(t,r))},arrayDiff:function(e,t){var r=e.slice(),n=[],a,i,o,s;for(a=0,o=t.length;a<o;++a)s=t[a],i=r.indexOf(s),i===-1?n.push([s,1]):r.splice(i,1);for(a=0,o=r.length;a<o;++a)n.push([r[a],-1]);return n},rasterize:function(e){return Math.round(e*Pe)/Pe}};function ce(e,t){var r=t.x,n=t.y;if(r===null)return{x:0,y:-1};if(n===null)return{x:1,y:0};var a=e.x-r,i=e.y-n,o=Math.sqrt(a*a+i*i);return{x:o?a/o:0,y:o?i/o:-1}}function Sr(e,t,r,n,a){switch(a){case"center":r=n=0;break;case"bottom":r=0,n=1;break;case"right":r=1,n=0;break;case"left":r=-1,n=0;break;case"top":r=0,n=-1;break;case"start":r=-r,n=-n;break;case"end":break;default:a*=Math.PI/180,r=Math.cos(a),n=Math.sin(a);break}return{x:e,y:t,vx:r,vy:n}}var Or=0,Xe=1,Ke=2,Ze=4,qe=8;function J(e,t,r){var n=Or;return e<r.left?n|=Xe:e>r.right&&(n|=Ke),t<r.top?n|=qe:t>r.bottom&&(n|=Ze),n}function Ar(e,t){for(var r=e.x0,n=e.y0,a=e.x1,i=e.y1,o=J(r,n,t),s=J(a,i,t),l,d,f;!(!(o|s)||o&s);)l=o||s,l&qe?(d=r+(a-r)*(t.top-n)/(i-n),f=t.top):l&Ze?(d=r+(a-r)*(t.bottom-n)/(i-n),f=t.bottom):l&Ke?(f=n+(i-n)*(t.right-r)/(a-r),d=t.right):l&Xe&&(f=n+(i-n)*(t.left-r)/(a-r),d=t.left),l===o?(r=d,n=f,o=J(r,n,t)):(a=d,i=f,s=J(a,i,t));return{x0:r,x1:a,y0:n,y1:i}}function ee(e,t){var r=t.anchor,n=e,a,i;return t.clamp&&(n=Ar(n,t.area)),r==="start"?(a=n.x0,i=n.y0):r==="end"?(a=n.x1,i=n.y1):(a=(n.x0+n.x1)/2,i=(n.y0+n.y1)/2),Sr(a,i,e.vx,e.vy,t.align)}var te={arc:function(e,t){var r=(e.startAngle+e.endAngle)/2,n=Math.cos(r),a=Math.sin(r),i=e.innerRadius,o=e.outerRadius;return ee({x0:e.x+n*i,y0:e.y+a*i,x1:e.x+n*o,y1:e.y+a*o,vx:n,vy:a},t)},point:function(e,t){var r=ce(e,t.origin),n=r.x*e.options.radius,a=r.y*e.options.radius;return ee({x0:e.x-n,y0:e.y-a,x1:e.x+n,y1:e.y+a,vx:r.x,vy:r.y},t)},bar:function(e,t){var r=ce(e,t.origin),n=e.x,a=e.y,i=0,o=0;return e.horizontal?(n=Math.min(e.x,e.base),i=Math.abs(e.base-e.x)):(a=Math.min(e.y,e.base),o=Math.abs(e.base-e.y)),ee({x0:n,y0:a+o,x1:n+i,y1:a,vx:r.x,vy:r.y},t)},fallback:function(e,t){var r=ce(e,t.origin);return ee({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:r.x,vy:r.y},t)}},S=B.rasterize;function Dr(e){var t=e.borderWidth||0,r=e.padding,n=e.size.height,a=e.size.width,i=-a/2,o=-n/2;return{frame:{x:i-r.left-t,y:o-r.top-t,w:a+r.width+t*2,h:n+r.height+t*2},text:{x:i,y:o,w:a,h:n}}}function Pr(e,t){var r=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!r)return null;if(r.xCenter!==void 0&&r.yCenter!==void 0)return{x:r.xCenter,y:r.yCenter};var n=r.getBasePixel();return e.horizontal?{x:n,y:null}:{x:null,y:n}}function Tr(e){return e instanceof wt?te.arc:e instanceof Ee?te.point:e instanceof Le?te.bar:te.fallback}function Rr(e,t,r,n,a,i){var o=Math.PI/2;if(i){var s=Math.min(i,a/2,n/2),l=t+s,d=r+s,f=t+n-s,u=r+a-s;e.moveTo(t,d),l<f&&d<u?(e.arc(l,d,s,-Math.PI,-o),e.arc(f,d,s,-o,0),e.arc(f,u,s,0,o),e.arc(l,u,s,o,Math.PI)):l<f?(e.moveTo(l,r),e.arc(f,d,s,-o,o),e.arc(l,d,s,o,Math.PI+o)):d<u?(e.arc(l,d,s,-Math.PI,0),e.arc(l,u,s,0,Math.PI)):e.arc(l,d,s,-Math.PI,Math.PI),e.closePath(),e.moveTo(t,r)}else e.rect(t,r,n,a)}function Fr(e,t,r){var n=r.backgroundColor,a=r.borderColor,i=r.borderWidth;!n&&(!a||!i)||(e.beginPath(),Rr(e,S(t.x)+i/2,S(t.y)+i/2,S(t.w)-i,S(t.h)-i,r.borderRadius),e.closePath(),n&&(e.fillStyle=n,e.fill()),a&&i&&(e.strokeStyle=a,e.lineWidth=i,e.lineJoin="miter",e.stroke()))}function Wr(e,t,r){var n=r.lineHeight,a=e.w,i=e.x,o=e.y+n/2;return t==="center"?i+=a/2:(t==="end"||t==="right")&&(i+=a),{h:n,w:a,x:i,y:o}}function Er(e,t,r){var n=e.shadowBlur,a=r.stroked,i=S(r.x),o=S(r.y),s=S(r.w);a&&e.strokeText(t,i,o,s),r.filled&&(n&&a&&(e.shadowBlur=0),e.fillText(t,i,o,s),n&&a&&(e.shadowBlur=n))}function Lr(e,t,r,n){var a=n.textAlign,i=n.color,o=!!i,s=n.font,l=t.length,d=n.textStrokeColor,f=n.textStrokeWidth,u=d&&f,y;if(!(!l||!o&&!u))for(r=Wr(r,a,s),e.font=s.string,e.textAlign=a,e.textBaseline="middle",e.shadowBlur=n.textShadowBlur,e.shadowColor=n.textShadowColor,o&&(e.fillStyle=i),u&&(e.lineJoin="round",e.lineWidth=f,e.strokeStyle=d),y=0,l=t.length;y<l;++y)Er(e,t[y],{stroked:u,filled:o,w:r.w,x:r.x,y:r.y+r.h*y})}var Ve=function(e,t,r,n){var a=this;a._config=e,a._index=n,a._model=null,a._rects=null,a._ctx=t,a._el=r};R(Ve.prototype,{_modelize:function(e,t,r,n){var a=this,i=a._index,o=Mr(b([r.font,{}],n,i)),s=b([r.color,_t.color],n,i);return{align:b([r.align,"center"],n,i),anchor:b([r.anchor,"center"],n,i),area:n.chart.chartArea,backgroundColor:b([r.backgroundColor,null],n,i),borderColor:b([r.borderColor,null],n,i),borderRadius:b([r.borderRadius,0],n,i),borderWidth:b([r.borderWidth,0],n,i),clamp:b([r.clamp,!1],n,i),clip:b([r.clip,!1],n,i),color:s,display:e,font:o,lines:t,offset:b([r.offset,4],n,i),opacity:b([r.opacity,1],n,i),origin:Pr(a._el,n),padding:jr(b([r.padding,4],n,i)),positioner:Tr(a._el),rotation:b([r.rotation,0],n,i)*(Math.PI/180),size:B.textSize(a._ctx,t,o),textAlign:b([r.textAlign,"start"],n,i),textShadowBlur:b([r.textShadowBlur,0],n,i),textShadowColor:b([r.textShadowColor,s],n,i),textStrokeColor:b([r.textStrokeColor,s],n,i),textStrokeWidth:b([r.textStrokeWidth,0],n,i)}},update:function(e){var t=this,r=null,n=null,a=t._index,i=t._config,o,s,l,d=b([i.display,!0],e,a);d&&(o=e.dataset.data[a],s=A(Ge(i.formatter,[o,e]),o),l=E(s)?[]:B.toTextLines(s),l.length&&(r=t._modelize(d,l,i,e),n=Dr(r))),t._model=r,t._rects=n},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,t){var r=this,n=e.ctx,a=r._model,i=r._rects,o;this.visible()&&(n.save(),a.clip&&(o=a.area,n.beginPath(),n.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),n.clip()),n.globalAlpha=B.bound(0,a.opacity,1),n.translate(S(t.x),S(t.y)),n.rotate(a.rotation),Fr(n,i.frame,a),Lr(n,a.lines,i.text,a),n.restore())}});var Nr=Number.MIN_SAFE_INTEGER||-9007199254740991,Ur=Number.MAX_SAFE_INTEGER||9007199254740991;function U(e,t,r){var n=Math.cos(r),a=Math.sin(r),i=t.x,o=t.y;return{x:i+n*(e.x-i)-a*(e.y-o),y:o+a*(e.x-i)+n*(e.y-o)}}function Te(e,t){var r=Ur,n=Nr,a=t.origin,i,o,s,l,d;for(i=0;i<e.length;++i)o=e[i],s=o.x-a.x,l=o.y-a.y,d=t.vx*s+t.vy*l,r=Math.min(r,d),n=Math.max(n,d);return{min:r,max:n}}function re(e,t){var r=t.x-e.x,n=t.y-e.y,a=Math.sqrt(r*r+n*n);return{vx:(t.x-e.x)/a,vy:(t.y-e.y)/a,origin:e,ln:a}}var Qe=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};R(Qe.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,t,r){this._rotation=r,this._rect={x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}},contains:function(e){var t=this,r=1,n=t._rect;return e=U(e,t.center(),-t._rotation),!(e.x<n.x-r||e.y<n.y-r||e.x>n.x+n.w+r*2||e.y>n.y+n.h+r*2)},intersects:function(e){var t=this._points(),r=e._points(),n=[re(t[0],t[1]),re(t[0],t[3])],a,i,o;for(this._rotation!==e._rotation&&n.push(re(r[0],r[1]),re(r[0],r[3])),a=0;a<n.length;++a)if(i=Te(t,n[a]),o=Te(r,n[a]),i.max<o.min||o.max<i.min)return!1;return!0},_points:function(){var e=this,t=e._rect,r=e._rotation,n=e.center();return[U({x:t.x,y:t.y},n,r),U({x:t.x+t.w,y:t.y},n,r),U({x:t.x+t.w,y:t.y+t.h},n,r),U({x:t.x,y:t.y+t.h},n,r)]}});function Je(e,t,r){var n=t.positioner(e,t),a=n.vx,i=n.vy;if(!a&&!i)return{x:n.x,y:n.y};var o=r.w,s=r.h,l=t.rotation,d=Math.abs(o/2*Math.cos(l))+Math.abs(s/2*Math.sin(l)),f=Math.abs(o/2*Math.sin(l))+Math.abs(s/2*Math.cos(l)),u=1/Math.max(Math.abs(a),Math.abs(i));return d*=a*u,f*=i*u,d+=t.offset*a,f+=t.offset*i,{x:n.x+d,y:n.y+f}}function $r(e,t){var r,n,a,i;for(r=e.length-1;r>=0;--r)for(a=e[r].$layout,n=r-1;n>=0&&a._visible;--n)i=e[n].$layout,i._visible&&a._box.intersects(i._box)&&t(a,i);return e}function Yr(e){var t,r,n,a,i,o,s;for(t=0,r=e.length;t<r;++t)n=e[t],a=n.$layout,a._visible&&(s=new Proxy(n._el,{get:(l,d)=>l.getProps([d],!0)[d]}),i=n.geometry(),o=Je(s,n.model(),i),a._box.update(o,i,n.rotation()));return $r(e,function(l,d){var f=l._hidable,u=d._hidable;f&&u||u?d._visible=!1:f&&(l._visible=!1)})}var H={prepare:function(e){var t=[],r,n,a,i,o;for(r=0,a=e.length;r<a;++r)for(n=0,i=e[r].length;n<i;++n)o=e[r][n],t.push(o),o.$layout={_box:new Qe,_hidable:!1,_visible:!0,_set:r,_idx:o._index};return t.sort(function(s,l){var d=s.$layout,f=l.$layout;return d._idx===f._idx?f._set-d._set:f._idx-d._idx}),this.update(t),t},update:function(e){var t=!1,r,n,a,i,o;for(r=0,n=e.length;r<n;++r)a=e[r],i=a.model(),o=a.$layout,o._hidable=i&&i.display==="auto",o._visible=a.visible(),t|=o._hidable;t&&Yr(e)},lookup:function(e,t){var r,n;for(r=e.length-1;r>=0;--r)if(n=e[r].$layout,n&&n._visible&&n._box.contains(t))return e[r];return null},draw:function(e,t){var r,n,a,i,o,s;for(r=0,n=t.length;r<n;++r)a=t[r],i=a.$layout,i._visible&&(o=a.geometry(),s=Je(a._el,a.model(),o),i._box.update(s,o,a.rotation()),a.draw(e,s))}},Br=function(e){if(E(e))return null;var t=e,r,n,a;if(C(e))if(!E(e.label))t=e.label;else if(!E(e.r))t=e.r;else for(t="",r=Object.keys(e),a=0,n=r.length;a<n;++a)t+=(a!==0?", ":"")+r[a]+": "+e[r[a]];return""+t},Hr={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:Br,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},m="$datalabels",et="$default";function Gr(e,t){var r=e.datalabels,n={},a=[],i,o;return r===!1?null:(r===!0&&(r={}),t=R({},[t,r]),i=t.labels||{},o=Object.keys(i),delete t.labels,o.length?o.forEach(function(s){i[s]&&a.push(R({},[t,i[s],{_key:s}]))}):a.push(t),n=a.reduce(function(s,l){return tr(l.listeners||{},function(d,f){s[f]=s[f]||{},s[f][l._key||et]=d}),delete l.listeners,s},{}),{labels:a,listeners:n})}function be(e,t,r,n){if(t){var a=r.$context,i=r.$groups,o;t[i._set]&&(o=t[i._set][i._key],o&&Ge(o,[a,n])===!0&&(e[m]._dirty=!0,r.update(a)))}}function zr(e,t,r,n,a){var i,o;!r&&!n||(r?n?r!==n&&(o=i=!0):o=!0:i=!0,o&&be(e,t.leave,r,a),i&&be(e,t.enter,n,a))}function Xr(e,t){var r=e[m],n=r._listeners,a,i;if(!(!n.enter&&!n.leave)){if(t.type==="mousemove")i=H.lookup(r._labels,t);else if(t.type!=="mouseout")return;a=r._hovered,r._hovered=i,zr(e,n,a,i,t)}}function Kr(e,t){var r=e[m],n=r._listeners.click,a=n&&H.lookup(r._labels,t);a&&be(e,n,a,t)}var Zr={id:"datalabels",defaults:Hr,beforeInit:function(e){e[m]={_actives:[]}},beforeUpdate:function(e){var t=e[m];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(e,t,r){var n=t.index,a=e[m],i=a._datasets[n]=[],o=e.isDatasetVisible(n),s=e.data.datasets[n],l=Gr(s,r),d=t.meta.data||[],f=e.ctx,u,y,j,h,v,M,O,_;for(f.save(),u=0,j=d.length;u<j;++u)if(O=d[u],O[m]=[],o&&O&&e.getDataVisibility(u)&&!O.skip)for(y=0,h=l.labels.length;y<h;++y)v=l.labels[y],M=v._key,_=new Ve(v,f,O,u),_.$groups={_set:n,_key:M||et},_.$context={active:!1,chart:e,dataIndex:u,dataset:s,datasetIndex:n},_.update(_.$context),O[m].push(_),i.push(_);f.restore(),R(a._listeners,l.listeners,{merger:function(F,W,ie){W[F]=W[F]||{},W[F][t.index]=ie[F],a._listened=!0}})},afterUpdate:function(e){e[m]._labels=H.prepare(e[m]._datasets)},afterDatasetsDraw:function(e){H.draw(e,e[m]._labels)},beforeEvent:function(e,t){if(e[m]._listened){var r=t.event;switch(r.type){case"mousemove":case"mouseout":Xr(e,r);break;case"click":Kr(e,r);break}}},afterEvent:function(e){var t=e[m],r=t._actives,n=t._actives=e.getActiveElements(),a=B.arrayDiff(r,n),i,o,s,l,d,f,u;for(i=0,o=a.length;i<o;++i)if(d=a[i],d[1])for(u=d[0].element[m]||[],s=0,l=u.length;s<l;++s)f=u[s],f.$context.active=d[1]===1,f.update(f.$context);(t._dirty||a.length)&&(H.update(t._labels),e.render()),delete t._dirty}};const tt="label";function Re(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function qr(e,t){const r=e.options;r&&t&&Object.assign(r,t)}function rt(e,t){e.labels=t}function nt(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:tt;const n=[];e.datasets=t.map(a=>{const i=e.datasets.find(o=>o[r]===a[r]);return!i||!a.data||n.includes(i)?{...a}:(n.push(i),Object.assign(i,a),i)})}function Vr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tt;const r={labels:[],datasets:[]};return rt(r,e.labels),nt(r,e.datasets,t),r}function Qr(e,t){const{height:r=150,width:n=300,redraw:a=!1,datasetIdKey:i,type:o,data:s,options:l,plugins:d=[],fallbackContent:f,updateMode:u,...y}=e,j=ne(null),h=ne(),v=()=>{j.current&&(h.current=new ye(j.current,{type:o,data:Vr(s,i),options:l&&{...l},plugins:d}),Re(t,h.current))},M=()=>{Re(t,null),h.current&&(h.current.destroy(),h.current=null)};return k(()=>{!a&&h.current&&l&&qr(h.current,l)},[a,l]),k(()=>{!a&&h.current&&rt(h.current.config.data,s.labels)},[a,s.labels]),k(()=>{!a&&h.current&&s.datasets&&nt(h.current.config.data,s.datasets,i)},[a,s.datasets]),k(()=>{h.current&&(a?(M(),setTimeout(v)):h.current.update(u))},[a,l,s.labels,s.datasets,u]),k(()=>{h.current&&(M(),setTimeout(v))},[o]),k(()=>(v(),()=>M()),[]),ge.createElement("canvas",Object.assign({ref:j,role:"img",height:r,width:n},y),f)}const Jr=We(Qr);function at(e,t){return ye.register(t),We((r,n)=>ge.createElement(Jr,Object.assign({},r,{ref:n,type:e})))}const it=at("line",Ne),en=at("bar",kt),tn=async e=>{const t="https://weather-broker-cdn.api.bbci.co.uk/en/forecast/aggregated/"+e.bbcID;return fetch(t).then(r=>r.json()).then(r=>{console.log("BBC full forecasts:",r.forecasts);const n={tzOffset:r.forecasts.at(0).detailed.issueDate.slice(19),hourly:{x:[],y_temperature:[],y_windGust:[],y_precipChance:[]},daily:{x:[],y_uvIndex:[],y_pollenIndex:[],y_pollutionIndex:[]}};return r.forecasts.forEach(a=>{a.detailed.reports.forEach(o=>{n.hourly.x.push(new Date(o.localDate+" "+o.timeslot)),n.hourly.y_temperature.push(o.temperatureC),n.hourly.y_windGust.push(o.gustSpeedKph>25?o.gustSpeedKph:null),n.hourly.y_precipChance.push(o.precipitationProbabilityInPercent)});const i=a.summary.report;n.daily.x.push(new Date(i.localDate)),n.daily.y_uvIndex.push(i.uvIndex),n.daily.y_pollenIndex.push(i.pollenIndex),n.daily.y_pollutionIndex.push(i.pollutionIndex)}),n})},_e="e1f10a1e78da46f5b10a1e78da96f525",rn=async e=>{const t=`https://api.weather.com/v3/wx/forecast/hourly/15day?apiKey=${_e}&geocode=${e.coords[0]}%2C${e.coords[1]}&units=m&language=en-US&format=json`;return fetch(t,{referrerPolicy:"no-referrer",credentials:"omit"}).then(r=>r.json()).then(r=>{var a;return console.log("Forecast:",r),{tzOffset:(a=r.validTimeLocal.at(0))==null?void 0:a.slice(19),x:r.validTimeLocal.map(i=>new Date(i.slice(0,19))),y_precipitation:r.qpf,y_temperature:r.temperature,y_windGust:r.windGust,y_precipChance:r.precipChance,y_uvIndex:r.uvIndex.map(i=>i>0?i:null),y_cloudCover:r.cloudCover.map(i=>i>0?i:null)}})},nn=async e=>{const t=`https://api.weather.com/v3/wx/conditions/historical/hourly/1day?apiKey=${_e}&geocode=${e.coords[0]}%2C${e.coords[1]}&units=m&language=en-US&format=json`;return fetch(t,{referrerPolicy:"no-referrer",credentials:"omit"}).then(r=>r.json()).then(r=>{var a;return console.log("History:",r),{tzOffset:(a=r.validTimeLocal.at(0))==null?void 0:a.slice(19),x:r.validTimeLocal.map(i=>new Date(i.slice(0,19))),y_precipitation:[],y_temperature:r.temperature,y_windGust:r.windGust,y_precipChance:[],y_uvIndex:[],y_cloudCover:[]}})},an=async e=>{const t=`https://api.weather.com/v2/turbo/vt1pollenforecast?apiKey=${_e}&geocode=${e.coords[0]}%2C${e.coords[1]}&language=en&format=json`;return fetch(t,{}).then(r=>r.json()).then(r=>(console.log("Pollen:",r),{x:r.vt1pollenforecast.reportDate.map(a=>new Date(a.slice(0,19))),y_tree:r.vt1pollenforecast.tree,y_weed:r.vt1pollenforecast.weed,y_grass:r.vt1pollenforecast.grass}))},ot=(e,t)=>{const r=e.ctx,n=r.canvas.parentElement,a=(t??"+0000").replace(":",""),i=parseInt(a.slice(0,3))*Ct+parseInt(a.slice(3))*jt,o=new Date().toISOString().slice(0,19),s=new Date(o).getTime()+i,l=e.scales.x.getPixelForValue(s),d=0,f=e.chartArea.bottom+e.scales.x.height;r.save(),r.beginPath(),r.strokeStyle="#088",r.lineWidth=2,r.moveTo(l,f),r.lineTo(l,d),r.stroke(),r.restore(),n.scrollLeft===0&&n.scrollTo(e.scales.x.left,0)},g=(e,t,r)=>({axis:"y",type:"linear",grid:{display:!1},ticks:{stepSize:r,color:t,font:{size:20}},title:{display:!0,text:e,color:t,font:{size:20}},position:"left",beginAtZero:!0}),we=()=>({axis:"x",type:"time",time:{unit:"day",tooltipFormat:"ddd D MMM H:mm",displayFormats:{day:"ddd D MMM",hour:"H:mm"}},grid:{color:"#0006",lineWidth:t=>{var r,n;return(n=(r=t.tick)==null?void 0:r.label)!=null&&n.startsWith("Mon")?5:1}},ticks:{color:"#000",font:{size:20},align:"start"}}),on=e=>{const t={pointRadius:0,pointHoverRadius:5,borderWidth:2,cubicInterpolationMode:"default",tension:0,fill:!1},r=[{...t,data:e.hourly.y_temperature,borderColor:"#d5202a",yAxisID:"y_temperature",order:1},{...t,data:e.hourly.y_windGust,borderColor:"#b9f",yAxisID:"y_windGust",order:3},{...t,data:e.hourly.y_precipChance,borderColor:"#15aadc",yAxisID:"y_precipChance",order:2}];return{labels:e.hourly.x,datasets:r}},sn=()=>({elements:{point:{radius:1}},plugins:{legend:{display:!1}},locale:"en-GB",responsive:!1,scales:{x:we(),y_temperature:{...g("Temperature C","#d5202a",5),beginAtZero:!1,grid:{color:"#d5202a20",lineWidth:e=>e.tick.value%10===0?5:2}},y_precipChance:{...g("Rain proba %","#15aadc",50),max:100},y_windGust:g("Wind Gust km/h","#b9f",25)}}),ln=(e,t)=>{const r={pointRadius:0,pointHoverRadius:5,borderWidth:2,cubicInterpolationMode:"default",tension:0},n=[{...r,data:e.daily.y_pollutionIndex,backgroundColor:x.Pollution,yAxisID:"y_pollutionIndex",order:1},{...r,data:e.daily.y_uvIndex,backgroundColor:x.UV,yAxisID:"y_uvIndex",order:2},{...r,data:e.daily.y_pollenIndex,backgroundColor:x.Pollen,yAxisID:"y_pollenIndex",order:3},{...r,data:t.y_tree,backgroundColor:x.Tree,yAxisID:"y_tree",order:4},{...r,data:t.y_grass,backgroundColor:x.Grass,yAxisID:"y_grass",order:5},{...r,data:t.y_weed,backgroundColor:x.Weed,yAxisID:"y_weed",order:6}];return{labels:e.daily.x,datasets:n}},cn=()=>{const e=we();return e.ticks.align="center",{elements:{point:{radius:1}},plugins:{legend:{display:!1}},locale:"en-GB",responsive:!1,scales:{x:e,y_pollutionIndex:{...g("Pollution index",x.Pollution,10),max:10},y_uvIndex:{...g("UV index",x.UV,10),max:10},y_pollenIndex:{...g("Pollen index",x.Pollen,10),max:10},y_tree:{...g("WU Tree index",x.Tree,10),max:10},y_grass:{...g("WU Grass index",x.Grass,10),max:10},y_weed:{...g("WU Weed index",x.Weed,10),max:10}}}},dn=({place:e})=>{const[t,r]=P(),[n,a]=P(null),[i,o]=P(null),s=ne(null);if(k(()=>{(async function(){const F=[tn(e),an(e)],[W,ie]=await Promise.all(F);a(on(W)),o(ln(W,ie)),r(W.tzOffset)})()},[e]),n===null||i===null)return c.jsx("p",{children:"Loading..."});const l=sn(),d=cn(),f=n.labels.at(0),u=i.labels.at(0),y=f<u?f:u,j=new Date(y).setHours(0,0,0,0);l.scales.x.min=j-Mt,d.scales.x.min=j;const h=n.labels.at(-1),v=i.labels.at(-1),M=h>v?h:v,O=new Date(M).setHours(0,0,0,0),_=new Date(M).setHours(23,0,0,0);return console.log(_),l.scales.x.max=_,d.scales.x.max=O,d.plugins={datalabels:{color:"#000",anchor:"end",align:"top",clamp:!0},legend:{labels:{filter:F=>!1}}},l.animation={onComplete:()=>s.current&&ot(s.current,t)},c.jsxs(c.Fragment,{children:[c.jsx("p",{children:"BBC"}),c.jsx("div",{className:"x-chart",children:c.jsxs("div",{className:"x-scrollable-x","data-testid":"chart-bbc",children:[c.jsx(it,{ref:s,data:n,options:l,width:3e3,height:G?300:200}),c.jsx(en,{plugins:[Zr],data:i,options:d,width:3e3,height:G?300:200})]})}),c.jsx("div",{className:"x-shadow",children:c.jsx("ul",{children:c.jsx(L,{href:"https://www.bbc.co.uk/weather/"+e.bbcID,children:"Weather"})})})]})},fn=()=>{const[e,t]=P(!0),r=new fe,n=r.isAurora(),a=n?null:r.getLocation(),i=s=>{t(s)},o=s=>{const l=new fe().searchParams;return l.set("location",s),l.delete("aurora"),"?"+l.toString()};return c.jsxs(K,{id:"x-navbar",expand:"sm",variant:"dark",onToggle:i,expanded:e,children:[c.jsx(K.Brand,{children:"Weather"}),c.jsx(K.Toggle,{"aria-controls":"basic-navbar-nav"}),c.jsx(K.Collapse,{id:"basic-navbar-nav",children:c.jsxs(Ce,{className:"ms-auto me-auto",children:[c.jsx(je,{title:a||"Weather locations",active:!n,children:me.map((s,l)=>c.jsx(je.Item,{href:o(s.name),active:s.name===a,children:s.name},l))}),c.jsx(Ce.Link,{href:"?aurora=true",active:n,children:"Northern lights"})]})})]})},un=(e,t)=>{const r=[],n={pointRadius:0,pointHoverRadius:5,borderWidth:2,cubicInterpolationMode:"default",tension:0},a=Array.from({length:t.x.length},(i,o)=>null);return r.push({...n,data:[...a,...e.y_precipitation],borderColor:"#0053ae",backgroundColor:"#0053ae30",yAxisID:"y_precipitation",fill:"origin",order:3}),r.push({...n,data:[...t.y_temperature.toReversed(),...e.y_temperature],borderColor:"#d5202a",yAxisID:"y_temperature",fill:!1,order:1}),r.push({...n,data:[...t.y_windGust.toReversed(),...e.y_windGust],borderColor:"#b9f",yAxisID:"y_windGust",fill:!1,order:6}),r.push({...n,data:[...a,...e.y_precipChance],borderColor:"#15aadc",yAxisID:"y_precipChance",fill:!1,order:2}),r.push({...n,data:[...a,...e.y_uvIndex],borderColor:"#fc0",yAxisID:"y_uvIndex",fill:!1,order:4}),r.push({...n,data:[...a,...e.y_cloudCover],yAxisID:"y_cloudCover",borderColor:"#aaa",order:5}),{labels:[...t.x.toReversed(),...e.x],datasets:r}},Fe={elements:{point:{radius:1}},plugins:{legend:{display:!1}},locale:"en-GB",responsive:!1,scales:{x:we(),y_temperature:{...g("Temperature C","#d5202a",5),grid:{color:"#d5202a20",lineWidth:e=>e.tick.value%10===0?5:2},beginAtZero:!1},y_precipitation:{...g("Rain mm/h","#0053ae",1),grid:{color:"#0053ae40",lineWidth:4},suggestedMax:1},y_precipChance:{...g("Rain proba %","#15aadc",50),max:100},y_uvIndex:{...g("UV index","#fc0",10),max:10},y_windGust:g("Wind Gust km/h","#b9f",25),y_cloudCover:{...g("Cloud Cover %","#aaa",50),max:100}}},hn=({place:e})=>{const[t,r]=P(),[n,a]=P(null),i=ne(null);return k(()=>{(async function(){const o=[rn(e),nn(e)],[s,l]=await Promise.all(o);a(un(s,l)),r(s.tzOffset)})()},[e]),n===null?c.jsx("p",{children:"Loading..."}):(Fe.animation={onComplete:()=>i.current&&ot(i.current,t)},c.jsxs(c.Fragment,{children:[c.jsx("p",{children:"Weather Underground"}),c.jsx("div",{className:"x-chart",children:c.jsx("div",{className:"x-scrollable-x","data-testid":"chart-wu",children:c.jsx(it,{ref:i,data:n,options:Fe,width:3e3,height:G?300:200})})}),c.jsx("div",{className:"x-shadow",children:c.jsxs("ul",{children:[c.jsx(L,{href:"https://www.wunderground.com/forecast/"+e.linkWU,children:"Weather"}),c.jsx(L,{href:`https://www.wunderground.com/health/${e.linkWU}?cm_ven=localwx_modpollen`,children:"Pollen/AQ"})]})})]}))};St();const bn=()=>{const e=new fe;if(e.isAurora())return de(c.jsx(Ot,{}));{const r=e.getLocation(),n=me.filter(a=>a.name===r).pop();return de(n?c.jsxs(c.Fragment,{children:[c.jsx(hn,{place:n}),c.jsx("hr",{}),c.jsx(dn,{place:n}),c.jsx("hr",{}),c.jsx(gn,{}),c.jsx("hr",{}),c.jsx(yn,{place:n})]}):c.jsx("p",{children:"Invalid Location"}))}},de=e=>c.jsxs(c.Fragment,{children:[c.jsx(fn,{}),c.jsx("main",{children:e})]}),gn=()=>{const e=new Date().toISOString().substring(0,10);return c.jsxs(c.Fragment,{children:[c.jsx("p",{children:"MET Office"}),c.jsx("div",{className:"x-shadow",children:c.jsxs("ul",{children:[c.jsx(L,{href:"https://www.metoffice.gov.uk/weather/maps-and-charts/rainfall-radar-forecast-map#?model=ukmo-ukv&layer=rainfall-rate",children:"Rain Map UK"}),c.jsx(L,{href:`https://www.metoffice.gov.uk/weather/warnings-and-advice/seasonal-advice/pollen-forecast#?date=${e}&region=em`,children:"East Midlands"})]})})]})},yn=({place:e})=>{const t=e.coords.map(r=>r.toFixed(4));return c.jsx("div",{className:"x-shadow",children:c.jsx($e,{href:`https://www.lightningmaps.org/?lang=en#m=oss;t=3;s=0;o=0;b=0.00;ts=0;y=${t[0]};x=${t[1]};z=13;d=2;dl=2;dc=0;`,children:"⛈ Lightnings"})})};ct.createRoot(document.getElementById("root")).render(c.jsx(ge.StrictMode,{children:c.jsx(dt,{children:c.jsx(bn,{})})}));
