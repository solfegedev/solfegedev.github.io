import"./index-Clf_ziPw.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{A as oe}from"./api-CH_Pe6Vg.js";import{S as we}from"./search-Cfl0sis-.js";import{X as ke}from"./x-BS-d4QNZ.js";import{c as Se}from"./createLucideIcon-DtX1aPOG.js";import{G as Re,D as $e,U as Ce,P as _e}from"./upload-FXP4Asuw.js";import{R as De}from"./refresh-cw-pTx9cW3g.js";import{P as Ue}from"./plus-DDkdk0pc.js";import{T as Ie}from"./trash-2-DQbJ9aIh.js";import{C as Fe}from"./copy-CzC7y2Qs.js";import{S as Ee}from"./save-rN7CZjMN.js";const Le=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Ae=Se("folder",Le),J=`${oe}/bookmarks`,Y=async s=>{if(s.ok)return s.status===204?null:s.json();throw await s.json().catch(()=>({detail:s.statusText}))},x={get:(s,o)=>fetch(`${J}${s}`,{headers:o?{Authorization:`Bearer ${o}`}:{}}).then(Y),post:(s,o,n)=>fetch(`${J}${s}`,{method:"POST",headers:{"Content-Type":"application/json",...n?{Authorization:`Bearer ${n}`}:{}},body:JSON.stringify(o)}).then(Y),put:(s,o,n)=>fetch(`${J}${s}`,{method:"PUT",headers:{"Content-Type":"application/json",...n?{Authorization:`Bearer ${n}`}:{}},body:JSON.stringify(o)}).then(Y),delete:(s,o)=>fetch(`${J}${s}`,{method:"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}).then(Y)},$=React.forwardRef(({variant:s="default",className:o="",...n},u)=>{const p="w-full bg-slate-950 border border-slate-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",i={default:"px-4 py-2",small:"px-3 py-1.5 text-sm"};return e.jsx("input",{ref:u,className:`${p} ${i[s]} ${o}`,...n})});$.displayName="Input";const b=React.forwardRef(({variant:s="primary",className:o="",children:n,...u},p)=>{const i="transition-colors rounded-lg font-bold",m={primary:"bg-gradient-to-r from-indigo-500 to-violet-500 text-white py-2 px-8 shadow-[0_15px_35px_rgba(108,99,255,0.35)] hover:from-indigo-400 hover:to-violet-400 rounded-full uppercase tracking-[0.08em]",secondary:"bg-slate-700 hover:bg-slate-600 text-white py-2 px-8 h-[42px]",icon:"text-slate-500 hover:text-blue-400 p-1 transition-all",danger:"text-rose-500 hover:text-rose-400 p-2 hover:bg-rose-500/10 rounded-lg","icon-danger":"text-red-400 hover:text-red-300 p-1"};return e.jsx("button",{ref:p,className:`${i} ${m[s]} ${o}`,...u,children:n})});b.displayName="Button";const L=({label:s,htmlFor:o,hint:n,id:u,...p})=>{const i=u||o;return e.jsxs("div",{children:[e.jsxs("label",{htmlFor:i,className:"mb-1 block text-sm font-medium text-slate-400",children:[s," ",n&&e.jsx("span",{className:"text-slate-500",children:n})]}),e.jsx($,{id:i,...p})]})},ne=React.forwardRef(({className:s="",children:o,...n},u)=>e.jsx("select",{ref:u,className:`w-full bg-slate-950 border border-slate-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 ${s}`,...n,children:o}));ne.displayName="Select";const ie=({className:s})=>e.jsx(Ie,{className:`h-5 w-5 ${s||""}`}),Be=({className:s})=>e.jsx(_e,{className:`h-4 w-4 ${s||""}`}),Ge=({className:s})=>e.jsx(Ee,{className:`h-5 w-5 ${s||""}`}),K=({className:s})=>e.jsx(ke,{className:`h-4 w-4 ${s||""}`}),Oe=({className:s})=>e.jsx(we,{className:`h-4 w-4 ${s||""}`}),Te=({className:s})=>e.jsx(Ae,{className:`h-5 w-5 ${s||""}`}),Q=({className:s})=>e.jsx(Re,{className:`h-5 w-5 ${s||""}`}),Me=({className:s})=>e.jsx($e,{className:`h-5 w-5 ${s||""}`}),Pe=({className:s})=>e.jsx(Ce,{className:`h-5 w-5 ${s||""}`}),qe=({className:s})=>e.jsx(Ue,{className:`h-4 w-4 ${s||""}`}),He=({className:s})=>e.jsx(Fe,{className:`h-4 w-4 ${s||""}`}),Ve=({className:s})=>e.jsx(De,{className:`h-4 w-4 ${s||""}`}),ze=({onLogin:s})=>{const[o,n]=React.useState(""),[u,p]=React.useState(""),[i,m]=React.useState(null),[g,w]=React.useState(!1),j=async f=>{f.preventDefault(),w(!0),m(null);try{const k=await x.post("/login",{email:o,password:u});s(k)}catch(k){m(k.detail||"Login failed")}finally{w(!1)}};return e.jsxs("div",{className:"mx-auto mt-20 max-w-md rounded-xl border border-slate-800 bg-slate-900 p-6 shadow-xl",children:[e.jsx("h2",{className:"mb-6 text-center text-2xl font-bold",children:"Login to Bookmarks"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsx(L,{label:"Email",type:"email",autoComplete:"email",required:!0,"data-testid":"login-email",value:o,onChange:f=>n(f.target.value)}),e.jsx(L,{label:"Password",type:"password",autoComplete:"current-password",required:!0,"data-testid":"login-password",value:u,onChange:f=>p(f.target.value)}),i&&e.jsx("p",{className:"text-sm text-red-400",children:i}),e.jsx(b,{type:"submit",disabled:g,"data-testid":"login-submit",variant:"primary",className:"w-full disabled:opacity-50",children:g?"Logging in...":"Login"})]})]})},Je=({auth:s})=>{const[o,n]=React.useState([]),[u,p]=React.useState(!0),[i,m]=React.useState(null),[g,w]=React.useState(null),[j,f]=React.useState(null),[k,S]=React.useState(null),[_,D]=React.useState(""),[U,I]=React.useState(""),[A,C]=React.useState(""),[O,F]=React.useState(null),[T,B]=React.useState(!1),[M,R]=React.useState(null),[l,h]=React.useState(""),[G,W]=React.useState(""),[ee,te]=React.useState(""),[P,q]=React.useState(null),[E,se]=React.useState(""),ae=async()=>{try{const t=await x.get("/",s.access_token);n(t)}catch(t){console.error("Failed to fetch bookmarks",t)}finally{p(!1)}};React.useEffect(()=>{ae()},[s]);const de=async t=>{t.preventDefault(),F(null);try{const r=await x.post("/",{title:_,url:U,group:A.trim()||null},s.access_token);n([...o,r]),D(""),I(""),C(""),B(!1),r.group&&q(r.group)}catch(r){F(r.detail||"Failed to add bookmark")}},ce=async t=>{if(confirm("Are you sure you want to delete this bookmark?"))try{await x.delete(`/${t}`,s.access_token),n(o.filter(r=>r.id!==t)),R(null)}catch(r){console.error("Failed to delete bookmark",r)}},ue=t=>{R(t.id),h(t.title),W(t.url),te(t.group||"")},me=async t=>{try{const r={title:l,url:G,group:ee.trim()||null},a=await x.put(`/${t}`,r,s.access_token);n(o.map(d=>d.id===t?a:d)),R(null),r.group&&q(r.group)}catch(r){console.error("Failed to update bookmark",r)}},xe=async t=>{try{const r={title:`${t.title} (duplicate)`,url:t.url,group:t.group||null},a=await x.post("/",r,s.access_token);n([...o,a]),a.group&&q(a.group),R(null)}catch(r){console.error("Failed to duplicate bookmark",r)}},pe=t=>{m(t)},he=(t,r)=>{if(t.preventDefault(),i===null||i===r)return;const a=o.findIndex(y=>y.id===i),d=o.findIndex(y=>y.id===r);if(a===-1||d===-1)return;const c=[...o],[v]=c.splice(a,1);c.splice(d,0,v),c.map(y=>y.id).join(",")!==o.map(y=>y.id).join(",")&&n(c)},re=async()=>{if(!(i===null&&j===null)){m(null),f(null);try{const t={download_date:new Date().toISOString(),groups:Object.entries(o.reduce((r,a)=>{const d=a.group||"Un-grouped";return r[d]||(r[d]=[]),r[d].push({title:a.title,url:a.url,icon_url:a.icon_url}),r},{})).map(([r,a])=>({name:r,items:a}))};await x.post("/bulk",t,s.access_token)}catch(t){console.error("Failed to save reordered bookmarks",t),ae()}}},ge=t=>{f(t)},fe=(t,r)=>{if(t.preventDefault(),j===null||j===r)return;const a=V,d=a.indexOf(j),c=a.indexOf(r);if(d===-1||c===-1)return;const v=[...a],[y]=v.splice(d,1);v.splice(c,0,y);const z=o.reduce((N,le)=>{const Z=le.group||"Un-grouped";return N[Z]||(N[Z]=[]),N[Z].push(le),N},{}),X=[];v.forEach(N=>{z[N]&&X.push(...z[N])}),X.map(N=>N.id).join(",")!==o.map(N=>N.id).join(",")&&n(X)},H=React.useMemo(()=>E.trim()?new Fuse(o,{keys:["title","url","group"],threshold:.4}).search(E).map(r=>r.item):o,[o,E]).reduce((t,r)=>{const a=r.group||"Un-grouped";return t[a]||(t[a]=[]),t[a].push(r),t},{}),V=Object.keys(H).sort((t,r)=>{const a=d=>Math.min(...H[d].map(c=>o.findIndex(v=>v.id===c.id)));return a(t)-a(r)}),be=t=>{q(P===t?null:t)},je=async()=>{try{const t=await x.get("/export",s.access_token),r=jsyaml.dump(t),a=new Blob([r],{type:"text/yaml"}),d=URL.createObjectURL(a),c=document.createElement("a");c.href=d,c.download=`bookmarks_${new Date().toISOString().split("T")[0]}.yml`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(d)}catch(t){console.error("Failed to export bookmarks",t)}},ve=async()=>{try{await x.post("/update-icons",{},s.access_token),alert("Icon update started in background.")}catch(t){console.error("Failed to update icons",t),alert("Failed to start icon update.")}},ye=async t=>{const r=t.target.files?.[0];if(!r)return;const a=new FileReader;a.onload=async d=>{try{const c=d.target?.result,v=jsyaml.load(c);if(!v||!Array.isArray(v.groups))throw new Error("Invalid format: expected 'groups' array");if(confirm("This will replace ALL your current bookmarks. Continue?")){const y=await x.post("/bulk",v,s.access_token);n(y),x.post("/update-icons",{},s.access_token).catch(z=>{console.error("Failed to update icons",z)})}}catch(c){alert("Failed to upload bookmarks: "+c.message)}},a.readAsText(r),t.target.value=""},Ne=(t,r=!1)=>e.jsx("div",{"data-testid":`bookmark-row-${t.id}`,draggable:g===t.id&&M!==t.id,onDragStart:()=>pe(t.id),onDragOver:a=>he(a,t.id),onDragEnd:()=>{re(),w(null)},className:`group flex min-h-[2rem] items-center justify-between py-0 transition-colors hover:bg-slate-800/40 px-4 ${i===t.id?"bg-blue-500/10 opacity-20":""} ${g===t.id?"select-none":""}`,children:M===t.id?e.jsxs("div",{className:"flex flex-1 flex-col gap-2","data-testid":"edit-bookmark-form",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row",children:[e.jsx($,{type:"text",placeholder:"Title","data-testid":"edit-bookmark-title",variant:"small",value:l,onChange:a=>h(a.target.value),autoFocus:!0}),e.jsx($,{type:"text",placeholder:"Group","data-testid":"edit-bookmark-group",variant:"small",value:ee,onChange:a=>te(a.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("textarea",{placeholder:"URL",rows:5,"data-testid":"edit-bookmark-url",className:"min-h-[38px] flex-1 resize-none overflow-hidden rounded-lg border border-slate-700 bg-slate-950 px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none",value:G,ref:a=>{a&&(a.style.height="auto",a.style.height=a.scrollHeight+"px")},onChange:a=>{W(a.target.value),a.target.style.height="auto",a.target.style.height=a.target.scrollHeight+"px"},onFocus:a=>{a.target.select(),a.target.style.height="auto",a.target.style.height=a.target.scrollHeight+"px"}}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(b,{onClick:()=>xe(t),"data-testid":"duplicate-bookmark-button",variant:"icon",className:"text-slate-400 hover:text-blue-400",title:"Duplicate",children:e.jsx(He,{})}),e.jsx(b,{onClick:()=>ce(t.id),"data-testid":"delete-bookmark-button",variant:"icon-danger",title:"Delete",children:e.jsx(ie,{})}),e.jsx(b,{onClick:()=>R(null),"data-testid":"cancel-edit-button",variant:"icon",className:"text-slate-500 hover:text-slate-300",title:"Cancel",children:e.jsx(K,{className:"h-5 w-5"})}),e.jsx(b,{onClick:()=>me(t.id),"data-testid":"save-edit-button",variant:"icon",className:"text-blue-400 hover:text-blue-300",title:"Save",children:e.jsx(Ge,{})})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-3 flex h-4 w-4 shrink-0 items-center justify-center",children:t.icon_url?e.jsx("img",{src:`${oe}${t.icon_url}`,alt:"",className:"h-4 w-4 rounded-sm",onError:a=>{a.target.style.display="none"}}):e.jsx("div",{className:"h-1 w-1 rounded-full bg-slate-700"})}),e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",draggable:!1,"data-testid":`bookmark-link-${t.id}`,className:"mr-4 flex-1 truncate font-medium text-slate-300 transition-colors hover:text-blue-400",children:t.title}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(b,{onClick:()=>ue(t),"data-testid":`edit-bookmark-button-${t.id}`,variant:"icon",title:"Edit",children:e.jsx(Be,{})}),e.jsx("div",{className:"cursor-grab p-1 text-slate-600 transition-colors hover:text-blue-400 active:cursor-grabbing",title:"Hold to move",onMouseDown:()=>w(t.id),onMouseUp:()=>w(null),children:e.jsx(Q,{className:"h-4 w-4"})})]})]})},t.id);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col items-center justify-between gap-4 border-b border-slate-800 pb-4 md:flex-row",children:e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx($,{type:"text",placeholder:"Search bookmarks...",className:"w-full bg-slate-900 pr-4 pl-9",variant:"small",value:E,onChange:t=>se(t.target.value),"data-testid":"search-input"}),e.jsx(Oe,{className:"absolute top-1/2 left-3 -translate-y-1/2 text-slate-500"}),E&&e.jsx("button",{onClick:()=>se(""),className:"absolute top-1/2 right-3 -translate-y-1/2 text-slate-500 hover:text-white",children:e.jsx(K,{})})]})}),T&&e.jsxs("div",{className:"mb-6 rounded-xl border border-blue-500/50 bg-slate-900 p-4 shadow-lg",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-bold",children:"New Bookmark"}),e.jsx("button",{onClick:()=>B(!1),className:"text-slate-500 hover:text-white",children:e.jsx(K,{})})]}),e.jsxs("form",{onSubmit:de,className:"grid grid-cols-1 gap-3 md:grid-cols-4",children:[e.jsx($,{type:"text",placeholder:"Title",required:!0,autoFocus:!0,"data-testid":"new-bookmark-title",variant:"small",value:_,onChange:t=>D(t.target.value)}),e.jsx($,{type:"url",placeholder:"URL",required:!0,"data-testid":"new-bookmark-url",variant:"small",value:U,onChange:t=>I(t.target.value)}),e.jsx($,{type:"text",placeholder:"Group (Optional)","data-testid":"new-bookmark-group",variant:"small",value:A,onChange:t=>C(t.target.value)}),e.jsx(b,{type:"submit","data-testid":"save-bookmark-button",variant:"primary",className:"px-4 py-1.5 text-sm",children:"Save"}),O&&e.jsx("p",{className:"text-xs text-red-400 md:col-span-4",children:O})]})]}),u?e.jsx("p",{className:"text-slate-500 italic","data-testid":"loading-indicator",children:"Loading..."}):o.length===0?e.jsx("div",{className:"rounded-xl border border-slate-800 bg-slate-900 p-8 text-center text-slate-500 italic","data-testid":"no-bookmarks-message",children:"No bookmarks yet."}):e.jsx("div",{className:"space-y-1",children:V.map(t=>e.jsxs("div",{"data-testid":`group-container-${t}`,draggable:k===t,onDragStart:()=>ge(t),onDragOver:r=>fe(r,t),onDragEnd:()=>{re(),S(null)},className:`overflow-hidden rounded-sm border border-slate-800 bg-slate-900 shadow-xl transition-all ${j===t?"opacity-20":""}`,children:[t!=="Un-grouped"?e.jsxs("div",{"data-testid":`group-header-${t}`,onClick:()=>be(t),className:`flex w-full cursor-pointer items-center justify-between border-l-4 bg-slate-800/40 px-4 py-1 text-left transition-colors hover:bg-slate-800/60 ${P===t?"border-blue-500":"border-transparent"}`,children:[e.jsxs("div",{className:"flex flex-1 items-center gap-3",children:[e.jsx(Te,{className:`transition-colors ${P===t?"text-blue-400":"text-slate-500"}`}),e.jsx("span",{className:"text-lg font-bold text-slate-100",children:t}),e.jsx("span",{className:"rounded-full border border-slate-800/50 bg-slate-950/50 px-2 py-0.5 text-xs font-bold text-slate-400",children:H[t].length})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"cursor-grab p-1 text-slate-600 transition-colors hover:text-blue-400 active:cursor-grabbing",title:"Hold to move group",onMouseDown:()=>S(t),onMouseUp:()=>S(null),onClick:r=>r.stopPropagation(),children:e.jsx(Q,{className:"h-4 w-4"})})})]}):V.length>1?e.jsxs("div",{"data-testid":`group-header-${t}`,className:"flex items-center justify-between border-b border-slate-800/50 bg-slate-800/20 px-4 py-2",children:[e.jsx("span",{className:"text-xs font-bold tracking-wider text-slate-500 uppercase",children:"Other / Un-grouped"}),e.jsx("div",{className:"cursor-grab p-1 text-slate-600 transition-colors hover:text-blue-400 active:cursor-grabbing",title:"Hold to move group",onMouseDown:()=>S(t),onMouseUp:()=>S(null),children:e.jsx(Q,{className:"h-4 w-4"})})]}):null,(P===t||t==="Un-grouped"||E.trim()!=="")&&e.jsx("div",{className:"divide-y divide-slate-800/50 pl-8","data-testid":`group-content-${t}`,children:H[t].map(r=>Ne(r,t!=="Un-grouped"||V.length>1))})]},t))}),e.jsxs("div",{className:"flex w-full items-center justify-end gap-2 md:w-auto",children:[e.jsx("button",{onClick:ve,title:"Refresh icons",className:"rounded-lg p-2 text-slate-400 transition-colors hover:bg-slate-800 hover:text-white",children:e.jsx(Ve,{})}),e.jsx("button",{onClick:je,title:"Backup as YAML",className:"rounded-lg p-2 text-slate-400 transition-colors hover:bg-slate-800 hover:text-white",children:e.jsx(Me,{})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:".yaml,.yml",onChange:ye,className:"absolute inset-0 cursor-pointer opacity-0",title:"Restore from YAML"}),e.jsx("button",{className:"rounded-lg p-2 text-slate-400 transition-colors hover:bg-slate-800 hover:text-white",children:e.jsx(Pe,{})})]}),!T&&e.jsxs(b,{onClick:()=>B(!0),"data-testid":"add-bookmark-button",variant:"primary",className:"flex items-center gap-1.5 px-3 py-1.5 text-sm",children:[e.jsx(qe,{}),"Add"]})]})]})},Ye=({auth:s})=>{const[o,n]=React.useState([]),[u,p]=React.useState(!0),[i,m]=React.useState(null),[g,w]=React.useState(""),[j,f]=React.useState(""),[k,S]=React.useState(""),[_,D]=React.useState(""),[U,I]=React.useState("user"),[A,C]=React.useState(null),O=async()=>{try{const l=await x.get("/admin/users",s.access_token);n(l)}catch(l){console.error("Failed to fetch users",l)}finally{p(!1)}};React.useEffect(()=>{O()},[s]);const F=()=>{m(null),w(""),f(""),S(""),D(""),I("user"),C(null)},T=l=>{m(l),w(l.email),f(""),S(l.first_name??""),D(l.last_name??""),I(l.role),C(null)},B=async l=>{l.preventDefault(),C(null);try{if(i){const h=await x.put(`/admin/users/${i.id}`,{email:g,password:j||void 0,role:U,first_name:k,last_name:_},s.access_token);n(o.map(G=>G.id===i.id?h:G)),F()}else{const h=await x.post("/admin/users",{email:g,password:j,role:U,first_name:k,last_name:_},s.access_token);n([...o,h]),F()}}catch(h){C(h.detail||`Failed to ${i?"update":"add"} user`)}},M=async l=>{if(l===s.user.id){alert("You cannot delete yourself.");return}if(confirm("Are you sure you want to delete this user? All their bookmarks will be lost."))try{await x.delete(`/admin/users/${l}`,s.access_token),n(o.filter(h=>h.id!==l))}catch(h){console.error("Failed to delete user",h)}},R=l=>l?new Date(l).toLocaleString():"-";return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-900 p-6 shadow-lg",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:i?"Edit User":"Add New User"}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 items-end gap-4 md:grid-cols-4",children:[e.jsx(L,{label:"Email",htmlFor:"user-email",type:"email",required:!0,"data-testid":"admin-add-user-email",value:g,onChange:l=>w(l.target.value)}),e.jsx(L,{label:"Password",htmlFor:"user-password",hint:i?"(leave blank to keep current)":"",type:"password",required:!i,"data-testid":"admin-add-user-password",value:j,onChange:l=>f(l.target.value)}),e.jsx(L,{label:"First Name",htmlFor:"user-first-name",type:"text",required:!0,"data-testid":"admin-add-user-first-name",value:k,onChange:l=>S(l.target.value)}),e.jsx(L,{label:"Last Name",htmlFor:"user-last-name",type:"text",required:!0,"data-testid":"admin-add-user-last-name",value:_,onChange:l=>D(l.target.value)})]}),e.jsxs("div",{className:"flex items-end justify-end gap-4",children:[e.jsxs("div",{className:"w-1/4",children:[e.jsx("label",{htmlFor:"user-role",className:"mb-1 block text-sm text-slate-400",children:"Role"}),e.jsxs(ne,{id:"user-role","data-testid":"admin-add-user-role",value:U,onChange:l=>I(l.target.value),children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),i&&e.jsx(b,{type:"button",onClick:F,variant:"secondary",children:"Cancel"}),e.jsx(b,{type:"submit","data-testid":"admin-add-user-submit",variant:"primary",className:"h-[42px]",children:i?"Update User":"Create User"})]})]}),A&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:A})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"mb-4 text-2xl font-bold",children:"User Management"}),u?e.jsx("p",{children:"Loading..."}):e.jsx("div",{className:"overflow-x-auto rounded-xl border border-slate-800 bg-slate-900",children:e.jsxs("table",{className:"w-full text-left whitespace-nowrap",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-800 bg-slate-800/50",children:[e.jsx("th",{className:"px-6 py-3 text-sm font-bold uppercase",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-sm font-bold uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-sm font-bold uppercase",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-sm font-bold uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-sm font-bold uppercase",children:"Last Login"}),e.jsx("th",{className:"px-6 py-3 text-sm font-bold uppercase",children:"Updated At"}),e.jsx("th",{className:"px-6 py-3 text-right text-sm font-bold uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-800",children:o.map(l=>e.jsxs("tr",{onClick:()=>T(l),className:`cursor-pointer transition-colors ${i?.id===l.id?"bg-blue-500/10 hover:bg-blue-500/20":"hover:bg-slate-800/30"}`,children:[e.jsx("td",{className:"px-6 py-4 font-mono text-sm text-slate-400",children:l.id}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-100",children:l.email}),(l.first_name||l.last_name)&&e.jsxs("span",{className:"text-xs text-slate-500",children:[l.first_name||""," ",l.last_name||""]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`rounded px-2 py-0.5 text-[10px] font-black tracking-wider uppercase ${l.role==="admin"?"border border-purple-500/20 bg-purple-500/10 text-purple-400":"border border-blue-500/20 bg-blue-500/10 text-blue-400"}`,children:l.role})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`flex items-center gap-1.5 text-xs font-medium ${l.is_active?"text-emerald-400":"text-rose-400"}`,children:[e.jsx("span",{className:`h-1.5 w-1.5 rounded-full ${l.is_active?"animate-pulse bg-emerald-500":"bg-rose-500"}`}),l.is_active?"Active":"Deactivated"]})}),e.jsx("td",{className:"px-6 py-4 font-mono text-xs text-slate-400",children:R(l.last_login_at)}),e.jsx("td",{className:"px-6 py-4 font-mono text-xs text-slate-400",children:R(l.updated_at)}),e.jsx("td",{className:"px-6 py-4 text-right",children:l.id!==s.user.id&&e.jsx(b,{onClick:h=>{h.stopPropagation(),M(l.id)},variant:"danger",title:"Delete User",children:e.jsx(ie,{})})})]},l.id))})]})})]})]})},Xe=()=>{const[s,o]=React.useState("login"),[n,u]=React.useState(null);React.useEffect(()=>{const m=localStorage.getItem("bookmarks_auth");if(m)try{const g=JSON.parse(m);u(g),o("dashboard")}catch{localStorage.removeItem("bookmarks_auth")}},[]);const p=()=>{u(null),localStorage.removeItem("bookmarks_auth"),o("login")},i=m=>{u(m),localStorage.setItem("bookmarks_auth",JSON.stringify(m)),o("dashboard")};return e.jsxs("div",{className:"flex min-h-screen flex-col bg-slate-950 text-slate-100",children:[e.jsx("header",{className:"sticky top-0 z-10 border-b border-slate-800 bg-slate-900/50 backdrop-blur-md",children:e.jsxs("div",{className:"mx-auto flex h-16 max-w-6xl items-center justify-between px-4",children:[e.jsx("div",{className:"flex items-center gap-6",children:e.jsxs("div",{className:"flex cursor-pointer items-center gap-2",onClick:()=>o(n?"dashboard":"login"),children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-blue-600 font-bold",children:"B"}),e.jsx("span",{className:"hidden text-xl font-bold tracking-tight md:inline",children:"Bookmarks"})]})}),e.jsx("nav",{className:"flex items-center gap-4",children:n&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm text-slate-400 md:inline",children:[n.user.first_name," ",n.user.last_name]}),n.user.role==="admin"&&e.jsx("button",{onClick:()=>o(s==="admin"?"dashboard":"admin"),className:`rounded-full px-3 py-1 text-sm font-medium transition-all ${s==="admin"?"text-slate-300 hover:bg-slate-800 hover:text-white":"bg-slate-600 text-white shadow-lg shadow-slate-900/20"}`,children:s==="admin"?"My Dashboard":"Manage Users"}),e.jsx("button",{onClick:p,className:"text-sm font-medium text-slate-300 transition-colors hover:text-white",children:"Logout"})]})})]})}),e.jsxs("main",{className:"mx-auto w-full max-w-6xl flex-1 px-4 py-8",children:[s==="login"&&e.jsx(ze,{onLogin:i}),s==="dashboard"&&n&&e.jsx(Je,{auth:n}),s==="admin"&&n&&n.user.role==="admin"&&e.jsx(Ye,{auth:n})]})]})};ReactDOM.createRoot(document.getElementById("root")).render(e.jsx(React.StrictMode,{children:e.jsx(Xe,{})}));
