import"./modulepreload-polyfill-B5Qt9EMX.js";import{r as a,j as e,R as ot,a as nt}from"./client-BsyqJ1xH.js";import{B as O}from"./button-BZSrPANe.js";import{A as Be}from"./api-CH_Pe6Vg.js";const ue="todo.jwt",fe=o=>{if(!o)return null;if(typeof o=="string"){const n=o.trim();return n||null}if(Array.isArray(o)){for(const n of o){const c=fe(n);if(c)return c}return null}if(typeof o=="object"){const n=o;if("detail"in n){const d=fe(n.detail);if(d)return d}if(typeof n.msg=="string"){const d=n.msg.trim();if(d)return d}if(typeof n.message=="string"){const d=n.message.trim();if(d)return d}const c=Object.values(n).find(d=>typeof d=="string"&&!!d.trim());return c?c.trim():null}return null},lt=()=>{const o=a.useMemo(()=>`${Be}/auth`,[]),[n,c]=a.useState(()=>typeof window>"u"?null:window.localStorage.getItem(ue)),[d,w]=a.useState(null),[F,L]=a.useState(!1),[N,b]=a.useState(null),[Y,H]=a.useState(!1),p=a.useCallback(u=>{c(u),!(typeof window>"u")&&(u?window.localStorage.setItem(ue,u):window.localStorage.removeItem(ue))},[]),j=a.useCallback(u=>{b(u||null),p(null),w(null)},[p]),A=a.useCallback(async u=>{const x=await fetch(`${o}/me`,{headers:{Authorization:`Bearer ${u}`}});if(!x.ok)throw new Error(x.status===401?"Session expired. Please log in again.":"Unable to load profile.");const g=await x.json();w({id:g.id,email:g.email}),b(null)},[o]);a.useEffect(()=>{if(!n){w(null),L(!0);return}L(!1),A(n).catch(u=>{const x=u instanceof Error?u.message:"Session expired.";j(x)}).finally(()=>{L(!0)})},[j,A,n]);const _=a.useCallback(async(u,x)=>{H(!0),b(null);try{const g=await fetch(`${o}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,password:x})});if(!g.ok){const C=await g.json().catch(()=>null),re=fe(C)??"Invalid credentials";throw new Error(re)}const S=await g.json();p(S.access_token),await A(S.access_token)}catch(g){const S=g instanceof Error?g.message:"Unable to log in.";throw j(S),new Error(S)}finally{H(!1)}},[o,j,A,p]),T=a.useCallback(()=>{j()},[j]),v=a.useCallback(async(u,x)=>{if(!n)throw new Error("Not authenticated");const g=new Headers(x?.headers);g.set("Authorization",`Bearer ${n}`);const S=await fetch(u,{...x,headers:g});if(S.status===401)throw j("Session expired. Please log in again."),new Error("Session expired. Please log in again.");return S},[j,n]),U=a.useCallback(()=>b(null),[]);return{user:d,token:n,ready:F,isAuthenticated:!!(d&&n),login:_,logout:T,authenticatedFetch:v,sessionError:N,clearSessionError:U,loginPending:Y}},rt=o=>o.toISOString().split("T")[0],me=()=>{const o=rt(new Date);return{name:"",description:"",startDate:o,dueDate:o,category:"",isCompleted:!1}},V=o=>{const n=o.slice(0,10),[c,d,w]=n.split("-"),F=Number(c),L=Number(d),N=Number(w);if([F,L,N].some(b=>Number.isNaN(b))){const b=new Date(o);return b.setHours(0,0,0,0),b}return new Date(F,L-1,N)},pe=()=>{const o=new Date;return o.setHours(0,0,0,0),o},it=1440*60*1e3,ct=o=>({name:o.name,description:o.description,startDate:o.start_date,dueDate:o.due_date,category:o.category,isCompleted:o.is_completed}),I=`${Be}/tasks`,Oe="NONE",Me="todoLastLoginEmail",he=()=>{if(typeof window>"u")return"";try{return window.localStorage.getItem(Me)??""}catch{return""}},dt=o=>{if(typeof window>"u")return;const n=o.trim();if(n)try{window.localStorage.setItem(Me,n)}catch{}},Ie=o=>{const n=V(o);return Number.isNaN(n.valueOf())?o:new Intl.DateTimeFormat(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}).format(n)},Ue=(o,n=!1)=>{if(n)return!1;const c=pe(),d=V(o);return d.setHours(0,0,0,0),d<c},ut=o=>{const n=V(o);if(Number.isNaN(n.valueOf()))return 0;n.setHours(0,0,0,0);const c=pe();return Math.round((n.getTime()-c.getTime())/it)},mt=o=>o>0?`+${o}d`:`${o}d`,Pe=o=>o.trim().toUpperCase().replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,""),_e=o=>{const n=pe(),c=V(o);return c.setHours(0,0,0,0),c.getTime()<=n.getTime()},ge=o=>o.is_completed?{label:"Completed",modifier:"todo-status--completed"}:_e(o.start_date)?{label:"Active",modifier:"todo-status--active"}:{label:"Blocked",modifier:"todo-status--blocked"},ht=()=>{const[o,n]=a.useState([]),[c,d]=a.useState(me),[w,F]=a.useState(!0),[L,N]=a.useState(null),[b,Y]=a.useState(!1),[H,p]=a.useState(null),[j,A]=a.useState(null),[_,T]=a.useState([]),[v,U]=a.useState(null),[u,x]=a.useState(!1),[g,S]=a.useState(!1),[C,re]=a.useState({key:"due_date",direction:"asc"}),[J,W]=a.useState(()=>new Set),[Z,be]=a.useState(!1),[ye,K]=a.useState(null),[q,ie]=a.useState(!1),[P,xe]=a.useState({label:"",slug:""}),[je,ve]=a.useState(!1),[ke,we]=a.useState(!1),[Ne,E]=a.useState(null),{user:ze,ready:Q,isAuthenticated:f,login:Se,logout:Ce,authenticatedFetch:k,sessionError:Ee,clearSessionError:X,loginPending:De}=lt(),[Le,G]=a.useState(!1),[B,ee]=a.useState(()=>({email:he(),password:""})),[te,se]=a.useState(null),D=a.useCallback(()=>{se(null),X()},[X]),Te=a.useCallback((t,s)=>{ee(l=>({...l,[t]:s})),te&&se(null),X()},[X,te]),ce=a.useMemo(()=>{const t=o.filter(r=>!r.is_completed),s=t.filter(r=>Ue(r.due_date,r.is_completed)).length,l=t.filter(r=>_e(r.start_date)).length,i=t.filter(r=>!_e(r.start_date)).length;return{overdue:s,ready:l,blocked:i,total:o.length}},[o]),Fe=a.useMemo(()=>o.filter(t=>{const s=ge(t).label;return!(!u&&s==="Blocked"||!g&&s==="Completed")}),[o,u,g]),M=a.useCallback(async()=>{if(!f){n([]),F(!1),A(null),N("Log in to view your tasks.");return}F(!0),N(null);try{const l=(await(await k(`${I}/?limit=100`)).json()).map(i=>({...i,category:i.category??"",is_completed:!!i.is_completed}));n(l),A(new Date)}catch(t){const s=t instanceof Error?t.message:"Unable to load tasks.";N(s)}finally{F(!1)}},[k,f]);a.useEffect(()=>{Q&&M()},[Q,M]);const ae=a.useCallback(async()=>{if(!f){T([]);return}try{const t=await k(`${I}/categories`);if(!t.ok)throw new Error("Unable to load categories");const s=await t.json();T(s)}catch{T([])}},[k,f]);a.useEffect(()=>{Q&&ae()},[Q,ae]);const He=a.useCallback(async t=>{t.preventDefault(),D();const s=B.email.trim(),l=B.password;if(!s||!l){se("Enter email and password.");return}dt(s);const i=s.toLowerCase();try{await Se(i,l),G(!1),ee({email:s,password:""}),N(null),M(),ae()}catch(r){const h=r instanceof Error?r.message:"Unable to log in.";se(h)}},[ae,M,Se,B.email,B.password,D]),Ke=a.useCallback(()=>{Ce(),n([]),T([]),d(me()),U(null),W(new Set),N("Log in to view your tasks."),G(!1),D()},[Ce,D]),qe=a.useCallback(()=>{D(),G(!0)},[D]),Ge=a.useCallback(()=>{D(),G(!1)},[D]);a.useEffect(()=>{const t=he();t&&ee(s=>s.email?s:{...s,email:t})},[]),a.useEffect(()=>{f&&(G(!1),ee(t=>({email:t.email||he(),password:""})),D())},[f,D]),a.useEffect(()=>{f||ie(!1)},[f]),a.useEffect(()=>{W(t=>{if(t.size===0)return t;const s=new Set(o.map(r=>r.id));let l=!1;const i=new Set;return t.forEach(r=>{s.has(r)?i.add(r):l=!0}),l?i:t})},[o]);const de=a.useCallback(()=>{const t=me(),s=_[0]?.value;return s?{...t,category:s}:t},[_]);a.useEffect(()=>{_.length!==0&&d(t=>t.category&&_.some(s=>s.value===t.category)?t:{...t,category:_[0].value})},[_]);const oe=a.useMemo(()=>_.reduce((t,s)=>(t[s.value]=s.label,t),{}),[_]),Ve=a.useMemo(()=>{const t=[...Fe],s=r=>{const h=V(r).getTime();return Number.isNaN(h)?0:h},l={Blocked:0,Active:1,Completed:2},i=r=>{switch(C.key){case"start_date":return s(r.start_date);case"due_date":return s(r.due_date);case"status":return l[ge(r).label]??0;case"category":default:return(oe[r.category]??r.category??"").toLowerCase()}};return t.sort((r,h)=>{const m=i(r),y=i(h);if(typeof m=="number"&&typeof y=="number")return m===y?r.id-h.id:C.direction==="asc"?m-y:y-m;const $=m.toString(),z=y.toString();return $===z?r.id-h.id:C.direction==="asc"?$.localeCompare(z,void 0,{sensitivity:"base"}):z.localeCompare($,void 0,{sensitivity:"base"})})},[oe,C,Fe]),R=(t,s)=>{d(l=>({...l,[t]:s}))},Ye=async t=>{t.preventDefault(),p(null);const s=c.name.trim(),l=c.description.trim();if(!s){p("Please provide a name.");return}if(!c.category){p("Select a category for this task.");return}if(c.startDate>c.dueDate){p("Start date must be on or before the due date.");return}if(!f){p("Log in to manage tasks.");return}const i=v!==null,r=i?`${I}/${v}`:`${I}/`,h=i?"PUT":"POST";Y(!0);try{const m=await k(r,{method:h,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s,description:l,start_date:c.startDate,due_date:c.dueDate,category:c.category,is_completed:c.isCompleted})});if(!m.ok)throw new Error("Failed to save the task");const y=await m.json();n($=>i?$.map(z=>z.id===y.id?y:z):[y,...$]),d(de()),U(null),p(i?"Task updated":"Task saved")}catch(m){const y=m instanceof Error?m.message:"Unexpected error";p(y)}finally{Y(!1)}},$e=a.useCallback(t=>{d(ct(t)),U(t.id),p(null)},[]),Je=a.useCallback(()=>{d(de()),U(null),p(null)},[de]),We=t=>{re(s=>s.key===t?{key:t,direction:s.direction==="asc"?"desc":"asc"}:{key:t,direction:"asc"})},ne=t=>C.key!==t?"none":C.direction==="asc"?"ascending":"descending",le=(t,s)=>{const l=C.key===t?C.direction:null,i=l?`Sort by ${s} (${l==="asc"?"ascending":"descending"})`:`Sort by ${s}`;return e.jsxs("button",{type:"button",className:"todo-table__sort",onClick:()=>We(t),"aria-label":i,children:[e.jsx("span",{children:s}),e.jsx("span",{className:"todo-table__sort-icon","aria-hidden":"true",children:l?l==="asc"?"↑":"↓":"↕"})]})},Ze=a.useCallback((t,s)=>{W(l=>{const i=new Set(l);return s?i.add(t):i.delete(t),i})},[]),Qe=a.useCallback(async()=>{const t=Array.from(J);if(t.length===0||Z){K(t.length===0?"Select at least one task to delete.":null);return}if(!f){K("Log in to delete tasks.");return}be(!0),K(null);const s=new Set(t);try{await Promise.all(t.map(async l=>{if(!(await k(`${I}/${l}`,{method:"DELETE"})).ok)throw new Error("Unable to delete selected tasks.")})),n(l=>l.filter(i=>!s.has(i.id))),W(new Set),K(t.length===1?"Deleted 1 task.":`Deleted ${t.length} tasks.`)}catch(l){const i=l instanceof Error?l.message:"Failed to delete selected tasks.";K(i)}finally{be(!1)}},[k,Z,f,J]),Xe=(t,s)=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),$e(s))},et=J.size,Ae=a.useCallback((t,s)=>{xe(l=>t==="label"&&!je?{label:s,slug:Pe(s)}:{...l,[t]:s}),t==="slug"&&ve(!0),E(null)},[je]),tt=a.useCallback(async t=>{t.preventDefault();const s=P.label.trim(),l=P.slug||s,i=Pe(l);if(!s||!i){E("Provide both a label and a slug.");return}if(_.some(r=>r.value===i)){E("That slug already exists.");return}if(!f){E("Log in to manage categories.");return}we(!0),E(null);try{const r=await k(`${I}/categories`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:i,label:s})});if(!r.ok)throw new Error("Unable to add category.");const h=await r.json();T(m=>[...m,h].sort((y,$)=>y.label.localeCompare($.label))),xe({label:"",slug:""}),ve(!1),E("Category added.")}catch(r){const h=r instanceof Error?r.message:"Failed to add category.";E(h)}finally{we(!1)}},[k,P.label,P.slug,_,f]),st=a.useCallback(async t=>{if(!(!t||t===Oe)){if(!f){E("Log in to manage categories.");return}try{if(!(await k(`${I}/categories/${t}`,{method:"DELETE"})).ok)throw new Error("Unable to delete category.");T(l=>l.filter(i=>i.value!==t)),E("Category removed.")}catch(s){const l=s instanceof Error?s.message:"Failed to delete category.";E(l)}}},[k,f,T]),at=a.useMemo(()=>{if(typeof window>"u")return"/users/";const{pathname:t,search:s,hash:l}=window.location;if(!t)return"/users/";const i=`${t}${s||""}${l||""}`;return i?`/users/?back=${encodeURIComponent(i)}`:"/users/"},[]);return e.jsxs("div",{className:"todo-app",children:[e.jsxs("nav",{className:"todo-nav","aria-label":"Primary navigation",children:[e.jsx("div",{className:"todo-nav__logo",children:"To Do list"}),e.jsxs("ul",{className:"todo-nav__menu",children:[e.jsx("li",{className:"todo-nav__item",children:e.jsx("button",{type:"button",className:`todo-nav__link todo-nav__link--button${q?"":" todo-nav__link--active"}`,"aria-pressed":!q,onClick:()=>ie(!1),children:"Tasks"})}),e.jsx("li",{className:"todo-nav__item",children:e.jsx("button",{type:"button",className:`todo-nav__link todo-nav__link--button${q?" todo-nav__link--active":""}`,"aria-pressed":q,onClick:()=>ie(t=>!t),children:"Manage categories"})})]}),e.jsx("div",{className:"todo-nav__auth",children:f?e.jsxs("div",{className:"todo-nav__user",children:[e.jsx("div",{className:"todo-nav__user-details",children:e.jsx("span",{className:"todo-nav__user-email",children:ze?.email})}),e.jsx("button",{type:"button",className:"todo-nav__logout",onClick:Ke,children:"Logout"})]}):e.jsxs("div",{className:"todo-nav__login",children:[Le?e.jsxs("form",{className:"todo-nav__login-form",onSubmit:He,children:[e.jsxs("label",{className:"todo-nav__login-field",children:[e.jsx("span",{children:"Email"}),e.jsx("input",{type:"email",value:B.email,onChange:t=>Te("email",t.target.value),autoComplete:"email",required:!0})]}),e.jsxs("label",{className:"todo-nav__login-field",children:[e.jsx("span",{children:"Password"}),e.jsx("input",{type:"password",value:B.password,onChange:t=>Te("password",t.target.value),autoComplete:"current-password",required:!0})]}),e.jsxs("div",{className:"todo-nav__login-actions",children:[e.jsx("button",{type:"submit",className:"todo-nav__login-submit",disabled:De,children:De?"Signing in…":"Sign in"}),e.jsx("button",{type:"button",className:"todo-nav__login-cancel",onClick:Ge,children:"Cancel"})]})]}):e.jsx("button",{type:"button",className:"todo-nav__link todo-nav__link--button",onClick:qe,children:"Login"}),!Le&&e.jsx("a",{className:"todo-nav__register-link",href:at,children:"Register"}),(te||Ee)&&e.jsx("p",{className:"todo-nav__feedback",role:"status",children:te??Ee})]})})]}),f?q?e.jsx("section",{className:"todo-categories","aria-label":"Category manager",children:e.jsxs("div",{className:"todo-categories__panel",children:[e.jsx("div",{children:e.jsx("h3",{children:"Manage categories"})}),e.jsxs("form",{className:"todo-categories__form",onSubmit:tt,children:[e.jsxs("label",{className:"todo-categories__field",children:[e.jsx("span",{children:"Category label"}),e.jsx("input",{type:"text",value:P.label,onChange:t=>Ae("label",t.target.value),placeholder:"can include spaces",required:!0})]}),e.jsxs("label",{className:"todo-categories__field",children:[e.jsx("span",{children:"Category slug"}),e.jsx("input",{type:"text",value:P.slug,onChange:t=>Ae("slug",t.target.value),placeholder:"DESIGN",required:!0})]}),e.jsx(O,{type:"submit",className:"todo-button todo-button--primary",disabled:ke,children:ke?"Adding…":"Add category"})]}),e.jsx("ul",{className:"todo-categories__list",children:_.map(t=>e.jsxs("li",{className:"todo-categories__item",children:[e.jsxs("span",{children:[e.jsx("strong",{children:t.label})," ",e.jsx("small",{children:t.value})]}),e.jsx(O,{type:"button",variant:"outline",className:"todo-button todo-button--danger-solid",onClick:()=>void st(t.value),disabled:t.value===Oe,children:"Delete"})]},t.value))}),Ne?e.jsx("p",{className:"todo-categories__feedback",children:Ne}):null]})}):e.jsx(e.Fragment,{children:e.jsxs("main",{className:"todo-app__layout",children:[e.jsxs("section",{className:"todo-form","aria-labelledby":"todo-form-title",children:[e.jsxs("div",{className:"todo-form__header",children:[e.jsxs("div",{children:[e.jsx("p",{className:"todo-form__eyebrow",children:v?"Edit":"Create"}),e.jsx("h2",{id:"todo-form-title",children:v?"Update task":"New task"})]}),e.jsx("div",{className:"todo-form__header-actions",children:e.jsx(O,{type:"button",variant:"outline",className:"todo-button todo-button--outline",onClick:()=>void M(),disabled:w,children:w?"Syncing…":"Refresh"})})]}),v?e.jsxs("p",{className:"todo-form__notice",children:["Editing task #",v]}):null,e.jsxs("form",{className:"todo-form__body",onSubmit:Ye,children:[e.jsxs("label",{className:"todo-form__field",htmlFor:"task-name",children:[e.jsx("span",{children:"Name"}),e.jsx("input",{id:"task-name",type:"text",value:c.name,onChange:t=>R("name",t.target.value),placeholder:"Write the task title",required:!0})]}),e.jsxs("label",{className:"todo-form__field",htmlFor:"task-description",children:[e.jsxs("span",{children:["Description ",e.jsx("span",{className:"todo-form__optional",children:"(optional)"})]}),e.jsx("textarea",{id:"task-description",value:c.description,onChange:t=>R("description",t.target.value),rows:3})]}),e.jsxs("div",{className:"todo-form__grid",children:[e.jsxs("label",{className:"todo-form__field",htmlFor:"task-start",children:[e.jsx("span",{children:"Start date"}),e.jsx("input",{id:"task-start",type:"date",value:c.startDate,onChange:t=>R("startDate",t.target.value)})]}),e.jsxs("label",{className:"todo-form__field",htmlFor:"task-due",children:[e.jsx("span",{children:"Due date"}),e.jsx("input",{id:"task-due",type:"date",value:c.dueDate,onChange:t=>R("dueDate",t.target.value)})]})]}),e.jsxs("label",{className:"todo-form__field",htmlFor:"task-category",children:[e.jsx("span",{children:"Category"}),e.jsx("select",{id:"task-category",value:c.category,onChange:t=>R("category",t.target.value),children:_.length===0?e.jsx("option",{value:c.category,children:oe[c.category]??c.category}):_.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("label",{className:"todo-form__field todo-form__field--inline",htmlFor:"task-completed",children:[e.jsxs("div",{children:[e.jsx("span",{children:"Status"}),e.jsx("p",{children:"Is the task complete?"})]}),e.jsx("input",{id:"task-completed",type:"checkbox",checked:c.isCompleted,onChange:t=>R("isCompleted",t.target.checked)})]}),e.jsxs("div",{className:"todo-form__actions",children:[e.jsx(O,{type:"button",variant:"outline",className:"todo-button todo-button--outline",onClick:Je,children:v?"Cancel edit":"Clear"}),e.jsx(O,{type:"submit",className:"todo-button todo-button--primary",disabled:b,children:b?"Saving…":v?"Save changes":"Save"})]}),H?e.jsx("p",{className:"todo-form__feedback",children:H}):null]})]}),e.jsxs("section",{className:"todo-list","aria-live":"polite","aria-busy":w,children:[e.jsx("header",{className:"todo-list__header",children:e.jsxs("div",{className:"todo-list__header-actions",children:[e.jsxs("label",{className:"todo-list__toggle",htmlFor:"toggle-show-blocked",children:[e.jsxs("div",{className:"todo-list__toggle-copy",children:[e.jsx("span",{children:"Show blocked tasks"}),e.jsx("p",{children:"Tasks that cannot be started yet"})]}),e.jsx("input",{id:"toggle-show-blocked",type:"checkbox",role:"switch","aria-checked":u,checked:u,onChange:t=>x(t.target.checked)})]}),e.jsxs("label",{className:"todo-list__toggle",htmlFor:"toggle-show-completed",children:[e.jsxs("div",{className:"todo-list__toggle-copy",children:[e.jsx("span",{children:"Show completed tasks"}),e.jsx("p",{children:"Tasks done"})]}),e.jsx("input",{id:"toggle-show-completed",type:"checkbox",role:"switch","aria-checked":g,checked:g,onChange:t=>S(t.target.checked)})]}),e.jsxs("dl",{className:"todo-list__stats",children:[e.jsxs("div",{className:"todo-list__stats-item todo-list__stats-item--blocked",children:[e.jsx("dt",{children:"Blocked"}),e.jsx("dd",{children:ce.blocked})]}),e.jsxs("div",{className:"todo-list__stats-item todo-list__stats-item--active",children:[e.jsx("dt",{children:"Active"}),e.jsx("dd",{children:ce.ready})]}),e.jsxs("div",{className:"todo-list__stats-item todo-list__stats-item--overdue",children:[e.jsx("dt",{children:"Overdue"}),e.jsx("dd",{children:ce.overdue})]})]}),e.jsx(O,{type:"button",variant:"outline",className:"todo-button todo-button--danger",onClick:()=>void Qe(),disabled:Z||et===0,children:Z?"Deleting…":"Delete selected"}),ye?e.jsx("p",{className:"todo-list__feedback",role:"status",children:ye}):null]})}),w?e.jsx("p",{className:"todo-list__status",children:"Loading tasks…"}):L?e.jsxs("div",{className:"todo-list__status todo-list__status--error",children:[e.jsx("p",{children:L}),e.jsx(O,{type:"button",size:"sm",className:"todo-button todo-button--outline todo-button--compact",onClick:()=>void M(),children:"Try again"})]}):o.length===0?e.jsx("div",{className:"todo-list__status",children:e.jsx("p",{children:"No tasks yet. Save your first task on the left."})}):e.jsx("div",{className:"todo-list__table-wrapper",children:e.jsxs("table",{className:"todo-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"todo-table__select-header",children:"Select"}),e.jsx("th",{scope:"col","aria-sort":ne("status"),children:le("status","Status")}),e.jsx("th",{scope:"col",children:"Task"}),e.jsx("th",{scope:"col","aria-sort":ne("category"),children:le("category","Category")}),e.jsx("th",{scope:"col",children:"Days left"}),e.jsx("th",{scope:"col","aria-sort":ne("start_date"),children:le("start_date","Start date")}),e.jsx("th",{scope:"col","aria-sort":ne("due_date"),children:le("due_date","Due date")})]})}),e.jsx("tbody",{children:Ve.map(t=>{const s=ge(t),l=`todo-status${s.modifier?` ${s.modifier}`:""}`,i=ut(t.due_date),r=["todo-table__due-offset"];i<0?r.push("todo-table__due-offset--overdue"):i===0?r.push("todo-table__due-offset--today"):r.push("todo-table__due-offset--upcoming");const h=["todo-table__row"];return Ue(t.due_date,t.is_completed)&&h.push("todo-table__row--overdue"),v===t.id&&h.push("todo-table__row--selected"),e.jsxs("tr",{className:h.join(" "),onClick:()=>$e(t),onKeyDown:m=>Xe(m,t),tabIndex:0,children:[e.jsx("td",{className:"todo-table__cell todo-table__cell--select",children:e.jsx("input",{type:"checkbox",className:"todo-table__select-input","aria-label":`Select task ${t.name}`,checked:J.has(t.id),onChange:m=>Ze(t.id,m.target.checked),onClick:m=>m.stopPropagation()})}),e.jsx("td",{className:"todo-table__cell todo-table__cell--status",children:e.jsx("span",{className:l,children:s.label})}),e.jsx("td",{className:"todo-table__cell todo-table__task",children:e.jsx("span",{className:"todo-table__task-name",children:t.name})}),e.jsx("td",{className:"todo-table__cell",children:e.jsx("span",{className:"todo-table__chip",children:oe[t.category]??(t.category||"Uncategorized")})}),e.jsx("td",{className:"todo-table__cell todo-table__cell--due-offset",children:e.jsx("span",{className:r.join(" "),children:mt(i)})}),e.jsx("td",{className:"todo-table__cell todo-table__cell--date",children:Ie(t.start_date)}),e.jsx("td",{className:"todo-table__cell todo-table__cell--date",children:e.jsx("span",{className:"todo-table__date-value",children:Ie(t.due_date)})})]},t.id)})})]})}),j?e.jsxs("p",{className:"todo-list__synced",children:["Last synced ",j.toLocaleTimeString()]}):null]})]})}):e.jsx("section",{className:"todo-empty","aria-live":"polite",children:e.jsxs("div",{className:"todo-empty__panel",children:[e.jsx("h3",{children:"Welcome"}),e.jsx("p",{children:"Use the Login button above to access and manage your personal task board."})]})})]})},Re=document.getElementById("root");if(!Re)throw new Error("Root element #root not found");ot.createRoot(Re).render(e.jsx(nt.StrictMode,{children:e.jsx(ht,{})}));
