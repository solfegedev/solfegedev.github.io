import"./index-CFIGRAx0.js";import{j as c}from"./jsx-runtime-u17CrQMm.js";import{c as M,C as q,a as ht}from"./copy-CErERVML.js";const pt=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],xt=M("key",pt);const mt=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],yt=M("lock",mt);const bt=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],z=M("refresh-cw",bt);const nt={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,h:8n,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p:w,n:X,Gx:W,Gy:J,a:L,d:G,h:gt}=nt,Y=32,ot=64,wt=(...t)=>{"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(...t)},g=(t="")=>{const e=new Error(t);throw wt(e,g),e},vt=t=>typeof t=="bigint",Nt=t=>typeof t=="string",jt=t=>t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array",C=(t,e,s="")=>{const n=jt(t),a=t?.length,r=e!==void 0;if(!n||r&&a!==e){const i=s&&`"${s}" `,f=r?` of length ${e}`:"",l=n?`length=${a}`:`type=${typeof t}`;g(i+"expected Uint8Array"+f+", got "+l)}return t},I=t=>new Uint8Array(t),rt=t=>Uint8Array.from(t),at=(t,e)=>t.toString(16).padStart(e,"0"),ct=t=>Array.from(C(t)).map(e=>at(e,2)).join(""),k={_0:48,_9:57,A:65,F:70,a:97,f:102},Q=t=>{if(t>=k._0&&t<=k._9)return t-k._0;if(t>=k.A&&t<=k.F)return t-(k.A-10);if(t>=k.a&&t<=k.f)return t-(k.a-10)},it=t=>{const e="hex invalid";if(!Nt(t))return g(e);const s=t.length,n=s/2;if(s%2)return g(e);const a=I(n);for(let r=0,i=0;r<n;r++,i+=2){const f=Q(t.charCodeAt(i)),l=Q(t.charCodeAt(i+1));if(f===void 0||l===void 0)return g(e);a[r]=f*16+l}return a},kt=()=>globalThis?.crypto,At=()=>kt()?.subtle??g("crypto.subtle must be defined, consider polyfill"),lt=(...t)=>{const e=I(t.reduce((n,a)=>n+C(a).length,0));let s=0;return t.forEach(n=>{e.set(n,s),s+=n.length}),e},P=BigInt,E=(t,e,s,n="bad number: out of range")=>vt(t)&&e<=t&&t<s?t:g(n),o=(t,e=w)=>{const s=t%e;return s>=0n?s:e+s},Bt=t=>o(t,X),Et=(t,e)=>{(t===0n||e<=0n)&&g("no inverse n="+t+" mod="+e);let s=o(t,e),n=e,a=0n,r=1n;for(;s!==0n;){const i=n/s,f=n%s,l=a-r*i;n=s,s=f,a=r,r=l}return n===1n?o(a,e):g("no inverse")},D=t=>t instanceof N?t:g("Point expected"),O=2n**256n;class N{static BASE;static ZERO;X;Y;Z;T;constructor(e,s,n,a){const r=O;this.X=E(e,0n,r),this.Y=E(s,0n,r),this.Z=E(n,1n,r),this.T=E(a,0n,r),Object.freeze(this)}static CURVE(){return nt}static fromAffine(e){return new N(e.x,e.y,1n,o(e.x*e.y))}static fromBytes(e,s=!1){const n=G,a=rt(C(e,Y)),r=e[31];a[31]=r&-129;const i=ft(a);E(i,0n,s?O:w);const l=o(i*i),d=o(l-1n),h=o(n*l+1n);let{isValid:m,value:p}=Kt(d,h);m||g("bad point: y not sqrt");const y=(p&1n)===1n,u=(r&128)!==0;return!s&&p===0n&&u&&g("bad point: x==0, isLastByteOdd"),u!==y&&(p=o(-p)),new N(p,i,1n,o(p*i))}static fromHex(e,s){return N.fromBytes(it(e),s)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}assertValidity(){const e=L,s=G,n=this;if(n.is0())return g("bad point: ZERO");const{X:a,Y:r,Z:i,T:f}=n,l=o(a*a),d=o(r*r),h=o(i*i),m=o(h*h),p=o(l*e),y=o(h*o(p+d)),u=o(m+o(s*o(l*d)));if(y!==u)return g("bad point: equation left != right (1)");const v=o(a*r),x=o(i*f);return v!==x?g("bad point: equation left != right (2)"):this}equals(e){const{X:s,Y:n,Z:a}=this,{X:r,Y:i,Z:f}=D(e),l=o(s*f),d=o(r*a),h=o(n*f),m=o(i*a);return l===d&&h===m}is0(){return this.equals(R)}negate(){return new N(o(-this.X),this.Y,this.Z,o(-this.T))}double(){const{X:e,Y:s,Z:n}=this,a=L,r=o(e*e),i=o(s*s),f=o(2n*o(n*n)),l=o(a*r),d=e+s,h=o(o(d*d)-r-i),m=l+i,p=m-f,y=l-i,u=o(h*p),v=o(m*y),x=o(h*y),A=o(p*m);return new N(u,v,A,x)}add(e){const{X:s,Y:n,Z:a,T:r}=this,{X:i,Y:f,Z:l,T:d}=D(e),h=L,m=G,p=o(s*i),y=o(n*f),u=o(r*m*d),v=o(a*l),x=o((s+n)*(i+f)-p-y),A=o(v-u),S=o(v+u),T=o(y-h*p),B=o(x*A),b=o(S*T),U=o(x*T),$=o(A*S);return new N(B,b,$,U)}subtract(e){return this.add(D(e).negate())}multiply(e,s=!0){if(!s&&(e===0n||this.is0()))return R;if(E(e,1n,X),e===1n)return this;if(this.equals(Z))return Ft(e).p;let n=R,a=Z;for(let r=this;e>0n;r=r.double(),e>>=1n)e&1n?n=n.add(r):s&&(a=a.add(r));return n}multiplyUnsafe(e){return this.multiply(e,!1)}toAffine(){const{X:e,Y:s,Z:n}=this;if(this.equals(R))return{x:0n,y:1n};const a=Et(n,w);o(n*a)!==1n&&g("invalid inverse");const r=o(e*a),i=o(s*a);return{x:r,y:i}}toBytes(){const{x:e,y:s}=this.assertValidity().toAffine(),n=St(s);return n[31]|=e&1n?128:0,n}toHex(){return ct(this.toBytes())}clearCofactor(){return this.multiply(P(gt),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let e=this.multiply(X/2n,!1).double();return X%2n&&(e=e.add(this)),e.is0()}}const Z=new N(W,J,1n,o(W*J)),R=new N(0n,1n,1n,0n);N.BASE=Z;N.ZERO=R;const St=t=>it(at(E(t,0n,O),ot)).reverse(),ft=t=>P("0x"+ct(rt(C(t)).reverse())),j=(t,e)=>{let s=t;for(;e-- >0n;)s*=s,s%=w;return s},Tt=t=>{const s=t*t%w*t%w,n=j(s,2n)*s%w,a=j(n,1n)*t%w,r=j(a,5n)*a%w,i=j(r,10n)*r%w,f=j(i,20n)*i%w,l=j(f,40n)*f%w,d=j(l,80n)*l%w,h=j(d,80n)*l%w,m=j(h,10n)*r%w;return{pow_p_5_8:j(m,2n)*t%w,b2:s}},tt=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,Kt=(t,e)=>{const s=o(e*e*e),n=o(s*s*e),a=Tt(t*n).pow_p_5_8;let r=o(t*s*a);const i=o(e*r*r),f=r,l=o(r*tt),d=i===t,h=i===o(-t),m=i===o(-t*tt);return d&&(r=f),(h||m)&&(r=l),(o(r)&1n)===1n&&(r=o(-r)),{isValid:d||h,value:r}},Rt=t=>Bt(ft(t)),Zt=(...t)=>Xt.sha512Async(lt(...t)),_t=t=>{const e=t.slice(0,Y);e[0]&=248,e[31]&=127,e[31]|=64;const s=t.slice(Y,ot),n=Rt(e),a=Z.multiply(n),r=a.toBytes();return{head:e,prefix:s,scalar:n,point:a,pointBytes:r}},Ct=t=>Zt(C(t,Y)).then(_t),Ut=t=>Ct(t).then(e=>e.pointBytes),Xt={sha512Async:async t=>{const e=At(),s=lt(t);return I(await e.digest("SHA-512",s.buffer))},sha512:void 0},F=8,Yt=256,dt=Math.ceil(Yt/F)+1,H=2**(F-1),Pt=()=>{const t=[];let e=Z,s=e;for(let n=0;n<dt;n++){s=e,t.push(s);for(let a=1;a<H;a++)s=s.add(e),t.push(s);e=s.double()}return t};let et;const st=(t,e)=>{const s=e.negate();return t?s:e},Ft=t=>{const e=et||(et=Pt());let s=R,n=Z;const a=2**F,r=a,i=P(a-1),f=P(F);for(let l=0;l<dt;l++){let d=Number(t&i);t>>=f,d>H&&(d-=r,t+=1n);const h=l*H,m=h,p=h+Math.abs(d)-1,y=l%2!==0,u=d<0;d===0?n=n.add(st(y,e[m])):s=s.add(st(u,e[p]))}return t!==0n&&g("invalid wnaf"),{p:s,f:n}};function Vt(t){return btoa(String.fromCodePoint(...t))}function K(t,e,s){const n=new TextEncoder().encode(s);return t.setUint32(e,n.length),new Uint8Array(t.buffer).set(n,e+4),e+4+n.length}function _(t,e,s){return t.setUint32(e,s.length),new Uint8Array(t.buffer).set(s,e+4),e+4+s.length}function Lt(t,e,s="deterministic-key"){const n=new TextEncoder().encode("openssh-key-v1\0"),a="ssh-ed25519",r=new Uint8Array(4+a.length+4+t.length),i=new DataView(r.buffer);let f=0;f=K(i,f,a),f=_(i,f,t);const d=new DataView(e.buffer,0,4).getUint32(0),h=new Uint8Array(e.length+t.length);h.set(e),h.set(t,e.length);const m=1024,p=new Uint8Array(m),y=new DataView(p.buffer);let u=0;y.setUint32(u,d),u+=4,y.setUint32(u,d),u+=4,u=K(y,u,a),u=_(y,u,t),u=_(y,u,h),u=K(y,u,s);const v=8,x=v-u%v;if(x>0&&x<v)for(let V=0;V<x;V++)p[u++]=V+1;const A=p.slice(0,u),S=2048,T=new Uint8Array(S),B=new DataView(T.buffer);let b=0;T.set(n,b),b+=n.length,b=K(B,b,"none"),b=K(B,b,"none"),b=K(B,b,""),B.setUint32(b,1),b+=4,b=_(B,b,r),b=_(B,b,A);const U=Vt(T.slice(0,b));return`-----BEGIN OPENSSH PRIVATE KEY-----
${U.match(/.{1,70}/g)?.join(`
`)||U}
-----END OPENSSH PRIVATE KEY-----`}async function Gt(t,e,s=1e7){const n=new TextEncoder,a=await crypto.subtle.importKey("raw",n.encode(t),{name:"PBKDF2"},!1,["deriveBits"]),r="SHA-256",i=n.encode(e),f=await crypto.subtle.deriveBits({name:"PBKDF2",salt:i,iterations:s,hash:r},a,256),l=new Uint8Array(f),d=await Ut(l);return{privateKey:Lt(d,l,e),iterations:s}}const Dt=()=>{const[t,e]=React.useState(""),[s,n]=React.useState("id_ed25519"),[a,r]=React.useState(1e7),[i,f]=React.useState(null),[l,d]=React.useState(null),[h,m]=React.useState(!1),[p,y]=React.useState(null),u=React.useCallback(async()=>{if(!(!t||!s)){m(!0);try{const x=await Gt(t,s,a);d(x),f(x.iterations)}catch(x){console.error("Generation failed",x)}finally{m(!1)}}},[t,s,a]),v=async(x,A)=>{try{await navigator.clipboard.writeText(x),y(A),setTimeout(()=>y(null),2e3)}catch(S){console.error("Failed to copy!",S)}};return c.jsx("div",{className:"min-h-screen bg-slate-950 text-slate-100 flex items-center justify-center p-6",children:c.jsxs("div",{className:"w-full max-w-2xl bg-slate-900 border border-slate-800 rounded-2xl shadow-2xl p-8",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[c.jsx("div",{className:"p-3 bg-indigo-500/10 rounded-xl",children:c.jsx(xt,{className:"w-8 h-8 text-indigo-400"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold",children:"Deterministic SSH Key Generator"}),c.jsx("p",{className:"text-slate-400 text-sm",children:"Generate Ed25519 keys from a passphrase and key name"})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"key-name",className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name (Salt)"}),c.jsx("input",{id:"key-name",type:"text",value:s,onChange:x=>n(x.target.value),placeholder:"id_ed25519",className:"w-full bg-slate-950 border border-slate-800 rounded-xl py-3 px-4 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all"}),c.jsx("p",{className:"mt-2 text-[10px] text-slate-500",children:"Used as a salt for the key derivation."})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"iterations",className:"block text-sm font-medium text-slate-300 mb-2",children:"PBKDF2 Iterations"}),c.jsx("input",{id:"iterations",type:"number",value:a,onChange:x=>r(parseInt(x.target.value)||0),className:"w-full bg-slate-950 border border-slate-800 rounded-xl py-3 px-4 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all"}),c.jsx("p",{className:"mt-2 text-[10px] text-slate-500",children:"Number of iterations for PBKDF2. Higher is more secure but slower."})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"passphrase",className:"block text-sm font-medium text-slate-300 mb-2",children:"Passphrase"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{id:"passphrase",type:"password",value:t,onChange:x=>e(x.target.value),placeholder:"Enter a strong passphrase...",className:"w-full bg-slate-950 border border-slate-800 rounded-xl py-3 px-4 pl-12 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all"}),c.jsx(yt,{className:"w-5 h-5 text-slate-500 absolute left-4 top-1/2 -translate-y-1/2"})]}),c.jsxs("p",{className:"mt-2 text-[10px] text-slate-500",children:["Keep it secret!"," ",i?`PBKDF2 with ${i.toLocaleString()} iterations.`:"Keys are derived using PBKDF2."]})]}),c.jsxs("button",{onClick:u,disabled:!t||!s||h,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-xl transition-colors flex items-center justify-center gap-2",children:[h?c.jsx(z,{className:"w-5 h-5 animate-spin"}):c.jsx(z,{className:"w-5 h-5"}),"Generate Key Pair"]}),l&&c.jsxs("div",{className:"space-y-6 pt-6 border-t border-slate-800 animate-in fade-in slide-in-from-top-4 duration-500",children:[c.jsxs("div",{className:"bg-indigo-500/5 border border-indigo-500/20 rounded-xl p-4 flex gap-3 items-start",children:[c.jsx(q,{className:"w-5 h-5 text-indigo-400 shrink-0 mt-0.5"}),c.jsxs("p",{className:"text-sm text-slate-300",children:[c.jsx("span",{className:"font-semibold text-indigo-300",children:"Key generated!"})," ","To recreate this exact key pair in the future, you will need the"," ",c.jsx("span",{className:"text-slate-100 font-medium",children:"Key Name (used as salt)"}),", the"," ",c.jsx("span",{className:"text-slate-100 font-medium",children:"Passphrase"})," ","and the"," ",c.jsx("span",{className:"text-slate-100 font-medium",children:"number of iterations"})," ","(",i?.toLocaleString(),")."]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("label",{htmlFor:"private-key",className:"text-sm font-medium text-slate-300",children:["Private Key ",s]}),c.jsxs("button",{onClick:()=>v(l.privateKey,"private"),className:"text-xs flex items-center gap-1.5 text-indigo-400 hover:text-indigo-300 transition-colors",children:[p==="private"?c.jsx(q,{className:"w-3.5 h-3.5"}):c.jsx(ht,{className:"w-3.5 h-3.5"}),p==="private"?"Copied!":`Copy ${s}`]})]}),c.jsx("textarea",{id:"private-key",readOnly:!0,value:l.privateKey,className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-4 text-xs font-mono text-slate-300 h-48 resize-none focus:outline-none"})]}),c.jsxs("div",{className:"bg-slate-950/50 border border-slate-800 rounded-xl p-4",children:[c.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"To generate the public key and verify the validity of the private key, you can run:"}),c.jsxs("code",{className:"text-[10px] text-indigo-300 break-all block bg-slate-900/50 p-2 rounded-lg border border-slate-800/50 whitespace-pre-wrap",children:["$ ssh-keygen -yf ~/.ssh/",s," > ~/.ssh/",s,".pub",`
`,"$ chmod 600 ~/.ssh/",s,`
`,"$ chmod 644 ~/.ssh/",s,".pub",`
`]})]})]})]})]})})},ut=document.getElementById("root");if(!ut)throw new Error("Root element #root not found");ReactDOM.createRoot(ut).render(c.jsx(React.StrictMode,{children:c.jsx(Dt,{})}));
