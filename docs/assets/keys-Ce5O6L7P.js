import"./index-BXReTibj.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{B as w}from"./button-D6DGr86I.js";import*as k from"https://esm.sh/@noble/ed25519@^3.0.0?bundle";import{f as K,K as C}from"./crypto-BXWHoYI9.js";import{c as P}from"./createLucideIcon-DtX1aPOG.js";import{R as y}from"./refresh-cw-pTx9cW3g.js";import{C as b}from"./check-CWX8rMms.js";import{C as S}from"./copy-CzC7y2Qs.js";import"./clsx-B-dksMZM.js";const R=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],B=P("lock",R);async function F(a,l,t=1e7){const o=new TextEncoder,n=await crypto.subtle.importKey("raw",o.encode(a),{name:"PBKDF2"},!1,["deriveBits"]),c="SHA-256",i=o.encode(l),d=await crypto.subtle.deriveBits({name:"PBKDF2",salt:i,iterations:t,hash:c},n,256),r=new Uint8Array(d),m=await k.getPublicKeyAsync(r);return{privateKey:K(m,r,l),iterations:t}}const D=()=>{const[a,l]=React.useState(""),[t,o]=React.useState("id_ed25519"),[n,c]=React.useState(1e7),[i,d]=React.useState(null),[r,m]=React.useState(null),[x,p]=React.useState(!1),[u,h]=React.useState(null),g=React.useCallback(async()=>{if(!(!a||!t)){p(!0);try{const s=await F(a,t,n);m(s),d(s.iterations)}catch(s){console.error("Generation failed",s)}finally{p(!1)}}},[a,t,n]),j=async(s,v)=>{try{await navigator.clipboard.writeText(s),h(v),setTimeout(()=>h(null),2e3)}catch(N){console.error("Failed to copy!",N)}};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-950 p-6 text-slate-100",children:e.jsxs("div",{className:"w-full max-w-2xl rounded-2xl border border-slate-800 bg-slate-900 p-8 shadow-2xl",children:[e.jsxs("div",{className:"mb-8 flex items-center gap-3",children:[e.jsx("div",{className:"rounded-xl bg-indigo-500/10 p-3",children:e.jsx(C,{className:"h-8 w-8 text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Deterministic SSH Key Generator"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Generate Ed25519 keys from a passphrase and key name"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"key-name",className:"mb-2 block text-sm font-medium text-slate-300",children:"Key Name (Salt)"}),e.jsx("input",{id:"key-name",type:"text",value:t,onChange:s=>o(s.target.value),placeholder:"id_ed25519","data-testid":"key-name-input",className:"w-full rounded-xl border border-slate-800 bg-slate-950 px-4 py-3 transition-all outline-none focus:border-transparent focus:ring-2 focus:ring-indigo-500"}),e.jsx("p",{className:"mt-2 text-[10px] text-slate-500",children:"Used as a salt for the key derivation."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"iterations",className:"mb-2 block text-sm font-medium text-slate-300",children:"PBKDF2 Iterations"}),e.jsx("input",{id:"iterations",type:"number",value:n,onChange:s=>c(parseInt(s.target.value)||0),className:"w-full rounded-xl border border-slate-800 bg-slate-950 px-4 py-3 transition-all outline-none focus:border-transparent focus:ring-2 focus:ring-indigo-500"}),e.jsx("p",{className:"mt-2 text-[10px] text-slate-500",children:"Number of iterations for PBKDF2. Higher is more secure but slower."})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"passphrase",className:"mb-2 block text-sm font-medium text-slate-300",children:"Passphrase"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"passphrase",type:"password",autoComplete:"current-password",value:a,onChange:s=>l(s.target.value),placeholder:"Enter a strong passphrase...","data-testid":"passphrase-input",className:"w-full rounded-xl border border-slate-800 bg-slate-950 px-4 py-3 pl-12 transition-all outline-none focus:border-transparent focus:ring-2 focus:ring-indigo-500"}),e.jsx(B,{className:"absolute top-1/2 left-4 h-5 w-5 -translate-y-1/2 text-slate-500"})]}),e.jsxs("p",{className:"mt-2 text-[10px] text-slate-500",children:["Keep it secret!"," ",i?`PBKDF2 with ${i.toLocaleString()} iterations.`:"Keys are derived using PBKDF2."]})]}),e.jsxs(w,{onClick:g,disabled:!a||!t||x,className:"w-full py-6",children:[x?e.jsx(y,{className:"h-5 w-5 animate-spin"}):e.jsx(y,{className:"h-5 w-5"}),"Generate Key Pair"]}),r&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-4 space-y-6 border-t border-slate-800 pt-6 duration-500",children:[e.jsxs("div",{className:"flex items-start gap-3 rounded-xl border border-indigo-500/20 bg-indigo-500/5 p-4",children:[e.jsx(b,{className:"mt-0.5 h-5 w-5 shrink-0 text-indigo-400"}),e.jsxs("p",{className:"text-sm text-slate-300",children:[e.jsx("span",{className:"font-semibold text-indigo-300",children:"Key generated!"})," To recreate this exact key pair in the future, you will need the"," ",e.jsx("span",{className:"font-medium text-slate-100",children:"Key Name (used as salt)"}),", the"," ",e.jsx("span",{className:"font-medium text-slate-100",children:"Passphrase"})," and the"," ",e.jsx("span",{className:"font-medium text-slate-100",children:"number of iterations"})," (",i?.toLocaleString(),")."]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsxs("label",{htmlFor:"private-key",className:"text-sm font-medium text-slate-300",children:["Private Key ",t]}),e.jsxs("button",{onClick:()=>j(r.privateKey,"private"),className:"flex items-center gap-1.5 text-xs text-indigo-400 transition-colors hover:text-indigo-300",children:[u==="private"?e.jsx(b,{className:"h-3.5 w-3.5"}):e.jsx(S,{className:"h-3.5 w-3.5"}),u==="private"?"Copied!":`Copy ${t}`]})]}),e.jsx("textarea",{id:"private-key",readOnly:!0,value:r.privateKey,className:"h-48 w-full resize-none rounded-xl border border-slate-800 bg-slate-950 p-4 font-mono text-xs text-slate-300 focus:outline-none"})]}),e.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-950/50 p-4",children:[e.jsx("p",{className:"mb-2 text-xs text-slate-400",children:"To generate the public key and verify the validity of the private key, you can run:"}),e.jsxs("code",{className:"block rounded-lg border border-slate-800/50 bg-slate-900/50 p-2 text-[10px] break-all whitespace-pre-wrap text-indigo-300",children:["$ chmod 600 ~/.ssh/",t,`
`,"$ ssh-keygen -yf ~/.ssh/",t," > ~/.ssh/",t,".pub",`
`,"$ chmod 644 ~/.ssh/",t,".pub",`
`]})]})]})]})]})})},f=document.getElementById("root");if(!f)throw new Error("Root element #root not found");ReactDOM.createRoot(f).render(e.jsx(React.StrictMode,{children:e.jsx(D,{})}));
