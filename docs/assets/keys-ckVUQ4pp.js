import"./index-CBYLtEE8.js";import{j as c}from"./jsx-runtime-u17CrQMm.js";import{B as pt}from"./button-D6DGr86I.js";import{c as st}from"./createLucideIcon-DtX1aPOG.js";import{R as M}from"./refresh-cw-pTx9cW3g.js";import{C as q}from"./check-CWX8rMms.js";import{C as ht}from"./copy-CzC7y2Qs.js";import"./clsx-B-dksMZM.js";const mt=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],xt=st("key",mt);const yt=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],bt=st("lock",yt);const nt={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,h:8n,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p:w,n:X,Gx:z,Gy:W,a:G,d:D,h:gt}=nt,Y=32,ot=64,wt=(...t)=>{"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(...t)},g=(t="")=>{const e=new Error(t);throw wt(e,g),e},vt=t=>typeof t=="bigint",Nt=t=>typeof t=="string",jt=t=>t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array",_=(t,e,s="")=>{const n=jt(t),a=t?.length,r=e!==void 0;if(!n||r&&a!==e){const i=s&&`"${s}" `,f=r?` of length ${e}`:"",l=n?`length=${a}`:`type=${typeof t}`;g(i+"expected Uint8Array"+f+", got "+l)}return t},I=t=>new Uint8Array(t),rt=t=>Uint8Array.from(t),at=(t,e)=>t.toString(16).padStart(e,"0"),ct=t=>Array.from(_(t)).map(e=>at(e,2)).join(""),k={_0:48,_9:57,A:65,F:70,a:97,f:102},J=t=>{if(t>=k._0&&t<=k._9)return t-k._0;if(t>=k.A&&t<=k.F)return t-(k.A-10);if(t>=k.a&&t<=k.f)return t-(k.a-10)},it=t=>{const e="hex invalid";if(!Nt(t))return g(e);const s=t.length,n=s/2;if(s%2)return g(e);const a=I(n);for(let r=0,i=0;r<n;r++,i+=2){const f=J(t.charCodeAt(i)),l=J(t.charCodeAt(i+1));if(f===void 0||l===void 0)return g(e);a[r]=f*16+l}return a},kt=()=>globalThis?.crypto,At=()=>kt()?.subtle??g("crypto.subtle must be defined, consider polyfill"),lt=(...t)=>{const e=I(t.reduce((n,a)=>n+_(a).length,0));let s=0;return t.forEach(n=>{e.set(n,s),s+=n.length}),e},P=BigInt,E=(t,e,s,n="bad number: out of range")=>vt(t)&&e<=t&&t<s?t:g(n),o=(t,e=w)=>{const s=t%e;return s>=0n?s:e+s},Bt=t=>o(t,X),Et=(t,e)=>{(t===0n||e<=0n)&&g("no inverse n="+t+" mod="+e);let s=o(t,e),n=e,a=0n,r=1n;for(;s!==0n;){const i=n/s,f=n%s,l=a-r*i;n=s,s=f,a=r,r=l}return n===1n?o(a,e):g("no inverse")},L=t=>t instanceof N?t:g("Point expected"),O=2n**256n;class N{static BASE;static ZERO;X;Y;Z;T;constructor(e,s,n,a){const r=O;this.X=E(e,0n,r),this.Y=E(s,0n,r),this.Z=E(n,1n,r),this.T=E(a,0n,r),Object.freeze(this)}static CURVE(){return nt}static fromAffine(e){return new N(e.x,e.y,1n,o(e.x*e.y))}static fromBytes(e,s=!1){const n=D,a=rt(_(e,Y)),r=e[31];a[31]=r&-129;const i=ft(a);E(i,0n,s?O:w);const l=o(i*i),d=o(l-1n),p=o(n*l+1n);let{isValid:x,value:h}=Kt(d,p);x||g("bad point: y not sqrt");const y=(h&1n)===1n,u=(r&128)!==0;return!s&&h===0n&&u&&g("bad point: x==0, isLastByteOdd"),u!==y&&(h=o(-h)),new N(h,i,1n,o(h*i))}static fromHex(e,s){return N.fromBytes(it(e),s)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}assertValidity(){const e=G,s=D,n=this;if(n.is0())return g("bad point: ZERO");const{X:a,Y:r,Z:i,T:f}=n,l=o(a*a),d=o(r*r),p=o(i*i),x=o(p*p),h=o(l*e),y=o(p*o(h+d)),u=o(x+o(s*o(l*d)));if(y!==u)return g("bad point: equation left != right (1)");const v=o(a*r),m=o(i*f);return v!==m?g("bad point: equation left != right (2)"):this}equals(e){const{X:s,Y:n,Z:a}=this,{X:r,Y:i,Z:f}=L(e),l=o(s*f),d=o(r*a),p=o(n*f),x=o(i*a);return l===d&&p===x}is0(){return this.equals(R)}negate(){return new N(o(-this.X),this.Y,this.Z,o(-this.T))}double(){const{X:e,Y:s,Z:n}=this,a=G,r=o(e*e),i=o(s*s),f=o(2n*o(n*n)),l=o(a*r),d=e+s,p=o(o(d*d)-r-i),x=l+i,h=x-f,y=l-i,u=o(p*h),v=o(x*y),m=o(p*y),A=o(h*x);return new N(u,v,A,m)}add(e){const{X:s,Y:n,Z:a,T:r}=this,{X:i,Y:f,Z:l,T:d}=L(e),p=G,x=D,h=o(s*i),y=o(n*f),u=o(r*x*d),v=o(a*l),m=o((s+n)*(i+f)-h-y),A=o(v-u),S=o(v+u),T=o(y-p*h),B=o(m*A),b=o(S*T),U=o(m*T),$=o(A*S);return new N(B,b,$,U)}subtract(e){return this.add(L(e).negate())}multiply(e,s=!0){if(!s&&(e===0n||this.is0()))return R;if(E(e,1n,X),e===1n)return this;if(this.equals(C))return Ft(e).p;let n=R,a=C;for(let r=this;e>0n;r=r.double(),e>>=1n)e&1n?n=n.add(r):s&&(a=a.add(r));return n}multiplyUnsafe(e){return this.multiply(e,!1)}toAffine(){const{X:e,Y:s,Z:n}=this;if(this.equals(R))return{x:0n,y:1n};const a=Et(n,w);o(n*a)!==1n&&g("invalid inverse");const r=o(e*a),i=o(s*a);return{x:r,y:i}}toBytes(){const{x:e,y:s}=this.assertValidity().toAffine(),n=St(s);return n[31]|=e&1n?128:0,n}toHex(){return ct(this.toBytes())}clearCofactor(){return this.multiply(P(gt),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let e=this.multiply(X/2n,!1).double();return X%2n&&(e=e.add(this)),e.is0()}}const C=new N(z,W,1n,o(z*W)),R=new N(0n,1n,1n,0n);N.BASE=C;N.ZERO=R;const St=t=>it(at(E(t,0n,O),ot)).reverse(),ft=t=>P("0x"+ct(rt(_(t)).reverse())),j=(t,e)=>{let s=t;for(;e-- >0n;)s*=s,s%=w;return s},Tt=t=>{const s=t*t%w*t%w,n=j(s,2n)*s%w,a=j(n,1n)*t%w,r=j(a,5n)*a%w,i=j(r,10n)*r%w,f=j(i,20n)*i%w,l=j(f,40n)*f%w,d=j(l,80n)*l%w,p=j(d,80n)*l%w,x=j(p,10n)*r%w;return{pow_p_5_8:j(x,2n)*t%w,b2:s}},Q=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,Kt=(t,e)=>{const s=o(e*e*e),n=o(s*s*e),a=Tt(t*n).pow_p_5_8;let r=o(t*s*a);const i=o(e*r*r),f=r,l=o(r*Q),d=i===t,p=i===o(-t),x=i===o(-t*Q);return d&&(r=f),(p||x)&&(r=l),(o(r)&1n)===1n&&(r=o(-r)),{isValid:d||p,value:r}},Rt=t=>Bt(ft(t)),Ct=(...t)=>Xt.sha512Async(lt(...t)),Zt=t=>{const e=t.slice(0,Y);e[0]&=248,e[31]&=127,e[31]|=64;const s=t.slice(Y,ot),n=Rt(e),a=C.multiply(n),r=a.toBytes();return{head:e,prefix:s,scalar:n,point:a,pointBytes:r}},_t=t=>Ct(_(t,Y)).then(Zt),Ut=t=>_t(t).then(e=>e.pointBytes),Xt={sha512Async:async t=>{const e=At(),s=lt(t);return I(await e.digest("SHA-512",s.buffer))},sha512:void 0},F=8,Yt=256,dt=Math.ceil(Yt/F)+1,H=2**(F-1),Pt=()=>{const t=[];let e=C,s=e;for(let n=0;n<dt;n++){s=e,t.push(s);for(let a=1;a<H;a++)s=s.add(e),t.push(s);e=s.double()}return t};let tt;const et=(t,e)=>{const s=e.negate();return t?s:e},Ft=t=>{const e=tt||(tt=Pt());let s=R,n=C;const a=2**F,r=a,i=P(a-1),f=P(F);for(let l=0;l<dt;l++){let d=Number(t&i);t>>=f,d>H&&(d-=r,t+=1n);const p=l*H,x=p,h=p+Math.abs(d)-1,y=l%2!==0,u=d<0;d===0?n=n.add(et(y,e[x])):s=s.add(et(u,e[h]))}return t!==0n&&g("invalid wnaf"),{p:s,f:n}};function Vt(t){return btoa(String.fromCodePoint(...t))}function K(t,e,s){const n=new TextEncoder().encode(s);return t.setUint32(e,n.length),new Uint8Array(t.buffer).set(n,e+4),e+4+n.length}function Z(t,e,s){return t.setUint32(e,s.length),new Uint8Array(t.buffer).set(s,e+4),e+4+s.length}function Gt(t,e,s="deterministic-key"){const n=new TextEncoder().encode("openssh-key-v1\0"),a="ssh-ed25519",r=new Uint8Array(4+a.length+4+t.length),i=new DataView(r.buffer);let f=0;f=K(i,f,a),f=Z(i,f,t);const d=new DataView(e.buffer,0,4).getUint32(0),p=new Uint8Array(e.length+t.length);p.set(e),p.set(t,e.length);const x=1024,h=new Uint8Array(x),y=new DataView(h.buffer);let u=0;y.setUint32(u,d),u+=4,y.setUint32(u,d),u+=4,u=K(y,u,a),u=Z(y,u,t),u=Z(y,u,p),u=K(y,u,s);const v=8,m=v-u%v;if(m>0&&m<v)for(let V=0;V<m;V++)h[u++]=V+1;const A=h.slice(0,u),S=2048,T=new Uint8Array(S),B=new DataView(T.buffer);let b=0;T.set(n,b),b+=n.length,b=K(B,b,"none"),b=K(B,b,"none"),b=K(B,b,""),B.setUint32(b,1),b+=4,b=Z(B,b,r),b=Z(B,b,A);const U=Vt(T.slice(0,b));return`-----BEGIN OPENSSH PRIVATE KEY-----
${U.match(/.{1,70}/g)?.join(`
`)||U}
-----END OPENSSH PRIVATE KEY-----`}async function Dt(t,e,s=1e7){const n=new TextEncoder,a=await crypto.subtle.importKey("raw",n.encode(t),{name:"PBKDF2"},!1,["deriveBits"]),r="SHA-256",i=n.encode(e),f=await crypto.subtle.deriveBits({name:"PBKDF2",salt:i,iterations:s,hash:r},a,256),l=new Uint8Array(f),d=await Ut(l);return{privateKey:Gt(d,l,e),iterations:s}}const Lt=()=>{const[t,e]=React.useState(""),[s,n]=React.useState("id_ed25519"),[a,r]=React.useState(1e7),[i,f]=React.useState(null),[l,d]=React.useState(null),[p,x]=React.useState(!1),[h,y]=React.useState(null),u=React.useCallback(async()=>{if(!(!t||!s)){x(!0);try{const m=await Dt(t,s,a);d(m),f(m.iterations)}catch(m){console.error("Generation failed",m)}finally{x(!1)}}},[t,s,a]),v=async(m,A)=>{try{await navigator.clipboard.writeText(m),y(A),setTimeout(()=>y(null),2e3)}catch(S){console.error("Failed to copy!",S)}};return c.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-950 p-6 text-slate-100",children:c.jsxs("div",{className:"w-full max-w-2xl rounded-2xl border border-slate-800 bg-slate-900 p-8 shadow-2xl",children:[c.jsxs("div",{className:"mb-8 flex items-center gap-3",children:[c.jsx("div",{className:"rounded-xl bg-indigo-500/10 p-3",children:c.jsx(xt,{className:"h-8 w-8 text-indigo-400"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold",children:"Deterministic SSH Key Generator"}),c.jsx("p",{className:"text-sm text-slate-400",children:"Generate Ed25519 keys from a passphrase and key name"})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"key-name",className:"mb-2 block text-sm font-medium text-slate-300",children:"Key Name (Salt)"}),c.jsx("input",{id:"key-name",type:"text",value:s,onChange:m=>n(m.target.value),placeholder:"id_ed25519","data-testid":"key-name-input",className:"w-full rounded-xl border border-slate-800 bg-slate-950 px-4 py-3 transition-all outline-none focus:border-transparent focus:ring-2 focus:ring-indigo-500"}),c.jsx("p",{className:"mt-2 text-[10px] text-slate-500",children:"Used as a salt for the key derivation."})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"iterations",className:"mb-2 block text-sm font-medium text-slate-300",children:"PBKDF2 Iterations"}),c.jsx("input",{id:"iterations",type:"number",value:a,onChange:m=>r(parseInt(m.target.value)||0),className:"w-full rounded-xl border border-slate-800 bg-slate-950 px-4 py-3 transition-all outline-none focus:border-transparent focus:ring-2 focus:ring-indigo-500"}),c.jsx("p",{className:"mt-2 text-[10px] text-slate-500",children:"Number of iterations for PBKDF2. Higher is more secure but slower."})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"passphrase",className:"mb-2 block text-sm font-medium text-slate-300",children:"Passphrase"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{id:"passphrase",type:"password",autoComplete:"current-password",value:t,onChange:m=>e(m.target.value),placeholder:"Enter a strong passphrase...","data-testid":"passphrase-input",className:"w-full rounded-xl border border-slate-800 bg-slate-950 px-4 py-3 pl-12 transition-all outline-none focus:border-transparent focus:ring-2 focus:ring-indigo-500"}),c.jsx(bt,{className:"absolute top-1/2 left-4 h-5 w-5 -translate-y-1/2 text-slate-500"})]}),c.jsxs("p",{className:"mt-2 text-[10px] text-slate-500",children:["Keep it secret!"," ",i?`PBKDF2 with ${i.toLocaleString()} iterations.`:"Keys are derived using PBKDF2."]})]}),c.jsxs(pt,{onClick:u,disabled:!t||!s||p,className:"w-full py-6",children:[p?c.jsx(M,{className:"h-5 w-5 animate-spin"}):c.jsx(M,{className:"h-5 w-5"}),"Generate Key Pair"]}),l&&c.jsxs("div",{className:"animate-in fade-in slide-in-from-top-4 space-y-6 border-t border-slate-800 pt-6 duration-500",children:[c.jsxs("div",{className:"flex items-start gap-3 rounded-xl border border-indigo-500/20 bg-indigo-500/5 p-4",children:[c.jsx(q,{className:"mt-0.5 h-5 w-5 shrink-0 text-indigo-400"}),c.jsxs("p",{className:"text-sm text-slate-300",children:[c.jsx("span",{className:"font-semibold text-indigo-300",children:"Key generated!"})," To recreate this exact key pair in the future, you will need the"," ",c.jsx("span",{className:"font-medium text-slate-100",children:"Key Name (used as salt)"}),", the"," ",c.jsx("span",{className:"font-medium text-slate-100",children:"Passphrase"})," and the"," ",c.jsx("span",{className:"font-medium text-slate-100",children:"number of iterations"})," (",i?.toLocaleString(),")."]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[c.jsxs("label",{htmlFor:"private-key",className:"text-sm font-medium text-slate-300",children:["Private Key ",s]}),c.jsxs("button",{onClick:()=>v(l.privateKey,"private"),className:"flex items-center gap-1.5 text-xs text-indigo-400 transition-colors hover:text-indigo-300",children:[h==="private"?c.jsx(q,{className:"h-3.5 w-3.5"}):c.jsx(ht,{className:"h-3.5 w-3.5"}),h==="private"?"Copied!":`Copy ${s}`]})]}),c.jsx("textarea",{id:"private-key",readOnly:!0,value:l.privateKey,className:"h-48 w-full resize-none rounded-xl border border-slate-800 bg-slate-950 p-4 font-mono text-xs text-slate-300 focus:outline-none"})]}),c.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-950/50 p-4",children:[c.jsx("p",{className:"mb-2 text-xs text-slate-400",children:"To generate the public key and verify the validity of the private key, you can run:"}),c.jsxs("code",{className:"block rounded-lg border border-slate-800/50 bg-slate-900/50 p-2 text-[10px] break-all whitespace-pre-wrap text-indigo-300",children:["$ ssh-keygen -yf ~/.ssh/",s," > ~/.ssh/",s,".pub",`
`,"$ chmod 600 ~/.ssh/",s,`
`,"$ chmod 644 ~/.ssh/",s,".pub",`
`]})]})]})]})]})})},ut=document.getElementById("root");if(!ut)throw new Error("Root element #root not found");ReactDOM.createRoot(ut).render(c.jsx(React.StrictMode,{children:c.jsx(Lt,{})}));
