import"./index-Ch1IFy9t.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{B as C}from"./button-ChVf0VhC.js";import{A as k}from"./api-CH_Pe6Vg.js";import"./clsx-B-dksMZM.js";import"./utils-Bp7-rn4K.js";const S=async a=>{const l=await fetch(`${k}/lease-calculator/calculate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!l.ok)throw new Error("Failed to calculate lease premium");return l.json()};function L({propertyValue:a,remainingLeaseYears:l,groundRent:s,capitalizationRate:n,defermentRate:o,apply2024Reform:u,yearLeaseIs40:d,applyCapAndPeppercorn:r,onPropertyValueChange:i,onRemainingLeaseYearsChange:h,onGroundRentChange:c,onCapitalizationRateChange:g,onDefermentRateChange:x,onApply2024ReformChange:f,onYearLeaseIs40Change:m,onApplyCapAndPeppercornChange:b}){return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Property Value (Long Lease)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:"£"}),e.jsx("input",{type:"number",value:a||"",onChange:t=>i(Number(t.target.value)),className:"w-full bg-slate-900/50 border border-slate-700 rounded-md py-2 pl-8 pr-4 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"e.g. 250000"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Remaining Lease Years"}),e.jsx("input",{type:"number",value:l||"",onChange:t=>h(Number(t.target.value)),className:"w-full bg-slate-900/50 border border-slate-700 rounded-md py-2 px-4 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"e.g. 75"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Current Annual Ground Rent"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:"£"}),e.jsx("input",{type:"number",value:s||"",onChange:t=>c(Number(t.target.value)),className:"w-full bg-slate-900/50 border border-slate-700 rounded-md py-2 pl-8 pr-4 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"e.g. 200"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:`text-sm font-medium ${r?"text-slate-600":"text-slate-300"}`,children:"Year lease is 40 years old"}),e.jsx("input",{type:"number",value:d||"",onChange:t=>m(t.target.value?Number(t.target.value):void 0),disabled:r,className:`w-full bg-slate-900/50 border border-slate-700 rounded-md py-2 px-4 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 ${r?"opacity-50 cursor-not-allowed":""}`,placeholder:"e.g. 2048"}),e.jsx("p",{className:"text-[10px] text-slate-500",children:"Ground rent becomes peppercorn after this year"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer gap-3",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:t=>f(t.target.checked),"data-testid":"toggle-2024-reform",className:"w-5 h-5 shrink-0 rounded border-slate-700 bg-slate-900 text-indigo-500 focus:ring-indigo-500"}),e.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Apply 2024 Reform (No Marriage Value)"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer gap-3",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:t=>b(t.target.checked),"data-testid":"toggle-cap-peppercorn",className:"w-5 h-5 shrink-0 rounded border-slate-700 bg-slate-900 text-indigo-500 focus:ring-indigo-500"}),e.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Cap ground rent at £250 & peppercorn after 40 years"})]})]}),e.jsxs("div",{className:"md:col-span-2 border-t border-slate-700/50 pt-6 mt-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-400 mb-4 uppercase tracking-wider",children:"Advanced Parameters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Capitalization Rate (%)"}),e.jsx("input",{type:"number",step:"0.1",value:n,onChange:t=>g(Number(t.target.value)),className:"w-full bg-slate-900/50 border border-slate-700 rounded-md py-2 px-4 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Usually 5.0% - 7.0%"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Deferment Rate (%)"}),e.jsx("input",{type:"number",step:"0.1",value:o,onChange:t=>x(Number(t.target.value)),className:"w-full bg-slate-900/50 border border-slate-700 rounded-md py-2 px-4 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Usually 5.0% (Post-reform may be lower)"})]})]})]})]})}function P({result:a}){const l=s=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(s);return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"bg-indigo-500/10 border border-indigo-500/20 rounded-xl p-8 text-center",children:[e.jsx("h3",{className:"text-indigo-300 text-sm font-semibold uppercase tracking-widest mb-2",children:"Estimated Premium"}),e.jsx("div",{className:"text-5xl font-bold text-white mb-2",children:l(a.total_premium)}),e.jsx("p",{className:"text-slate-400 text-sm",children:a.is_post_reform?"Based on 2024 Reform Act rules":"Based on traditional pre-reform rules"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-900/40 border border-slate-700/50 rounded-lg p-4",children:[e.jsx("div",{className:"text-slate-400 text-xs font-semibold uppercase mb-1",children:"Diminution"}),e.jsx("div",{className:"text-xl font-medium text-slate-200",children:l(a.diminution_of_ground_rent)}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-2",children:"Compensation for loss of ground rent"})]}),e.jsxs("div",{className:"bg-slate-900/40 border border-slate-700/50 rounded-lg p-4",children:[e.jsx("div",{className:"text-slate-400 text-xs font-semibold uppercase mb-1",children:"Reversion"}),e.jsx("div",{className:"text-xl font-medium text-slate-200",children:l(a.reversionary_interest)}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-2",children:"Value of the property returning to landlord"})]}),e.jsxs("div",{className:"bg-slate-900/40 border border-slate-700/50 rounded-lg p-4",children:[e.jsx("div",{className:"text-slate-400 text-xs font-semibold uppercase mb-1",children:"Marriage Value"}),e.jsx("div",{className:"text-xl font-medium text-slate-200",children:l(a.marriage_value)}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-2",children:a.marriage_value>0?"Share of value increase (lease < 80y)":"Not applicable (abolished or lease > 80y)"})]})]}),e.jsxs("div",{className:"bg-slate-900/40 border border-slate-700/50 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-slate-700/50 bg-slate-800/30",children:e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Detailed Calculation Breakdown"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"text-xs text-slate-500 uppercase bg-slate-800/10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 font-semibold",children:"Step"}),e.jsx("th",{className:"px-4 py-2 font-semibold",children:"Description"}),e.jsx("th",{className:"px-4 py-2 font-semibold text-right",children:"Value"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-800/50",children:[a.breakdown.map((s,n)=>e.jsxs("tr",{className:"hover:bg-slate-800/20 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-slate-300 whitespace-nowrap",children:s.step}),e.jsx("td",{className:"px-4 py-3 text-slate-400 text-xs",children:s.description}),e.jsx("td",{className:"px-4 py-3 text-right font-mono text-slate-200",children:s.value})]},n)),e.jsxs("tr",{className:"bg-indigo-500/5",children:[e.jsx("td",{className:"px-4 py-3 font-bold text-indigo-300",colSpan:2,children:"Total Estimated Premium"}),e.jsx("td",{className:"px-4 py-3 text-right font-bold text-white text-lg",children:l(a.total_premium)})]})]})]})})]}),e.jsxs("div",{className:"bg-slate-900/40 border border-slate-700/50 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-slate-700/50 bg-slate-800/30",children:e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Ground Rent Diminution Schedule (Year by Year)"})}),e.jsx("div",{className:"overflow-x-auto max-h-96",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"text-xs text-slate-500 uppercase bg-slate-800/10 sticky top-0 bg-slate-900 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 font-semibold",children:"Year"}),e.jsx("th",{className:"px-4 py-2 font-semibold text-right",children:"Ground Rent"}),e.jsx("th",{className:"px-4 py-2 font-semibold text-right",children:"Discounted PV"}),e.jsx("th",{className:"px-4 py-2 font-semibold text-right",children:"Cumulative PV"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-800/50",children:a.ground_rent_schedule.map(s=>e.jsxs("tr",{className:"hover:bg-slate-800/20 transition-colors",children:[e.jsx("td",{className:"px-4 py-2 font-medium text-slate-400",children:s.year}),e.jsx("td",{className:"px-4 py-2 text-right text-slate-300",children:s.ground_rent===0?e.jsx("span",{className:"text-xs italic",children:"Peppercorn"}):l(s.ground_rent)}),e.jsx("td",{className:"px-4 py-2 text-right text-indigo-300 font-mono",children:l(s.discounted_value)}),e.jsx("td",{className:"px-4 py-2 text-right text-slate-200 font-mono",children:l(s.cumulative)})]},s.year))})]})}),e.jsx("div",{className:"px-4 py-2 bg-slate-800/10 text-[10px] text-slate-500 italic",children:"* Shows the present value (PV) of each future ground rent payment discounted at the capitalization rate."})]}),e.jsxs("div",{className:"p-4 bg-slate-800/30 rounded-lg border border-slate-700/30",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 mb-2 uppercase tracking-tighter",children:"Note on 2024 Reform"}),e.jsx("p",{className:"text-xs text-slate-500 leading-relaxed mb-2",children:"The Leasehold and Freehold Reform Act 2024 has abolished marriage value and extended the standard extension to 990 years. This calculator assumes these reforms are in effect. Professional valuation and legal advice should always be sought before proceeding."}),e.jsxs("p",{className:"text-[10px] text-slate-600 leading-tight italic",children:["Based on the latest government plans for leasehold reform (see"," ",e.jsx("a",{href:"https://www.gov.uk/government/news/pm-were-capping-ground-rents-at-250",target:"_blank",rel:"noopener noreferrer",className:"text-indigo-400 hover:text-indigo-300 underline",children:"Government News: Leasehold reforms"}),")."]})]})]})}function A(){const[a,l]=React.useState(28e4),[s,n]=React.useState(107),[o,u]=React.useState(700),[d,r]=React.useState(5),[i,h]=React.useState(5),[c,g]=React.useState(!0),[x,f]=React.useState(void 0),[m,b]=React.useState(!0),[t,N]=React.useState(null),[j,y]=React.useState(!1),[v,w]=React.useState(null),_=async()=>{y(!0),w(null);try{const p=await S({property_value:a,remaining_lease_years:s,ground_rent:o,capitalization_rate:d,deferment_rate:i,apply_2024_reform:c,year_lease_is_40:x,apply_cap_and_peppercorn:m});N(p)}catch(p){w(p instanceof Error?p.message:"Failed to calculate premium"),N(null)}finally{y(!1)}};return e.jsx("div",{className:"min-h-screen bg-slate-950 text-slate-200 px-6 py-8 md:py-16",children:e.jsxs("div",{className:"mx-auto flex w-full max-w-4xl flex-col gap-8",children:[e.jsxs("header",{className:"flex flex-col gap-2",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-white tracking-tight",children:"UK Lease Extension & Buyout"}),e.jsx("p",{className:"text-slate-400 text-lg",children:"Estimate the cost of extending your lease to 990 years and buying out your ground rent."})]}),e.jsxs("div",{className:"bg-slate-900/50 rounded-2xl shadow-2xl p-8 border border-slate-800 backdrop-blur-sm",children:[e.jsx(L,{propertyValue:a,remainingLeaseYears:s,groundRent:o,capitalizationRate:d,defermentRate:i,apply2024Reform:c,yearLeaseIs40:x,applyCapAndPeppercorn:m,onPropertyValueChange:l,onRemainingLeaseYearsChange:n,onGroundRentChange:u,onCapitalizationRateChange:r,onDefermentRateChange:h,onApply2024ReformChange:g,onYearLeaseIs40Change:f,onApplyCapAndPeppercornChange:b}),e.jsx(C,{onClick:_,disabled:j,className:"w-full py-6",children:j?"Calculating...":"Generate Estimate"}),v&&e.jsx("div",{className:"mt-6 p-4 bg-red-900/30 border border-red-800 rounded-xl text-red-200 text-sm",children:v})]}),t&&e.jsx("div",{className:"bg-slate-900/50 rounded-2xl shadow-2xl p-8 border border-slate-800 animate-in fade-in slide-in-from-bottom-4 duration-500",children:e.jsx(P,{result:t})})]})})}const R=document.getElementById("root");if(!R)throw new Error("Root element not found");document.body.classList.add("lease-calculator-page");ReactDOM.createRoot(R).render(e.jsx(React.StrictMode,{children:e.jsx(A,{})}));
