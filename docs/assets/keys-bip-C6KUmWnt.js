import"./index-pErSQAtW.js";import{j as s}from"./jsx-runtime-u17CrQMm.js";import{B as A}from"./button-D6DGr86I.js";import*as ae from"https://esm.sh/@noble/ed25519@^3.0.0?bundle";import{sha256 as W,sha512 as re}from"https://esm.sh/@noble/hashes@^2.0.1/sha2?bundle";import{wordlist as L}from"https://esm.sh/@scure/bip39@^2.0.1/wordlists/english?bundle";import{f as oe,K}from"./crypto-BXWHoYI9.js";import{C as I}from"./check-CWX8rMms.js";import{C as ie}from"./copy-CzC7y2Qs.js";import{R as le}from"./refresh-cw-pTx9cW3g.js";import{T as de}from"./trash-2-DQbJ9aIh.js";import"./clsx-B-dksMZM.js";import"./createLucideIcon-DtX1aPOG.js";const v=({htmlFor:e,children:t,"data-testid":n})=>s.jsx("label",{htmlFor:e,className:"mb-2 block text-sm font-medium text-slate-300","data-testid":n,children:t});function ce(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function N(e,t=""){if(!Number.isSafeInteger(e)||e<0){const n=t&&`"${t}" `;throw new Error(`${n}expected integer >= 0, got ${e}`)}}function T(e,t,n=""){const o=ce(e),a=e?.length,l=t!==void 0;if(!o||l&&a!==t){const c=n&&`"${n}" `,h=l?` of length ${t}`:"",m=o?`length=${a}`:`type=${typeof e}`;throw new Error(c+"expected Uint8Array"+h+", got "+m)}return e}function O(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");N(e.outputLen),N(e.blockLen)}function M(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function U(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function ue(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const he=async()=>{};async function me(e,t,n){let o=Date.now();for(let a=0;a<e;a++){n(a);const l=Date.now()-o;l>=0&&l<t||(await he(),o+=l)}}function pe(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function F(e,t=""){return typeof e=="string"?pe(e):T(e,void 0,t)}function fe(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options must be object or undefined");return Object.assign(e,t)}class V{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,n){if(O(t),T(n,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,a=new Uint8Array(o);a.set(n.length>o?t.create().update(n).digest():n);for(let l=0;l<a.length;l++)a[l]^=54;this.iHash.update(a),this.oHash=t.create();for(let l=0;l<a.length;l++)a[l]^=106;this.oHash.update(a),U(a)}update(t){return M(this),this.iHash.update(t),this}digestInto(t){M(this),T(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:n,iHash:o,finished:a,destroyed:l,blockLen:c,outputLen:h}=this;return t=t,t.finished=a,t.destroyed=l,t.blockLen=c,t.outputLen=h,t.oHash=n._cloneInto(t.oHash),t.iHash=o._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const z=(e,t,n)=>new V(e,t).update(n).digest();z.create=(e,t)=>new V(e,t);function xe(e,t,n,o){O(e);const a=fe({dkLen:32,asyncTick:10},o),{c:l,dkLen:c,asyncTick:h}=a;if(N(l,"c"),N(c,"dkLen"),N(h,"asyncTick"),l<1)throw new Error("iterations (c) must be >= 1");const m=F(t,"password"),f=F(n,"salt"),d=new Uint8Array(c),x=z.create(e,m),w=x._cloneInto().update(f);return{c:l,dkLen:c,asyncTick:h,DK:d,PRF:x,PRFSalt:w}}function be(e,t,n,o,a){return e.destroy(),t.destroy(),o&&o.destroy(),U(a),n}async function ge(e,t,n,o){const{c:a,dkLen:l,asyncTick:c,DK:h,PRF:m,PRFSalt:f}=xe(e,t,n,o);let d;const x=new Uint8Array(4),w=ue(x),i=new Uint8Array(m.outputLen);for(let u=1,j=0;j<l;u++,j+=m.outputLen){const y=h.subarray(j,j+m.outputLen);w.setInt32(0,u,!1),(d=f._cloneInto(d)).update(x).digestInto(i),y.set(i.subarray(0,y.length)),await me(a-1,c,()=>{m._cloneInto(d).update(i).digestInto(i);for(let g=0;g<y.length;g++)y[g]^=i[g]})}return be(m,f,h,d,i)}function C(e){switch(e){case 3:return 32;case 6:return 64;case 9:return 96;case 12:return 128;case 15:return 160;case 18:return 192;case 21:return 224;case 24:return 256;default:throw new Error(`Unsupported word count: ${e}`)}}function D(e){return Array.from(e).map(t=>t.toString(2).padStart(8,"0")).join("")}function ye(e){const t=[];for(let n=0;n<e.length;n+=11){const o=parseInt(e.slice(n,n+11),2);t.push(L[o])}return t}function we(e){const t=C(e),n=crypto.getRandomValues(new Uint8Array(t/8)),o=W(n),a=t/32,l=D(o).slice(0,a),c=D(n)+l;return ye(c).join(" ")}function je(e){const t=e.trim().split(/\s+/);if(![3,6,9,12,15,18,21,24].includes(t.length)||!t.every(d=>L.includes(d)))return!1;const n=C(t.length),o=n/32;let a="";for(const d of t){const x=L.indexOf(d);a+=x.toString(2).padStart(11,"0")}const l=a.slice(0,n),c=a.slice(n),h=new Uint8Array(n/8);for(let d=0;d<n;d+=8)h[d/8]=parseInt(l.slice(d,d+8),2);const m=W(h),f=D(m).slice(0,o);return c===f}async function ke(e,t=""){const n=e.normalize("NFKD"),o="mnemonic"+t.normalize("NFKD");return await ge(re,n,o,{c:2048,dkLen:64})}async function ve(e){const t=e.slice(0,32),n=await ae.getPublicKeyAsync(t);return oe(n,t,"")}function Ne(e){return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}const S=L,Ce=({index:e,value:t,onChange:n})=>{const[o,a]=React.useState(!1),[l,c]=React.useState(0),[h,m]=React.useState(!1),f=React.useRef(null),d=React.useMemo(()=>{const i=t.trim().toLowerCase();return i===""&&h?S:!i||S.includes(i)?[]:S.filter(u=>u.startsWith(i))},[t,h]);React.useEffect(()=>{if(o&&f.current){const i=f.current.children[l];i&&i.scrollIntoView({block:"nearest"})}},[l,o]);const x=i=>{n(e,i),a(!1),m(!1)},w=i=>{if(i.key===" "&&t===""){i.preventDefault(),m(!0),a(!0);return}d.length!==0&&(i.key==="ArrowDown"?(i.preventDefault(),c(u=>(u+1)%d.length)):i.key==="ArrowUp"?(i.preventDefault(),c(u=>(u-1+d.length)%d.length)):i.key==="Enter"||i.key==="Tab"?d.length>0&&(i.key==="Enter"&&i.preventDefault(),x(d[l])):i.key==="Escape"&&a(!1))};return s.jsxs("div",{className:"relative",children:[s.jsxs(v,{htmlFor:`word-${e}`,className:"sr-only",children:["Word ",e+1]}),s.jsx("span",{className:"absolute top-1/2 left-2 z-10 -translate-y-1/2 text-[10px] text-slate-600",children:e+1}),s.jsx("input",{id:`word-${e}`,name:`word-${e}`,type:"text",value:t,autoComplete:"off",onChange:i=>{n(e,i.target.value.replace(/\s/g,"")),a(!0),c(0)},onFocus:()=>a(!0),onBlur:()=>setTimeout(()=>{a(!1),m(!1)},200),onKeyDown:w,placeholder:"word",className:`w-full rounded-lg border bg-slate-950 py-2 pr-2 pl-6 text-sm transition-all outline-none focus:ring-1 ${t&&!S.includes(t)?"border-red-500/50 focus:ring-red-500":"border-slate-800 focus:ring-indigo-500"}`,"data-testid":`word-input-${e}`}),o&&d.length>0&&s.jsx("div",{ref:f,className:"absolute top-full right-0 left-0 z-50 mt-1 max-h-48 overflow-y-auto rounded-lg border border-slate-800 bg-slate-900 py-1 shadow-xl","data-testid":`suggestions-${e}`,children:d.map((i,u)=>s.jsx("button",{onClick:()=>x(i),onMouseEnter:()=>c(u),className:`w-full px-3 py-1.5 text-left text-sm transition-colors ${u===l?"bg-indigo-500/20 text-indigo-300":"text-slate-400 hover:bg-slate-800"}`,"data-testid":`suggestion-${i}`,children:i},i))})]})},Se=({value:e,readOnly:t=!0,rows:n=8,"data-testid":o,className:a=""})=>s.jsx("textarea",{readOnly:t,value:e,rows:n,className:`w-full resize-none rounded-xl border border-slate-800 bg-slate-950 p-4 font-mono text-xs text-slate-300 focus:outline-none ${a}`,"data-testid":o}),E=({text:e,label:t,isCopied:n,onClick:o,fieldId:a,"data-testid":l})=>s.jsxs("button",{onClick:()=>o(e,a),className:"flex items-center gap-1.5 text-xs text-indigo-400 transition-colors hover:text-indigo-300","data-testid":l||`copy-btn-${a}`,children:[n?s.jsx(I,{className:"h-3.5 w-3.5","data-testid":"check-icon"}):s.jsx(ie,{className:"h-3.5 w-3.5","data-testid":"copy-icon"}),n?"Copied!":t]}),_=[3,6,9,12,15,18,21,24],Ie=()=>{const[e,t]=React.useState(12),[n,o]=React.useState(Array(12).fill("")),[a,l]=React.useState(""),[c,h]=React.useState(null),[m,f]=React.useState(null),[d,x]=React.useState(null),[w,i]=React.useState(!1),[u,j]=React.useState(!0),[y,g]=React.useState(""),k=React.useMemo(()=>n.map(r=>r.trim()).join(" "),[n]),$=React.useMemo(()=>je(k),[k]),R=React.useCallback(r=>{const p=r.trim().split(/\s+/).map(P=>P.toLowerCase().trim()),b=p.length;_.includes(b)?(t(b),o(p)):o(P=>{const B=Array(e).fill("");return p.slice(0,e).forEach((se,ne)=>{B[ne]=se}),B}),j(!0),g("")},[e]),q=React.useCallback(async()=>{try{const r=await ke(k,a);h(Ne(r));const p=await ve(r);f(p),i(!0)}catch(r){console.error("Failed to derive seed",r)}},[k,a]),J=r=>{t(r),o(p=>{const b=[...p];return r>p.length?[...b,...Array(r-p.length).fill("")]:b.slice(0,r)})},Q=r=>{r?R(y):g(k.replace(/\s+/g," ").trim()),j(r)},X=(r,p)=>{const b=[...n];b[r]=p.toLowerCase(),o(b)},Y=()=>{const r=we(e);o(r.split(" "))},Z=()=>{o(Array(e).fill("")),l(""),h(null),f(null),i(!1),g("")},ee=r=>{r.preventDefault();const p=r.clipboardData.getData("text");R(p)},te=()=>{R(y)},H=async(r,p)=>{try{await navigator.clipboard.writeText(r),x(p),setTimeout(()=>x(null),2e3)}catch(b){console.error("Failed to copy!",b)}};return s.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-950 text-slate-100 md:p-6",children:s.jsxs("div",{className:"w-full max-w-4xl rounded-2xl border border-slate-800 bg-slate-900 p-8 shadow-2xl",children:[s.jsxs("div",{className:"mb-8 flex items-center gap-3",children:[s.jsx("div",{className:"rounded-xl bg-indigo-500/10 p-3",children:s.jsx(K,{className:"h-8 w-8 text-indigo-400"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Keys Generator"}),s.jsx("p",{className:"text-sm text-slate-400",children:"Generate BIP-39 mnemonics and derive an Ed25519 key pair"})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"min-w-[200px]",role:"group","aria-labelledby":"word-count-label",children:[s.jsx("div",{id:"word-count-label",className:"mb-2 text-sm leading-none font-medium","data-testid":"word-count-label",children:"Word Count"}),s.jsx("div",{className:"grid grid-cols-4 gap-2 md:flex",children:_.map(r=>s.jsxs("button",{onClick:()=>J(r),className:`flex-1 rounded-lg border bg-slate-950 py-2 transition-all ${e===r?"border-indigo-500 bg-indigo-500/20 text-indigo-300":"border-slate-800 text-slate-400 hover:border-slate-700 hover:bg-slate-900"}`,"data-testid":`word-count-btn-${r}`,children:[s.jsxs("div",{className:"text-sm font-bold",children:[r,(r===3||r===6||r===9)&&"*"]}),s.jsxs("div",{className:"text-[10px] opacity-70",children:[C(r),"-bit"]})]},r))}),s.jsxs("p",{className:"mt-2 text-[10px] text-slate-500","data-testid":"entropy-info",children:["Selected Entropy: ",C(e)," bits (plus"," ",e*11-C(e)," bits checksum).",(e===3||e===6||e===9)&&s.jsx("span",{className:"ml-1 text-amber-500/80 italic",children:"* Not part of the official BIP-39 standard."})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[s.jsxs(v,{htmlFor:u?"word-0":"paste-mnemonic","data-testid":"mnemonic-label",children:["Mnemonic Words (",$?"✅ Valid":"❌ Invalid",")"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:`text-[10px] font-bold tracking-wider uppercase transition-colors ${u?"text-slate-500":"text-indigo-400"}`,children:"Paste"}),s.jsxs("label",{className:"relative inline-flex h-7 w-12 cursor-pointer items-center","data-testid":"toggle-paste-switch",children:[s.jsx("input",{id:"paste-mode-toggle",type:"checkbox",checked:u,onChange:r=>Q(r.target.checked),"aria-label":"Toggle between Paste area and List grid",className:"peer sr-only"}),s.jsx("span",{className:"absolute inset-0 rounded-full bg-slate-800 transition peer-checked:bg-indigo-600/50"}),s.jsx("span",{className:"relative left-1 h-5 w-5 rounded-full bg-slate-400 shadow-sm transition peer-checked:translate-x-5 peer-checked:bg-indigo-400"})]}),s.jsx("span",{className:`text-[10px] font-bold tracking-wider uppercase transition-colors ${u?"text-indigo-400":"text-slate-500"}`,children:"list"})]})]}),u?s.jsx("div",{onPaste:ee,className:"grid grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6","data-testid":"words-grid",children:n.map((r,p)=>s.jsx(Ce,{index:p,value:r,onChange:X},p))}):s.jsx("div",{className:"animate-in fade-in space-y-3 duration-300",children:s.jsx("textarea",{id:"paste-mnemonic",className:"h-32 w-full rounded-xl border border-slate-800 bg-slate-950 p-4 font-mono text-sm text-slate-300 transition-all outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Paste your mnemonic phrase here (e.g. 12, 15, 18, 21 or 24 words)...",value:y,onChange:r=>g(r.target.value),"data-testid":"paste-textarea",autoFocus:!0})})]}),s.jsxs("div",{children:[s.jsx(v,{htmlFor:"passphrase","data-testid":"extra-word-label",children:"Extra free word (optional)"}),s.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6",children:s.jsx("input",{id:"passphrase",type:"text",value:a,onChange:r=>l(r.target.value),placeholder:"Optional...",className:"w-full rounded-lg border border-slate-800 bg-slate-950 px-4 py-2 text-sm transition-all outline-none focus:border-transparent focus:ring-2 focus:ring-indigo-500","data-testid":"passphrase-input"})})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[s.jsx(A,{onClick:u?Y:te,className:"h-10 px-6","data-testid":u?"generate-button":"apply-import-button",children:u?s.jsxs(s.Fragment,{children:[s.jsx(le,{className:"mr-2 h-4 w-4"}),"Generate Random Words"]}):s.jsxs(s.Fragment,{children:[s.jsx(I,{className:"mr-2 h-4 w-4"}),"Import & Validate"]})}),s.jsxs(A,{onClick:Z,variant:"outline",className:"h-10 border-slate-700 px-6 text-slate-300 hover:bg-slate-800","data-testid":"clear-button",children:[s.jsx(de,{className:"mr-2 h-4 w-4"}),"Clear All"]})]}),s.jsxs(A,{onClick:q,disabled:n.every(r=>!r),className:"w-full py-6 text-base font-semibold","data-testid":"derive-button",children:[s.jsx(K,{className:"mr-2 h-5 w-5"}),"Derive Key"]}),w&&s.jsxs("div",{className:"animate-in fade-in slide-in-from-top-4 space-y-6 border-t border-slate-800 pt-6 duration-500","data-testid":"results-section",children:[$?s.jsxs("div",{className:"flex items-start gap-3 rounded-xl border border-emerald-500/20 bg-emerald-500/5 p-4","data-testid":"mnemonic-valid-info",children:[s.jsx(I,{className:"mt-0.5 h-5 w-5 shrink-0 text-emerald-400"}),s.jsxs("p",{className:"text-sm text-slate-300",children:[s.jsx("span",{className:"font-semibold text-emerald-300",children:"Mnemonic valid!"})," Derived key is shown below."]})]}):s.jsxs("div",{className:"flex items-start gap-3 rounded-xl border border-amber-500/20 bg-amber-500/5 p-4","data-testid":"checksum-warning",children:[s.jsx(I,{className:"mt-0.5 h-5 w-5 shrink-0 text-amber-400"}),s.jsxs("p",{className:"text-sm text-slate-300",children:[s.jsx("span",{className:"font-semibold text-amber-300",children:"Checksum Invalid."})," These keys are derived from the words provided, but this is not a standard BIP-39 mnemonic."]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[s.jsx(v,{"data-testid":"mnemonic-output-label",children:"Mnemonic Phrase (keep it safe as backup to regenerate this key later)"}),s.jsx(E,{text:k,label:"Copy Mnemonic",fieldId:"mnemonic",isCopied:d==="mnemonic",onClick:H,"data-testid":"copy-mnemonic-btn"})]}),s.jsx("div",{className:"rounded-xl border border-slate-800 bg-slate-950 p-4 font-mono text-xs break-all text-slate-400","data-testid":"mnemonic-output",children:k})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[s.jsx(v,{"data-testid":"seed-label",children:"Generated number (512-bit)"}),s.jsx(E,{text:c||"",label:"Copy Seed",fieldId:"seed",isCopied:d==="seed",onClick:H,"data-testid":"copy-seed-btn"})]}),s.jsxs("div",{className:"space-y-1 rounded-xl border border-slate-800 bg-slate-950 p-4 font-mono text-xs text-slate-400","data-testid":"seed-output",children:[s.jsx("div",{className:"break-all",children:c?.slice(0,64)}),s.jsx("div",{className:"break-all",children:c?.slice(64)})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[s.jsx(v,{"data-testid":"key-label",children:"Ed25519 Private Key (based on first 256-bit only)"}),s.jsx(E,{text:m||"",label:"Copy Private Key",fieldId:"ed25519",isCopied:d==="ed25519",onClick:H,"data-testid":"copy-key-btn"})]}),s.jsx(Se,{value:m||"","data-testid":"key-output"})]}),s.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-950/50 p-4","data-testid":"instructions-section",children:[s.jsx("p",{className:"mb-2 text-xs text-slate-400",children:"To generate the public key and verify the validity of the private key, you can run:"}),s.jsxs("code",{className:"block rounded-lg border border-slate-800/50 bg-slate-900/50 p-2 font-mono text-[10px] break-all whitespace-pre-wrap text-indigo-300",children:["$ ssh-keygen -yf ~/.ssh/id_ed25519_bip > ~/.ssh/id_ed25519_bip.pub",`
`,"$ chmod 600 ~/.ssh/id_ed25519_bip",`
`,"$ chmod 644 ~/.ssh/id_ed25519_bip.pub",`
`]})]})]})]})]})})},G=document.getElementById("root");if(!G)throw new Error("Root element #root not found");ReactDOM.createRoot(G).render(s.jsx(React.StrictMode,{children:s.jsx(Ie,{})}));
