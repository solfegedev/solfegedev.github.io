import{c as y}from"./createLucideIcon-DtX1aPOG.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{A as _}from"./api-CH_Pe6Vg.js";import{B as F}from"./button-3erh_Qe6.js";import{E as L}from"./eye-Jn_UhOO1.js";const $=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],q=y("eye-off",$);const B=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],U=y("plus",B),V=({appName:I,logo:m,loginEndpoint:j,registerEndpoint:u,onSuccess:v,className:N,initialMode:w="login"})=>{const[t,h]=React.useState(w==="register"),[g,i]=React.useState(!1),[x,r]=React.useState(null),[l,k]=React.useState(!1),[n,S]=React.useState(!0),[o,R]=React.useState(""),[d,C]=React.useState(""),[p,E]=React.useState(""),[f,P]=React.useState(""),A=async s=>{s.preventDefault(),r(null),i(!0);try{const a=t?u:j;if(!a)throw new Error("Endpoint not configured");const M=a.startsWith("http")?a:`${_}${a.startsWith("/")?"":"/"}${a}`,b=await fetch(M,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t?{email:o,password:d,first_name:p,last_name:f}:{email:o,password:d,remember:n})}),c=await b.json();if(!b.ok)throw new Error(c.detail||"Authentication failed");if(t&&!c.access_token){h(!1),r(null),alert("Account created! Please login."),i(!1);return}i(!1),v(c,n)}catch(a){r(a.message||"An error occurred"),i(!1)}},z=()=>{h(!t),r(null)};return e.jsx("div",{className:`flex min-h-screen items-center justify-center bg-slate-50 p-4 ${N}`,children:e.jsxs("div",{className:"w-full max-w-md space-y-8 rounded-2xl bg-white p-8 shadow-xl",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[m&&e.jsx("div",{className:"mb-4",children:m}),e.jsx("h2",{"data-testid":"auth-title",className:"text-center text-3xl font-bold tracking-tight text-slate-900",children:t?"Create an account":"Sign in"})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:A,children:[e.jsxs("div",{className:"space-y-4 rounded-md shadow-sm",children:[t&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first-name",className:"sr-only",children:"First Name"}),e.jsx("input",{id:"first-name","data-testid":"register-first-name",name:"firstName",type:"text",required:t,className:"relative block w-full rounded-md border-0 px-3 py-1.5 text-slate-900 ring-1 ring-slate-300 ring-inset placeholder:text-slate-400 focus:z-10 focus:ring-2 focus:ring-indigo-600 focus:ring-inset sm:text-sm sm:leading-6",placeholder:"First Name",value:p,onChange:s=>E(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last-name",className:"sr-only",children:"Last Name"}),e.jsx("input",{id:"last-name","data-testid":"register-last-name",name:"lastName",type:"text",required:t,className:"relative block w-full rounded-md border-0 px-3 py-1.5 text-slate-900 ring-1 ring-slate-300 ring-inset placeholder:text-slate-400 focus:z-10 focus:ring-2 focus:ring-indigo-600 focus:ring-inset sm:text-sm sm:leading-6",placeholder:"Last Name",value:f,onChange:s=>P(s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),e.jsx("input",{id:"email-address","data-testid":"login-email",name:"email",type:"email",autoComplete:"email",required:!0,className:"relative block w-full rounded-md border-0 px-3 py-1.5 text-slate-900 ring-1 ring-slate-300 ring-inset placeholder:text-slate-400 focus:z-10 focus:ring-2 focus:ring-indigo-600 focus:ring-inset sm:text-sm sm:leading-6",placeholder:"Email address",value:o,onChange:s=>R(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password","data-testid":"login-password",name:"password",type:l?"text":"password",autoComplete:t?"new-password":"current-password",required:!0,className:"relative block w-full rounded-md border-0 px-3 py-1.5 pr-10 text-slate-900 ring-1 ring-slate-300 ring-inset placeholder:text-slate-400 focus:z-10 focus:ring-2 focus:ring-indigo-600 focus:ring-inset sm:text-sm sm:leading-6",placeholder:"Password",value:d,onChange:s=>C(s.target.value)}),e.jsx("button",{type:"button","data-testid":"toggle-password-visibility",onClick:()=>k(!l),className:"absolute top-1/2 right-0 z-20 flex -translate-y-1/2 items-center pr-3 text-slate-400 hover:text-slate-600",children:l?e.jsx(L,{size:20}):e.jsx(q,{size:20})})]})]})]}),!t&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me","data-testid":"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-600",checked:n,onChange:s=>S(s.target.checked)}),e.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-slate-900",children:"Remember me"})]}),x&&e.jsx("div",{className:"rounded-md bg-red-50 p-4 text-sm text-red-700",children:x}),e.jsx("div",{children:e.jsx(F,{type:"submit","data-testid":"login-submit",disabled:g,className:"group relative flex w-full justify-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:opacity-70",children:g?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"mr-2 h-4 w-4 animate-spin",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):t?"Sign up":"Sign in"})})]}),u&&e.jsx("div",{className:"text-center text-sm",children:e.jsx("button",{"data-testid":"toggle-auth-mode",onClick:z,className:"font-medium text-indigo-600 hover:text-indigo-500",children:t?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})})};export{V as A,U as P};
