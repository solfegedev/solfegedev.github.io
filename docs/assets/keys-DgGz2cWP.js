import"./index-sgIQaVno.js";import{j as i}from"./jsx-runtime-u17CrQMm.js";const xt=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mt=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,s)=>s?s.toUpperCase():n.toLowerCase()),q=t=>{const e=mt(t);return e.charAt(0).toUpperCase()+e.slice(1)},ot=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim(),yt=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var bt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const gt=React.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:o,iconNode:c,...f},l)=>React.createElement("svg",{ref:l,...bt,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:ot("lucide",r),...!o&&!yt(f)&&{"aria-hidden":"true"},...f},[...c.map(([d,u])=>React.createElement(d,u)),...Array.isArray(o)?o:[o]]));const Z=(t,e)=>{const n=React.forwardRef(({className:s,...r},o)=>React.createElement(gt,{ref:o,iconNode:e,className:ot(`lucide-${xt(q(t))}`,`lucide-${t}`,s),...r}));return n.displayName=q(t),n};const wt=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],z=Z("check",wt);const vt=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Nt=Z("copy",vt);const jt=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],kt=Z("key",jt);const At=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Bt=Z("lock",At);const Et=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],W=Z("refresh-cw",Et);const rt={p:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,n:0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,h:8n,a:0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n},{p:w,n:X,Gx:J,Gy:Q,a:G,d:D,h:Ct}=rt,Y=32,at=64,Rt=(...t)=>{"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(...t)},g=(t="")=>{const e=new Error(t);throw Rt(e,g),e},St=t=>typeof t=="bigint",Tt=t=>typeof t=="string",_t=t=>t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array",U=(t,e,n="")=>{const s=_t(t),r=t?.length,o=e!==void 0;if(!s||o&&r!==e){const c=n&&`"${n}" `,f=o?` of length ${e}`:"",l=s?`length=${r}`:`type=${typeof t}`;g(c+"expected Uint8Array"+f+", got "+l)}return t},H=t=>new Uint8Array(t),ct=t=>Uint8Array.from(t),it=(t,e)=>t.toString(16).padStart(e,"0"),lt=t=>Array.from(U(t)).map(e=>it(e,2)).join(""),k={_0:48,_9:57,A:65,F:70,a:97,f:102},tt=t=>{if(t>=k._0&&t<=k._9)return t-k._0;if(t>=k.A&&t<=k.F)return t-(k.A-10);if(t>=k.a&&t<=k.f)return t-(k.a-10)},ft=t=>{const e="hex invalid";if(!Tt(t))return g(e);const n=t.length,s=n/2;if(n%2)return g(e);const r=H(s);for(let o=0,c=0;o<s;o++,c+=2){const f=tt(t.charCodeAt(c)),l=tt(t.charCodeAt(c+1));if(f===void 0||l===void 0)return g(e);r[o]=f*16+l}return r},Kt=()=>globalThis?.crypto,Zt=()=>Kt()?.subtle??g("crypto.subtle must be defined, consider polyfill"),dt=(...t)=>{const e=H(t.reduce((s,r)=>s+U(r).length,0));let n=0;return t.forEach(s=>{e.set(s,n),n+=s.length}),e},L=BigInt,E=(t,e,n,s="bad number: out of range")=>St(t)&&e<=t&&t<n?t:g(s),a=(t,e=w)=>{const n=t%e;return n>=0n?n:e+n},Ut=t=>a(t,X),Pt=(t,e)=>{(t===0n||e<=0n)&&g("no inverse n="+t+" mod="+e);let n=a(t,e),s=e,r=0n,o=1n;for(;n!==0n;){const c=s/n,f=s%n,l=r-o*c;s=n,n=f,r=o,o=l}return s===1n?a(r,e):g("no inverse")},M=t=>t instanceof N?t:g("Point expected"),O=2n**256n;class N{static BASE;static ZERO;X;Y;Z;T;constructor(e,n,s,r){const o=O;this.X=E(e,0n,o),this.Y=E(n,0n,o),this.Z=E(s,1n,o),this.T=E(r,0n,o),Object.freeze(this)}static CURVE(){return rt}static fromAffine(e){return new N(e.x,e.y,1n,a(e.x*e.y))}static fromBytes(e,n=!1){const s=D,r=ct(U(e,Y)),o=e[31];r[31]=o&-129;const c=ut(r);E(c,0n,n?O:w);const l=a(c*c),d=a(l-1n),u=a(s*l+1n);let{isValid:m,value:p}=Lt(d,u);m||g("bad point: y not sqrt");const y=(p&1n)===1n,h=(o&128)!==0;return!n&&p===0n&&h&&g("bad point: x==0, isLastByteOdd"),h!==y&&(p=a(-p)),new N(p,c,1n,a(p*c))}static fromHex(e,n){return N.fromBytes(ft(e),n)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}assertValidity(){const e=G,n=D,s=this;if(s.is0())return g("bad point: ZERO");const{X:r,Y:o,Z:c,T:f}=s,l=a(r*r),d=a(o*o),u=a(c*c),m=a(u*u),p=a(l*e),y=a(u*a(p+d)),h=a(m+a(n*a(l*d)));if(y!==h)return g("bad point: equation left != right (1)");const v=a(r*o),x=a(c*f);return v!==x?g("bad point: equation left != right (2)"):this}equals(e){const{X:n,Y:s,Z:r}=this,{X:o,Y:c,Z:f}=M(e),l=a(n*f),d=a(o*r),u=a(s*f),m=a(c*r);return l===d&&u===m}is0(){return this.equals(T)}negate(){return new N(a(-this.X),this.Y,this.Z,a(-this.T))}double(){const{X:e,Y:n,Z:s}=this,r=G,o=a(e*e),c=a(n*n),f=a(2n*a(s*s)),l=a(r*o),d=e+n,u=a(a(d*d)-o-c),m=l+c,p=m-f,y=l-c,h=a(u*p),v=a(m*y),x=a(u*y),A=a(p*m);return new N(h,v,A,x)}add(e){const{X:n,Y:s,Z:r,T:o}=this,{X:c,Y:f,Z:l,T:d}=M(e),u=G,m=D,p=a(n*c),y=a(s*f),h=a(o*m*d),v=a(r*l),x=a((n+s)*(c+f)-p-y),A=a(v-h),C=a(v+h),R=a(y-u*p),B=a(x*A),b=a(C*R),P=a(x*R),I=a(A*C);return new N(B,b,I,P)}subtract(e){return this.add(M(e).negate())}multiply(e,n=!0){if(!n&&(e===0n||this.is0()))return T;if(E(e,1n,X),e===1n)return this;if(this.equals(_))return It(e).p;let s=T,r=_;for(let o=this;e>0n;o=o.double(),e>>=1n)e&1n?s=s.add(o):n&&(r=r.add(o));return s}multiplyUnsafe(e){return this.multiply(e,!1)}toAffine(){const{X:e,Y:n,Z:s}=this;if(this.equals(T))return{x:0n,y:1n};const r=Pt(s,w);a(s*r)!==1n&&g("invalid inverse");const o=a(e*r),c=a(n*r);return{x:o,y:c}}toBytes(){const{x:e,y:n}=this.assertValidity().toAffine(),s=Xt(n);return s[31]|=e&1n?128:0,s}toHex(){return lt(this.toBytes())}clearCofactor(){return this.multiply(L(Ct),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let e=this.multiply(X/2n,!1).double();return X%2n&&(e=e.add(this)),e.is0()}}const _=new N(J,Q,1n,a(J*Q)),T=new N(0n,1n,1n,0n);N.BASE=_;N.ZERO=T;const Xt=t=>ft(it(E(t,0n,O),at)).reverse(),ut=t=>L("0x"+lt(ct(U(t)).reverse())),j=(t,e)=>{let n=t;for(;e-- >0n;)n*=n,n%=w;return n},Yt=t=>{const n=t*t%w*t%w,s=j(n,2n)*n%w,r=j(s,1n)*t%w,o=j(r,5n)*r%w,c=j(o,10n)*o%w,f=j(c,20n)*c%w,l=j(f,40n)*f%w,d=j(l,80n)*l%w,u=j(d,80n)*l%w,m=j(u,10n)*o%w;return{pow_p_5_8:j(m,2n)*t%w,b2:n}},et=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,Lt=(t,e)=>{const n=a(e*e*e),s=a(n*n*e),r=Yt(t*s).pow_p_5_8;let o=a(t*n*r);const c=a(e*o*o),f=o,l=a(o*et),d=c===t,u=c===a(-t),m=c===a(-t*et);return d&&(o=f),(u||m)&&(o=l),(a(o)&1n)===1n&&(o=a(-o)),{isValid:d||u,value:o}},Ft=t=>Ut(ut(t)),Vt=(...t)=>Ot.sha512Async(dt(...t)),Gt=t=>{const e=t.slice(0,Y);e[0]&=248,e[31]&=127,e[31]|=64;const n=t.slice(Y,at),s=Ft(e),r=_.multiply(s),o=r.toBytes();return{head:e,prefix:n,scalar:s,point:r,pointBytes:o}},Dt=t=>Vt(U(t,Y)).then(Gt),Mt=t=>Dt(t).then(e=>e.pointBytes),Ot={sha512Async:async t=>{const e=Zt(),n=dt(t);return H(await e.digest("SHA-512",n.buffer))},sha512:void 0},F=8,$t=256,ht=Math.ceil($t/F)+1,$=2**(F-1),Ht=()=>{const t=[];let e=_,n=e;for(let s=0;s<ht;s++){n=e,t.push(n);for(let r=1;r<$;r++)n=n.add(e),t.push(n);e=n.double()}return t};let nt;const st=(t,e)=>{const n=e.negate();return t?n:e},It=t=>{const e=nt||(nt=Ht());let n=T,s=_;const r=2**F,o=r,c=L(r-1),f=L(F);for(let l=0;l<ht;l++){let d=Number(t&c);t>>=f,d>$&&(d-=o,t+=1n);const u=l*$,m=u,p=u+Math.abs(d)-1,y=l%2!==0,h=d<0;d===0?s=s.add(st(y,e[m])):n=n.add(st(h,e[p]))}return t!==0n&&g("invalid wnaf"),{p:n,f:s}};function qt(t){return btoa(String.fromCodePoint(...t))}function S(t,e,n){const s=new TextEncoder().encode(n);return t.setUint32(e,s.length),new Uint8Array(t.buffer).set(s,e+4),e+4+s.length}function K(t,e,n){return t.setUint32(e,n.length),new Uint8Array(t.buffer).set(n,e+4),e+4+n.length}function zt(t,e,n="deterministic-key"){const s=new TextEncoder().encode("openssh-key-v1\0"),r="ssh-ed25519",o=new Uint8Array(4+r.length+4+t.length),c=new DataView(o.buffer);let f=0;f=S(c,f,r),f=K(c,f,t);const d=new DataView(e.buffer,0,4).getUint32(0),u=new Uint8Array(e.length+t.length);u.set(e),u.set(t,e.length);const m=1024,p=new Uint8Array(m),y=new DataView(p.buffer);let h=0;y.setUint32(h,d),h+=4,y.setUint32(h,d),h+=4,h=S(y,h,r),h=K(y,h,t),h=K(y,h,u),h=S(y,h,n);const v=8,x=v-h%v;if(x>0&&x<v)for(let V=0;V<x;V++)p[h++]=V+1;const A=p.slice(0,h),C=2048,R=new Uint8Array(C),B=new DataView(R.buffer);let b=0;R.set(s,b),b+=s.length,b=S(B,b,"none"),b=S(B,b,"none"),b=S(B,b,""),B.setUint32(b,1),b+=4,b=K(B,b,o),b=K(B,b,A);const P=qt(R.slice(0,b));return`-----BEGIN OPENSSH PRIVATE KEY-----
${P.match(/.{1,70}/g)?.join(`
`)||P}
-----END OPENSSH PRIVATE KEY-----`}async function Wt(t,e,n=1e7){const s=new TextEncoder,r=await crypto.subtle.importKey("raw",s.encode(t),{name:"PBKDF2"},!1,["deriveBits"]),o="SHA-256",c=s.encode(e),f=await crypto.subtle.deriveBits({name:"PBKDF2",salt:c,iterations:n,hash:o},r,256),l=new Uint8Array(f),d=await Mt(l);return{privateKey:zt(d,l,e),iterations:n}}const Jt=()=>{const[t,e]=React.useState(""),[n,s]=React.useState("id_ed25519"),[r,o]=React.useState(1e7),[c,f]=React.useState(null),[l,d]=React.useState(null),[u,m]=React.useState(!1),[p,y]=React.useState(null),h=React.useCallback(async()=>{if(!(!t||!n)){m(!0);try{const x=await Wt(t,n,r);d(x),f(x.iterations)}catch(x){console.error("Generation failed",x)}finally{m(!1)}}},[t,n,r]),v=async(x,A)=>{try{await navigator.clipboard.writeText(x),y(A),setTimeout(()=>y(null),2e3)}catch(C){console.error("Failed to copy!",C)}};return i.jsx("div",{className:"min-h-screen bg-slate-950 text-slate-100 flex items-center justify-center p-6",children:i.jsxs("div",{className:"w-full max-w-2xl bg-slate-900 border border-slate-800 rounded-2xl shadow-2xl p-8",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[i.jsx("div",{className:"p-3 bg-indigo-500/10 rounded-xl",children:i.jsx(kt,{className:"w-8 h-8 text-indigo-400"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold",children:"Deterministic SSH Key Generator"}),i.jsx("p",{className:"text-slate-400 text-sm",children:"Generate Ed25519 keys from a passphrase and key name"})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"key-name",className:"block text-sm font-medium text-slate-300 mb-2",children:"Key Name (Salt)"}),i.jsx("input",{id:"key-name",type:"text",value:n,onChange:x=>s(x.target.value),placeholder:"id_ed25519",className:"w-full bg-slate-950 border border-slate-800 rounded-xl py-3 px-4 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all"}),i.jsx("p",{className:"mt-2 text-[10px] text-slate-500",children:"Used as a salt for the key derivation."})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"iterations",className:"block text-sm font-medium text-slate-300 mb-2",children:"PBKDF2 Iterations"}),i.jsx("input",{id:"iterations",type:"number",value:r,onChange:x=>o(parseInt(x.target.value)||0),className:"w-full bg-slate-950 border border-slate-800 rounded-xl py-3 px-4 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all"}),i.jsx("p",{className:"mt-2 text-[10px] text-slate-500",children:"Number of iterations for PBKDF2. Higher is more secure but slower."})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"passphrase",className:"block text-sm font-medium text-slate-300 mb-2",children:"Passphrase"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{id:"passphrase",type:"password",value:t,onChange:x=>e(x.target.value),placeholder:"Enter a strong passphrase...",className:"w-full bg-slate-950 border border-slate-800 rounded-xl py-3 px-4 pl-12 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all"}),i.jsx(Bt,{className:"w-5 h-5 text-slate-500 absolute left-4 top-1/2 -translate-y-1/2"})]}),i.jsxs("p",{className:"mt-2 text-[10px] text-slate-500",children:["Keep it secret!"," ",c?`PBKDF2 with ${c.toLocaleString()} iterations.`:"Keys are derived using PBKDF2."]})]}),i.jsxs("button",{onClick:h,disabled:!t||!n||u,className:"w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-xl transition-colors flex items-center justify-center gap-2",children:[u?i.jsx(W,{className:"w-5 h-5 animate-spin"}):i.jsx(W,{className:"w-5 h-5"}),"Generate Key Pair"]}),l&&i.jsxs("div",{className:"space-y-6 pt-6 border-t border-slate-800 animate-in fade-in slide-in-from-top-4 duration-500",children:[i.jsxs("div",{className:"bg-indigo-500/5 border border-indigo-500/20 rounded-xl p-4 flex gap-3 items-start",children:[i.jsx(z,{className:"w-5 h-5 text-indigo-400 shrink-0 mt-0.5"}),i.jsxs("p",{className:"text-sm text-slate-300",children:[i.jsx("span",{className:"font-semibold text-indigo-300",children:"Key generated!"})," To recreate this exact key pair in the future, you will need the"," ",i.jsx("span",{className:"text-slate-100 font-medium",children:"Key Name (used as salt)"}),", the"," ",i.jsx("span",{className:"text-slate-100 font-medium",children:"Passphrase"})," and the"," ",i.jsx("span",{className:"text-slate-100 font-medium",children:"number of iterations"})," (",c?.toLocaleString(),")."]})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("label",{htmlFor:"private-key",className:"text-sm font-medium text-slate-300",children:["Private Key ",n]}),i.jsxs("button",{onClick:()=>v(l.privateKey,"private"),className:"text-xs flex items-center gap-1.5 text-indigo-400 hover:text-indigo-300 transition-colors",children:[p==="private"?i.jsx(z,{className:"w-3.5 h-3.5"}):i.jsx(Nt,{className:"w-3.5 h-3.5"}),p==="private"?"Copied!":`Copy ${n}`]})]}),i.jsx("textarea",{id:"private-key",readOnly:!0,value:l.privateKey,className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-4 text-xs font-mono text-slate-300 h-48 resize-none focus:outline-none"})]}),i.jsxs("div",{className:"bg-slate-950/50 border border-slate-800 rounded-xl p-4",children:[i.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"To generate the public key and verify the validity of the private key, you can run:"}),i.jsxs("code",{className:"text-[10px] text-indigo-300 break-all block bg-slate-900/50 p-2 rounded-lg border border-slate-800/50",children:["ssh-keygen -yf ~/.ssh/",n," > ~/.ssh/",n,".pub"]})]})]})]})]})})},pt=document.getElementById("root");if(!pt)throw new Error("Root element #root not found");ReactDOM.createRoot(pt).render(i.jsx(React.StrictMode,{children:i.jsx(Jt,{})}));
