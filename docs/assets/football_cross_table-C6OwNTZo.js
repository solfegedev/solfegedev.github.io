import"./index-Cm_Ydr0l.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{A as u}from"./api-CH_Pe6Vg.js";const j=({message:t="Loading..."})=>e.jsx("div",{className:"flex items-center justify-center rounded-md border border-slate-700/50 bg-slate-800/20 py-20 md:rounded-xl","data-testid":"loading-spinner",children:e.jsx("div",{className:"animate-pulse text-xl font-semibold text-slate-400",children:t})}),f=({name:t,iconUrl:n,size:d="md",className:o=""})=>{const l={sm:"h-5 w-5",md:"h-6 w-6"};return n?e.jsx("img",{src:n,alt:t,className:`${l[d]} mx-auto object-contain ${o}`,"data-testid":"team-logo"}):e.jsxs("div",{className:`flex items-center justify-center font-bold text-slate-200 ${o}`,"data-testid":"team-logo-fallback",children:[e.jsx("span",{className:"hidden md:inline",children:t.substring(0,3).toUpperCase()}),e.jsx("span",{className:"md:hidden",children:t.substring(0,2).toUpperCase()})]})},w=({match:t,weeksInProgress:n,nextWeek:d,formatKickoff:o})=>{if(!t)return e.jsx("td",{className:"h-10 border-r border-slate-800/50 p-1 text-center align-middle md:h-12 md:p-2","data-testid":"cross-table-cell-empty",children:e.jsx("span",{className:"text-slate-700",children:"-"})});const l=n.includes(t.match_week),c=!["PreMatch","Postponed"].includes(t.period);return e.jsx("td",{className:"h-10 border-r border-slate-800/50 p-1 text-center align-middle md:h-12 md:p-2","data-testid":`match-cell-${t.home_team_id}-${t.away_team_id}`,children:c?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:`text-lg font-bold ${l?"text-orange-600":"text-indigo-300"}`,"data-testid":"match-score",children:[t.home_score,e.jsx("span",{className:"mx-0.5 text-slate-600",children:"-"}),t.away_score]}),t.period!=="FullTime"&&e.jsx("span",{className:"-mt-1 animate-pulse text-[8px] font-bold text-red-500 uppercase","data-testid":"match-live",children:t.period})]}):e.jsx("div",{className:`text-[10px] leading-tight md:text-xs ${l?"font-bold text-yellow-300":t.match_week===d?"font-bold text-green-500":"text-slate-500"}`,"data-testid":"match-kickoff",children:o(t.kickoff,l||d===t.match_week)})})},m=({color:t,label:n})=>{const d={orange:"bg-orange-600 shadow-[0_0_8px_rgba(234,88,12,0.4)]",yellow:"bg-yellow-300 shadow-[0_0_8px_rgba(253,224,71,0.4)]",green:"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]"};return e.jsxs("div",{className:"flex items-center gap-2","data-testid":"status-dot",children:[e.jsx("span",{className:`h-2 w-2 rounded-full ${d[t]||""}`}),e.jsx("span",{className:"text-[10px] text-slate-400 md:text-xs",children:n})]})},_=()=>e.jsxs("footer",{className:"mt-8 flex flex-col gap-4 border-t border-slate-800 px-6 pt-6 md:flex-row md:gap-8","data-testid":"cross-table-legend",children:[e.jsx(m,{color:"orange",label:"result for this week"}),e.jsx(m,{color:"yellow",label:"time before kick-off this week"}),e.jsx(m,{color:"green",label:"time before kick-off next week"})]}),N=(t,n)=>{const d=new Date(t);if(n){const c=new Date,i=d.getTime()-c.getTime();if(i>0){const x=Math.floor(i/864e5),s=Math.floor(i%(1e3*60*60*24)/(1e3*60*60)),a=Math.floor(i%(1e3*60*60)/(1e3*60));let r="";return x>0&&(r+=`${x}d `),r+=`${s}h${a.toString().padStart(2,"0")}`,r}}const o=d.getDate(),l=d.toLocaleString("en-GB",{month:"short"});return`${o} ${l}`},y=()=>{const[t,n]=React.useState(null),[d,o]=React.useState(!0),[l,c]=React.useState(null);React.useEffect(()=>{(async()=>{try{const a=await fetch(`${u}/football/cross-table`);if(!a.ok)throw new Error("Failed to fetch cross table data");const r=await a.json();n(r)}catch(a){c(a instanceof Error?a.message:"Unknown error")}finally{o(!1)}})()},[]);const i=(s,a)=>{if(t)return t.matches.find(r=>r.home_team_id===s&&r.away_team_id===a)},x=t?Math.max(...t.teams.map(s=>s.played),0):0;return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-[radial-gradient(circle_at_top,_rgba(79,70,229,0.7),_transparent_55%),_#050816] py-0 font-sans text-slate-100 md:px-6 md:py-10","data-testid":"cross-table-page",children:e.jsxs("div",{className:"w-full max-w-[100vw] rounded-[1rem] border border-slate-400/20 bg-slate-900/70 py-4 shadow-[0_25px_60px_rgba(2,6,23,0.8)] backdrop-blur-[18px] md:max-w-[85vw] md:p-10","data-testid":"cross-table-container",children:[e.jsx("header",{className:"mb-4 flex flex-col gap-3 text-left",children:e.jsx("h1",{className:"px-4 text-2xl leading-tight font-semibold text-white md:text-4xl","data-testid":"page-title",children:"Premier League Table"})}),d?e.jsx(j,{message:"Loading cross table..."}):l?e.jsx("div",{className:"flex items-center justify-center rounded-md border border-red-500/20 bg-red-900/10 py-20 md:rounded-xl","data-testid":"error-state",children:e.jsxs("div",{className:"text-center text-xl font-semibold text-red-400",children:[e.jsx("p",{children:"Error loading data"}),e.jsx("p",{className:"mt-2 text-sm font-normal text-red-300/80",children:l})]})}):!t||t.teams.length===0?e.jsx("div",{className:"flex items-center justify-center rounded-md border border-slate-700/50 bg-slate-800/20 py-20 md:rounded-xl","data-testid":"no-data-state",children:e.jsx("div",{className:"text-xl font-semibold text-slate-400",children:"No data available."})}):e.jsx("div",{className:"w-full overflow-x-auto rounded-md border border-slate-700/50 bg-slate-950/30 md:rounded-xl","data-testid":"table-wrapper",children:e.jsxs("table",{className:"min-w-full border-collapse text-[10px] text-slate-300 md:text-xs","data-testid":"cross-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 min-w-[40px] border-b border-slate-700 bg-indigo-900 p-2"}),e.jsx("th",{className:"min-w-[80px] border-r border-b border-slate-700 bg-indigo-900 p-2 text-left font-bold text-slate-200 md:min-w-[120px]","data-testid":"header-corner",children:"Home \\ Away"}),t.teams.map(s=>e.jsx("th",{className:"min-w-[40px] border-b border-slate-700 bg-indigo-900/80 p-2 text-center font-bold text-slate-200 md:min-w-[60px]",title:s.name,"data-testid":`header-team-${s.id}`,children:e.jsx(f,{name:s.name,iconUrl:s.icon_url})},s.id)),[{label:"Pts"},{label:"P"},{label:"GD"},{label:"W"},{label:"D"},{label:"L"},{label:"F"},{label:"A"}].map(s=>e.jsx("th",{className:"min-w-[30px] border-b border-slate-700 bg-indigo-900/80 p-2 text-center font-bold text-indigo-200","data-testid":`header-stat-${s.label}`,children:s.label},s.label))]})}),e.jsx("tbody",{className:"divide-y divide-slate-800",children:t.teams.map(s=>e.jsxs("tr",{className:"transition-colors hover:bg-slate-800/50","data-testid":`row-team-${s.id}`,children:[e.jsx("th",{className:"sticky left-0 z-10 min-w-[40px] border-slate-700 bg-slate-900 p-2 shadow-[2px_0_5px_rgba(0,0,0,0.3)]",children:s.icon_url&&e.jsx(f,{name:s.name,iconUrl:s.icon_url,size:"sm"})}),e.jsx("th",{className:"min-w-[80px] border-r border-slate-700 bg-slate-900 p-2 text-left font-semibold whitespace-nowrap text-slate-200 md:min-w-[120px]","data-testid":`row-team-name-${s.id}`,children:e.jsx("span",{className:"max-w-[6rem] truncate md:max-w-none",title:s.name,children:s.name})}),t.teams.map(a=>{if(s.id===a.id)return e.jsx("td",{className:"border-r border-slate-800 bg-slate-800/50","data-testid":"diagonal-cell"},a.id);const r=i(s.id,a.id);return e.jsx(w,{match:r,weeksInProgress:t.weeks_in_progress,nextWeek:t.next_week,formatKickoff:N},a.id)}),[{key:"points",className:"font-bold text-lg",testId:"pts"},{key:"played",className:a=>a.played<x?"text-yellow-500":"",testId:"p"},{key:"goal_difference",className:"font-medium",format:a=>a>0?`+${a}`:a,testId:"gd"},{key:"won",testId:"w"},{key:"drawn",testId:"d"},{key:"lost",testId:"l"},{key:"goals_for",testId:"f"},{key:"goals_against",testId:"a"}].map(({key:a,className:r,format:b,testId:g})=>{const p=s[a],h=typeof r=="function"?r(s):r||"";return e.jsx("td",{className:`border-r border-slate-800/50 bg-indigo-900/80 p-1 text-center md:p-2 ${h}`,"data-testid":`stat-${g}-${s.id}`,children:b?b(p):p},a)})]},s.id))})]})}),t&&t.teams.length>0&&!d&&!l&&e.jsx(_,{})]})})};document.body.classList.add("football-page");ReactDOM.createRoot(document.getElementById("root")).render(e.jsx(React.StrictMode,{children:e.jsx(y,{})}));
