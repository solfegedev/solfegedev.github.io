import"./modulepreload-polyfill-B5Qt9EMX.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{B as $}from"./button-UTh2Cu_R.js";import{A as Ue}from"./api-CH_Pe6Vg.js";const de="todo.jwt",ge=a=>{if(!a)return null;if(typeof a=="string"){const o=a.trim();return o||null}if(Array.isArray(a)){for(const o of a){const c=ge(o);if(c)return c}return null}if(typeof a=="object"){const o=a;if("detail"in o){const i=ge(o.detail);if(i)return i}if(typeof o.msg=="string"){const i=o.msg.trim();if(i)return i}if(typeof o.message=="string"){const i=o.message.trim();if(i)return i}const c=Object.values(o).find(i=>typeof i=="string"&&!!i.trim());return c?c.trim():null}return null},at=()=>{const a=React.useMemo(()=>`${Ue}/auth`,[]),[o,c]=React.useState(()=>typeof window>"u"?null:window.localStorage.getItem(de)),[i,k]=React.useState(null),[L,E]=React.useState(!1),[w,p]=React.useState(null),[V,z]=React.useState(!1),_=React.useCallback(d=>{c(d),!(typeof window>"u")&&(d?window.localStorage.setItem(de,d):window.localStorage.removeItem(de))},[]),x=React.useCallback(d=>{p(d||null),_(null),k(null)},[_]),F=React.useCallback(async d=>{const y=await fetch(`${a}/me`,{headers:{Authorization:`Bearer ${d}`}});if(!y.ok)throw new Error(y.status===401?"Session expired. Please log in again.":"Unable to load profile.");const h=await y.json();k({id:h.id,email:h.email}),p(null)},[a]);React.useEffect(()=>{if(!o){k(null),E(!0);return}E(!1),F(o).catch(d=>{const y=d instanceof Error?d.message:"Session expired.";x(y)}).finally(()=>{E(!0)})},[x,F,o]);const f=React.useCallback(async(d,y)=>{z(!0),p(null);try{const h=await fetch(`${a}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,password:y})});if(!h.ok){const S=await h.json().catch(()=>null),le=ge(S)??"Invalid credentials";throw new Error(le)}const N=await h.json();_(N.access_token),await F(N.access_token)}catch(h){const N=h instanceof Error?h.message:"Unable to log in.";throw x(N),new Error(N)}finally{z(!1)}},[a,x,F,_]),D=React.useCallback(()=>{x()},[x]),j=React.useCallback(async(d,y)=>{if(!o)throw new Error("Not authenticated");const h=new Headers(y?.headers);h.set("Authorization",`Bearer ${o}`);const N=await fetch(d,{...y,headers:h});if(N.status===401)throw x("Session expired. Please log in again."),new Error("Session expired. Please log in again.");return N},[x,o]),O=React.useCallback(()=>p(null),[]);return{user:i,token:o,ready:L,isAuthenticated:!!(i&&o),login:f,logout:D,authenticatedFetch:j,sessionError:w,clearSessionError:O,loginPending:V}},ot=a=>a.toISOString().split("T")[0],ue=()=>{const a=ot(new Date);return{name:"",description:"",startDate:a,dueDate:a,category:"",isCompleted:!1}},G=a=>{const o=a.slice(0,10),[c,i,k]=o.split("-"),L=Number(c),E=Number(i),w=Number(k);if([L,E,w].some(p=>Number.isNaN(p))){const p=new Date(a);return p.setHours(0,0,0,0),p}return new Date(L,E-1,w)},_e=()=>{const a=new Date;return a.setHours(0,0,0,0),a},nt=1440*60*1e3,lt=a=>({name:a.name,description:a.description,startDate:a.start_date,dueDate:a.due_date,category:a.category,isCompleted:a.is_completed}),A=`${Ue}/tasks`,$e="NONE",Pe="todoLastLoginEmail",me=()=>{if(typeof window>"u")return"";try{return window.localStorage.getItem(Pe)??""}catch{return""}},rt=a=>{if(typeof window>"u")return;const o=a.trim();if(o)try{window.localStorage.setItem(Pe,o)}catch{}},Ae=a=>{const o=G(a);return Number.isNaN(o.valueOf())?a:new Intl.DateTimeFormat(void 0,{weekday:"short",month:"short",day:"numeric",year:"numeric"}).format(o)},Oe=(a,o=!1)=>{if(o)return!1;const c=_e(),i=G(a);return i.setHours(0,0,0,0),i<c},ct=a=>{const o=G(a);if(Number.isNaN(o.valueOf()))return 0;o.setHours(0,0,0,0);const c=_e();return Math.round((o.getTime()-c.getTime())/nt)},it=a=>a>0?`+${a}d`:`${a}d`,Ie=a=>a.trim().toUpperCase().replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,""),fe=a=>{const o=_e(),c=G(a);return c.setHours(0,0,0,0),c.getTime()<=o.getTime()},he=a=>a.is_completed?{label:"Completed",modifier:"todo-status--completed"}:fe(a.start_date)?{label:"Active",modifier:"todo-status--active"}:{label:"Blocked",modifier:"todo-status--blocked"},dt=()=>{const[a,o]=React.useState([]),[c,i]=React.useState(ue),[k,L]=React.useState(!0),[E,w]=React.useState(null),[p,V]=React.useState(!1),[z,_]=React.useState(null),[x,F]=React.useState(null),[f,D]=React.useState([]),[j,O]=React.useState(null),[d,y]=React.useState(!1),[h,N]=React.useState(!1),[S,le]=React.useState({key:"due_date",direction:"asc"}),[Y,J]=React.useState(()=>new Set),[W,pe]=React.useState(!1),[be,H]=React.useState(null),[K,re]=React.useState(!1),[I,ye]=React.useState({label:"",slug:""}),[xe,je]=React.useState(!1),[ve,ke]=React.useState(!1),[we,C]=React.useState(null),{user:Me,ready:Z,isAuthenticated:g,login:Ne,logout:Se,authenticatedFetch:v,sessionError:Ce,clearSessionError:Q,loginPending:Re}=at(),[Ee,q]=React.useState(!1),[U,X]=React.useState(()=>({email:me(),password:""})),[ee,te]=React.useState(null),R=React.useCallback(()=>{te(null),Q()},[Q]),De=React.useCallback((t,s)=>{X(n=>({...n,[t]:s})),ee&&te(null),Q()},[Q,ee]),ce=React.useMemo(()=>{const t=a.filter(l=>!l.is_completed),s=t.filter(l=>Oe(l.due_date,l.is_completed)).length,n=t.filter(l=>fe(l.start_date)).length,r=t.filter(l=>!fe(l.start_date)).length;return{overdue:s,ready:n,blocked:r,total:a.length}},[a]),Le=React.useMemo(()=>a.filter(t=>{const s=he(t).label;return!(!d&&s==="Blocked"||!h&&s==="Completed")}),[a,d,h]),P=React.useCallback(async()=>{if(!g){o([]),L(!1),F(null),w("Log in to view your tasks.");return}L(!0),w(null);try{const n=(await(await v(`${A}/?limit=100`)).json()).map(r=>({...r,category:r.category??"",is_completed:!!r.is_completed}));o(n),F(new Date)}catch(t){const s=t instanceof Error?t.message:"Unable to load tasks.";w(s)}finally{L(!1)}},[v,g]);React.useEffect(()=>{Z&&P()},[Z,P]);const se=React.useCallback(async()=>{if(!g){D([]);return}try{const t=await v(`${A}/categories`);if(!t.ok)throw new Error("Unable to load categories");const s=await t.json();D(s)}catch{D([])}},[v,g]);React.useEffect(()=>{Z&&se()},[Z,se]);const ze=React.useCallback(async t=>{t.preventDefault(),R();const s=U.email.trim(),n=U.password;if(!s||!n){te("Enter email and password.");return}rt(s);const r=s.toLowerCase();try{await Ne(r,n),q(!1),X({email:s,password:""}),w(null),P(),se()}catch(l){const m=l instanceof Error?l.message:"Unable to log in.";te(m)}},[se,P,Ne,U.email,U.password,R]),He=React.useCallback(()=>{Se(),o([]),D([]),i(ue()),O(null),J(new Set),w("Log in to view your tasks."),q(!1),R()},[Se,R]),Ke=React.useCallback(()=>{R(),q(!0)},[R]),qe=React.useCallback(()=>{R(),q(!1)},[R]);React.useEffect(()=>{const t=me();t&&X(s=>s.email?s:{...s,email:t})},[]),React.useEffect(()=>{g&&(q(!1),X(t=>({email:t.email||me(),password:""})),R())},[g,R]),React.useEffect(()=>{g||re(!1)},[g]),React.useEffect(()=>{J(t=>{if(t.size===0)return t;const s=new Set(a.map(l=>l.id));let n=!1;const r=new Set;return t.forEach(l=>{s.has(l)?r.add(l):n=!0}),n?r:t})},[a]);const ie=React.useCallback(()=>{const t=ue(),s=f[0]?.value;return s?{...t,category:s}:t},[f]);React.useEffect(()=>{f.length!==0&&i(t=>t.category&&f.some(s=>s.value===t.category)?t:{...t,category:f[0].value})},[f]);const ae=React.useMemo(()=>f.reduce((t,s)=>(t[s.value]=s.label,t),{}),[f]),Ge=React.useMemo(()=>{const t=[...Le],s=l=>{const m=G(l).getTime();return Number.isNaN(m)?0:m},n={Blocked:0,Active:1,Completed:2},r=l=>{switch(S.key){case"start_date":return s(l.start_date);case"due_date":return s(l.due_date);case"status":return n[he(l).label]??0;case"category":default:return(ae[l.category]??l.category??"").toLowerCase()}};return t.sort((l,m)=>{const u=r(l),b=r(m);if(typeof u=="number"&&typeof b=="number")return u===b?l.id-m.id:S.direction==="asc"?u-b:b-u;const T=u.toString(),M=b.toString();return T===M?l.id-m.id:S.direction==="asc"?T.localeCompare(M,void 0,{sensitivity:"base"}):M.localeCompare(T,void 0,{sensitivity:"base"})})},[ae,S,Le]),B=(t,s)=>{i(n=>({...n,[t]:s}))},Ve=async t=>{t.preventDefault(),_(null);const s=c.name.trim(),n=c.description.trim();if(!s){_("Please provide a name.");return}if(!c.category){_("Select a category for this task.");return}if(c.startDate>c.dueDate){_("Start date must be on or before the due date.");return}if(!g){_("Log in to manage tasks.");return}const r=j!==null,l=r?`${A}/${j}`:`${A}/`,m=r?"PUT":"POST";V(!0);try{const u=await v(l,{method:m,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s,description:n,start_date:c.startDate,due_date:c.dueDate,category:c.category,is_completed:c.isCompleted})});if(!u.ok)throw new Error("Failed to save the task");const b=await u.json();o(T=>r?T.map(M=>M.id===b.id?b:M):[b,...T]),i(ie()),O(null),_(r?"Task updated":"Task saved")}catch(u){const b=u instanceof Error?u.message:"Unexpected error";_(b)}finally{V(!1)}},Te=React.useCallback(t=>{i(lt(t)),O(t.id),_(null)},[]),Ye=React.useCallback(()=>{i(ie()),O(null),_(null)},[ie]),Je=t=>{le(s=>s.key===t?{key:t,direction:s.direction==="asc"?"desc":"asc"}:{key:t,direction:"asc"})},oe=t=>S.key!==t?"none":S.direction==="asc"?"ascending":"descending",ne=(t,s)=>{const n=S.key===t?S.direction:null,r=n?`Sort by ${s} (${n==="asc"?"ascending":"descending"})`:`Sort by ${s}`;return e.jsxs("button",{type:"button",className:"todo-table__sort",onClick:()=>Je(t),"aria-label":r,children:[e.jsx("span",{children:s}),e.jsx("span",{className:"todo-table__sort-icon","aria-hidden":"true",children:n?n==="asc"?"↑":"↓":"↕"})]})},We=React.useCallback((t,s)=>{J(n=>{const r=new Set(n);return s?r.add(t):r.delete(t),r})},[]),Ze=React.useCallback(async()=>{const t=Array.from(Y);if(t.length===0||W){H(t.length===0?"Select at least one task to delete.":null);return}if(!g){H("Log in to delete tasks.");return}pe(!0),H(null);const s=new Set(t);try{await Promise.all(t.map(async n=>{if(!(await v(`${A}/${n}`,{method:"DELETE"})).ok)throw new Error("Unable to delete selected tasks.")})),o(n=>n.filter(r=>!s.has(r.id))),J(new Set),H(t.length===1?"Deleted 1 task.":`Deleted ${t.length} tasks.`)}catch(n){const r=n instanceof Error?n.message:"Failed to delete selected tasks.";H(r)}finally{pe(!1)}},[v,W,g,Y]),Qe=(t,s)=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),Te(s))},Xe=Y.size,Fe=React.useCallback((t,s)=>{ye(n=>t==="label"&&!xe?{label:s,slug:Ie(s)}:{...n,[t]:s}),t==="slug"&&je(!0),C(null)},[xe]),et=React.useCallback(async t=>{t.preventDefault();const s=I.label.trim(),n=I.slug||s,r=Ie(n);if(!s||!r){C("Provide both a label and a slug.");return}if(f.some(l=>l.value===r)){C("That slug already exists.");return}if(!g){C("Log in to manage categories.");return}ke(!0),C(null);try{const l=await v(`${A}/categories`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:r,label:s})});if(!l.ok)throw new Error("Unable to add category.");const m=await l.json();D(u=>[...u,m].sort((b,T)=>b.label.localeCompare(T.label))),ye({label:"",slug:""}),je(!1),C("Category added.")}catch(l){const m=l instanceof Error?l.message:"Failed to add category.";C(m)}finally{ke(!1)}},[v,I.label,I.slug,f,g]),tt=React.useCallback(async t=>{if(!(!t||t===$e)){if(!g){C("Log in to manage categories.");return}try{if(!(await v(`${A}/categories/${t}`,{method:"DELETE"})).ok)throw new Error("Unable to delete category.");D(n=>n.filter(r=>r.value!==t)),C("Category removed.")}catch(s){const n=s instanceof Error?s.message:"Failed to delete category.";C(n)}}},[v,g,D]),st=React.useMemo(()=>{if(typeof window>"u")return"/users/";const{pathname:t,search:s,hash:n}=window.location;if(!t)return"/users/";const r=`${t}${s||""}${n||""}`;return r?`/users/?back=${encodeURIComponent(r)}`:"/users/"},[]);return e.jsxs("div",{className:"todo-app",children:[e.jsxs("nav",{className:"todo-nav","aria-label":"Primary navigation",children:[e.jsx("div",{className:"todo-nav__logo",children:"To Do list"}),e.jsxs("ul",{className:"todo-nav__menu",children:[e.jsx("li",{className:"todo-nav__item",children:e.jsx("button",{type:"button",className:`todo-nav__link todo-nav__link--button${K?"":" todo-nav__link--active"}`,"aria-pressed":!K,onClick:()=>re(!1),children:"Tasks"})}),e.jsx("li",{className:"todo-nav__item",children:e.jsx("button",{type:"button",className:`todo-nav__link todo-nav__link--button${K?" todo-nav__link--active":""}`,"aria-pressed":K,onClick:()=>re(t=>!t),children:"Manage categories"})})]}),e.jsx("div",{className:"todo-nav__auth",children:g?e.jsxs("div",{className:"todo-nav__user",children:[e.jsx("div",{className:"todo-nav__user-details",children:e.jsx("span",{className:"todo-nav__user-email",children:Me?.email})}),e.jsx("button",{type:"button",className:"todo-nav__logout",onClick:He,children:"Logout"})]}):e.jsxs("div",{className:"todo-nav__login",children:[Ee?e.jsxs("form",{className:"todo-nav__login-form",onSubmit:ze,children:[e.jsxs("label",{className:"todo-nav__login-field",children:[e.jsx("span",{children:"Email"}),e.jsx("input",{type:"email",value:U.email,onChange:t=>De("email",t.target.value),autoComplete:"email",required:!0})]}),e.jsxs("label",{className:"todo-nav__login-field",children:[e.jsx("span",{children:"Password"}),e.jsx("input",{type:"password",value:U.password,onChange:t=>De("password",t.target.value),autoComplete:"current-password",required:!0})]}),e.jsxs("div",{className:"todo-nav__login-actions",children:[e.jsx("button",{type:"submit",className:"todo-nav__login-submit",disabled:Re,children:Re?"Signing in…":"Sign in"}),e.jsx("button",{type:"button",className:"todo-nav__login-cancel",onClick:qe,children:"Cancel"})]})]}):e.jsx("button",{type:"button",className:"todo-nav__link todo-nav__link--button",onClick:Ke,children:"Login"}),!Ee&&e.jsx("a",{className:"todo-nav__register-link",href:st,children:"Register"}),(ee||Ce)&&e.jsx("p",{className:"todo-nav__feedback",role:"status",children:ee??Ce})]})})]}),g?K?e.jsx("section",{className:"todo-categories","aria-label":"Category manager",children:e.jsxs("div",{className:"todo-categories__panel",children:[e.jsx("div",{children:e.jsx("h3",{children:"Manage categories"})}),e.jsxs("form",{className:"todo-categories__form",onSubmit:et,children:[e.jsxs("label",{className:"todo-categories__field",children:[e.jsx("span",{children:"Category label"}),e.jsx("input",{type:"text",value:I.label,onChange:t=>Fe("label",t.target.value),placeholder:"can include spaces",required:!0})]}),e.jsxs("label",{className:"todo-categories__field",children:[e.jsx("span",{children:"Category slug"}),e.jsx("input",{type:"text",value:I.slug,onChange:t=>Fe("slug",t.target.value),placeholder:"DESIGN",required:!0})]}),e.jsx($,{type:"submit",className:"todo-button todo-button--primary",disabled:ve,children:ve?"Adding…":"Add category"})]}),e.jsx("ul",{className:"todo-categories__list",children:f.map(t=>e.jsxs("li",{className:"todo-categories__item",children:[e.jsxs("span",{children:[e.jsx("strong",{children:t.label})," ",e.jsx("small",{children:t.value})]}),e.jsx($,{type:"button",variant:"outline",className:"todo-button todo-button--danger-solid",onClick:()=>void tt(t.value),disabled:t.value===$e,children:"Delete"})]},t.value))}),we?e.jsx("p",{className:"todo-categories__feedback",children:we}):null]})}):e.jsx(e.Fragment,{children:e.jsxs("main",{className:"todo-app__layout",children:[e.jsxs("section",{className:"todo-form","aria-labelledby":"todo-form-title",children:[e.jsxs("div",{className:"todo-form__header",children:[e.jsxs("div",{children:[e.jsx("p",{className:"todo-form__eyebrow",children:j?"Edit":"Create"}),e.jsx("h2",{id:"todo-form-title",children:j?"Update task":"New task"})]}),e.jsx("div",{className:"todo-form__header-actions",children:e.jsx($,{type:"button",variant:"outline",className:"todo-button todo-button--outline",onClick:()=>void P(),disabled:k,children:k?"Syncing…":"Refresh"})})]}),j?e.jsxs("p",{className:"todo-form__notice",children:["Editing task #",j]}):null,e.jsxs("form",{className:"todo-form__body",onSubmit:Ve,children:[e.jsxs("label",{className:"todo-form__field",htmlFor:"task-name",children:[e.jsx("span",{children:"Name"}),e.jsx("input",{id:"task-name",type:"text",value:c.name,onChange:t=>B("name",t.target.value),placeholder:"Write the task title",required:!0})]}),e.jsxs("label",{className:"todo-form__field",htmlFor:"task-description",children:[e.jsxs("span",{children:["Description ",e.jsx("span",{className:"todo-form__optional",children:"(optional)"})]}),e.jsx("textarea",{id:"task-description",value:c.description,onChange:t=>B("description",t.target.value),rows:3})]}),e.jsxs("div",{className:"todo-form__grid",children:[e.jsxs("label",{className:"todo-form__field",htmlFor:"task-start",children:[e.jsx("span",{children:"Start date"}),e.jsx("input",{id:"task-start",type:"date",value:c.startDate,onChange:t=>B("startDate",t.target.value)})]}),e.jsxs("label",{className:"todo-form__field",htmlFor:"task-due",children:[e.jsx("span",{children:"Due date"}),e.jsx("input",{id:"task-due",type:"date",value:c.dueDate,onChange:t=>B("dueDate",t.target.value)})]})]}),e.jsxs("label",{className:"todo-form__field",htmlFor:"task-category",children:[e.jsx("span",{children:"Category"}),e.jsx("select",{id:"task-category",value:c.category,onChange:t=>B("category",t.target.value),children:f.length===0?e.jsx("option",{value:c.category,children:ae[c.category]??c.category}):f.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("label",{className:"todo-form__field todo-form__field--inline",htmlFor:"task-completed",children:[e.jsxs("div",{children:[e.jsx("span",{children:"Status"}),e.jsx("p",{children:"Is the task complete?"})]}),e.jsx("input",{id:"task-completed",type:"checkbox",checked:c.isCompleted,onChange:t=>B("isCompleted",t.target.checked)})]}),e.jsxs("div",{className:"todo-form__actions",children:[e.jsx($,{type:"button",variant:"outline",className:"todo-button todo-button--outline",onClick:Ye,children:j?"Cancel edit":"Clear"}),e.jsx($,{type:"submit",className:"todo-button todo-button--primary",disabled:p,children:p?"Saving…":j?"Save changes":"Save"})]}),z?e.jsx("p",{className:"todo-form__feedback",children:z}):null]})]}),e.jsxs("section",{className:"todo-list","aria-live":"polite","aria-busy":k,children:[e.jsx("header",{className:"todo-list__header",children:e.jsxs("div",{className:"todo-list__header-actions",children:[e.jsxs("label",{className:"todo-list__toggle",htmlFor:"toggle-show-blocked",children:[e.jsxs("div",{className:"todo-list__toggle-copy",children:[e.jsx("span",{children:"Show blocked tasks"}),e.jsx("p",{children:"Tasks that cannot be started yet"})]}),e.jsx("input",{id:"toggle-show-blocked",type:"checkbox",role:"switch","aria-checked":d,checked:d,onChange:t=>y(t.target.checked)})]}),e.jsxs("label",{className:"todo-list__toggle",htmlFor:"toggle-show-completed",children:[e.jsxs("div",{className:"todo-list__toggle-copy",children:[e.jsx("span",{children:"Show completed tasks"}),e.jsx("p",{children:"Tasks done"})]}),e.jsx("input",{id:"toggle-show-completed",type:"checkbox",role:"switch","aria-checked":h,checked:h,onChange:t=>N(t.target.checked)})]}),e.jsxs("dl",{className:"todo-list__stats",children:[e.jsxs("div",{className:"todo-list__stats-item todo-list__stats-item--blocked",children:[e.jsx("dt",{children:"Blocked"}),e.jsx("dd",{children:ce.blocked})]}),e.jsxs("div",{className:"todo-list__stats-item todo-list__stats-item--active",children:[e.jsx("dt",{children:"Active"}),e.jsx("dd",{children:ce.ready})]}),e.jsxs("div",{className:"todo-list__stats-item todo-list__stats-item--overdue",children:[e.jsx("dt",{children:"Overdue"}),e.jsx("dd",{children:ce.overdue})]})]}),e.jsx($,{type:"button",variant:"outline",className:"todo-button todo-button--danger",onClick:()=>void Ze(),disabled:W||Xe===0,children:W?"Deleting…":"Delete selected"}),be?e.jsx("p",{className:"todo-list__feedback",role:"status",children:be}):null]})}),k?e.jsx("p",{className:"todo-list__status",children:"Loading tasks…"}):E?e.jsxs("div",{className:"todo-list__status todo-list__status--error",children:[e.jsx("p",{children:E}),e.jsx($,{type:"button",size:"sm",className:"todo-button todo-button--outline todo-button--compact",onClick:()=>void P(),children:"Try again"})]}):a.length===0?e.jsx("div",{className:"todo-list__status",children:e.jsx("p",{children:"No tasks yet. Save your first task on the left."})}):e.jsx("div",{className:"todo-list__table-wrapper",children:e.jsxs("table",{className:"todo-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"todo-table__select-header",children:"Select"}),e.jsx("th",{scope:"col","aria-sort":oe("status"),children:ne("status","Status")}),e.jsx("th",{scope:"col",children:"Task"}),e.jsx("th",{scope:"col","aria-sort":oe("category"),children:ne("category","Category")}),e.jsx("th",{scope:"col",children:"Days left"}),e.jsx("th",{scope:"col","aria-sort":oe("start_date"),children:ne("start_date","Start date")}),e.jsx("th",{scope:"col","aria-sort":oe("due_date"),children:ne("due_date","Due date")})]})}),e.jsx("tbody",{children:Ge.map(t=>{const s=he(t),n=`todo-status${s.modifier?` ${s.modifier}`:""}`,r=ct(t.due_date),l=["todo-table__due-offset"];r<0?l.push("todo-table__due-offset--overdue"):r===0?l.push("todo-table__due-offset--today"):l.push("todo-table__due-offset--upcoming");const m=["todo-table__row"];return Oe(t.due_date,t.is_completed)&&m.push("todo-table__row--overdue"),j===t.id&&m.push("todo-table__row--selected"),e.jsxs("tr",{className:m.join(" "),onClick:()=>Te(t),onKeyDown:u=>Qe(u,t),tabIndex:0,children:[e.jsx("td",{className:"todo-table__cell todo-table__cell--select",children:e.jsx("input",{type:"checkbox",className:"todo-table__select-input","aria-label":`Select task ${t.name}`,checked:Y.has(t.id),onChange:u=>We(t.id,u.target.checked),onClick:u=>u.stopPropagation()})}),e.jsx("td",{className:"todo-table__cell todo-table__cell--status",children:e.jsx("span",{className:n,children:s.label})}),e.jsx("td",{className:"todo-table__cell todo-table__task",children:e.jsx("span",{className:"todo-table__task-name",children:t.name})}),e.jsx("td",{className:"todo-table__cell",children:e.jsx("span",{className:"todo-table__chip",children:ae[t.category]??(t.category||"Uncategorized")})}),e.jsx("td",{className:"todo-table__cell todo-table__cell--due-offset",children:e.jsx("span",{className:l.join(" "),children:it(r)})}),e.jsx("td",{className:"todo-table__cell todo-table__cell--date",children:Ae(t.start_date)}),e.jsx("td",{className:"todo-table__cell todo-table__cell--date",children:e.jsx("span",{className:"todo-table__date-value",children:Ae(t.due_date)})})]},t.id)})})]})}),x?e.jsxs("p",{className:"todo-list__synced",children:["Last synced ",x.toLocaleTimeString()]}):null]})]})}):e.jsx("section",{className:"todo-empty","aria-live":"polite",children:e.jsxs("div",{className:"todo-empty__panel",children:[e.jsx("h3",{children:"Welcome"}),e.jsx("p",{children:"Use the Login button above to access and manage your personal task board."})]})})]})},Be=document.getElementById("root");if(!Be)throw new Error("Root element #root not found");ReactDOM.createRoot(Be).render(e.jsx(React.StrictMode,{children:e.jsx(dt,{})}));
